==============================================================================
08-11 16:35:45  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439303704
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 6928890
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 6928890
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=6928890"} []
----------------------------------------------------------

08-11 16:35:45  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 6928890
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:35:45  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:35:45  DEBUG id_token claims = Array
(
)


08-11 16:35:45  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:35:45  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:35:45  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d016f788c98706ef18d53a72ee8a1514ba).16f788c98706ef18d53a72ee8a1514ba

==============================================================================
08-11 16:37:54  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 3914849
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439303745
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=3914849","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:37:54  DEBUG prompt = 

08-11 16:37:54  DEBUG num prompt = 0 Array
(
)


08-11 16:37:54  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 3914849
)
 scopes = profile openid

08-11 16:37:54  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:37:54  DEBUG id_token claims = Array
(
)


08-11 16:37:54  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:37:54  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:37:54  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:37:59  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439303745
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 3914849
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 3914849
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=3914849"} []
----------------------------------------------------------

08-11 16:37:59  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 3914849
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:37:59  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:37:59  DEBUG id_token claims = Array
(
)


08-11 16:37:59  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:37:59  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:37:59  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d08a589e2ba0131db57f60ef7beee063fa).8a589e2ba0131db57f60ef7beee063fa

==============================================================================
08-11 16:38:36  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 3914849
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439303879
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=3914849","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:38:36  DEBUG prompt = 

08-11 16:38:36  DEBUG num prompt = 0 Array
(
)


08-11 16:38:36  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 3914849
)
 scopes = profile openid

08-11 16:38:36  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:38:36  DEBUG id_token claims = Array
(
)


08-11 16:38:36  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:38:36  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:38:36  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:38:38  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 1316167
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439303879
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 3914849
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 3914849
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=1316167","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:38:38  DEBUG prompt = 

08-11 16:38:38  DEBUG num prompt = 0 Array
(
)


08-11 16:38:38  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 1316167
)
 scopes = profile openid

08-11 16:38:38  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:38:38  DEBUG id_token claims = Array
(
)


08-11 16:38:38  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:38:38  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:38:38  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:38:41  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439303879
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 1316167
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 1316167
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=1316167"} []
----------------------------------------------------------

08-11 16:38:41  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 1316167
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:38:41  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:38:41  DEBUG id_token claims = Array
(
)


08-11 16:38:41  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:38:41  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:38:41  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d0eeea0f6c5ae6e3d909202cec34a8908b).eeea0f6c5ae6e3d909202cec34a8908b

==============================================================================
08-11 16:40:07  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 1316167
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439303921
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=1316167","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:40:07  DEBUG prompt = 

08-11 16:40:07  DEBUG num prompt = 0 Array
(
)


08-11 16:40:07  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 1316167
)
 scopes = profile openid

08-11 16:40:07  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:40:07  DEBUG id_token claims = Array
(
)


08-11 16:40:07  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:40:07  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:40:07  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:40:07  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 1316167
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439303921
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 1316167
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 1316167
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=1316167","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:40:07  DEBUG prompt = 

08-11 16:40:07  DEBUG num prompt = 0 Array
(
)


08-11 16:40:07  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 1316167
)
 scopes = profile openid

08-11 16:40:07  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:40:07  DEBUG id_token claims = Array
(
)


08-11 16:40:07  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:40:07  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:40:07  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:40:08  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 6611838
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439303921
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 1316167
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 1316167
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=6611838","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:40:08  DEBUG prompt = 

08-11 16:40:08  DEBUG num prompt = 0 Array
(
)


08-11 16:40:08  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 6611838
)
 scopes = profile openid

08-11 16:40:08  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:40:08  DEBUG id_token claims = Array
(
)


08-11 16:40:08  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:40:08  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:40:08  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:40:10  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439303921
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 6611838
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 6611838
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=6611838"} []
----------------------------------------------------------

08-11 16:40:10  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 6611838
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:40:10  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:40:10  DEBUG id_token claims = Array
(
)


08-11 16:40:10  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:40:10  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:40:11  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d0655a75edaa01b38a2761403ab8c8d48b).655a75edaa01b38a2761403ab8c8d48b

==============================================================================
08-11 16:40:28  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => PDMz6A0VXFxwturk-4y1iWSYXSLDzWtPeiAhXTlaYp0
    [state] => 6611838
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token?grant_type=authorization_code&code=PDMz6A0VXFxwturk-4y1iWSYXSLDzWtPeiAhXTlaYp0&state=6611838&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:40:28  DEBUG spardeco


08-11 16:40:28  ERROR url: error:unauthorized_client desc:mismatched token endpoint auth type client_secret_post !=  uri: state: code:400

08-11 16:40:28  ERROR HTTP/1.0 400 Bad Request
{"error":"unauthorized_client","error_description":"mismatched token endpoint auth type client_secret_post != "}

==============================================================================
08-11 16:41:34  DEBUG Request: req[ ]
Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304011
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-11 16:41:34  DEBUG Request: [ ]
Input:  
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-11 16:42:07  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => PDMz6A0VXFxwturk-4y1iWSYXSLDzWtPeiAhXTlaYp0
    [state] => 6611838
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token?grant_type=authorization_code&code=PDMz6A0VXFxwturk-4y1iWSYXSLDzWtPeiAhXTlaYp0&state=6611838&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:42:07  DEBUG spardeco
client_secret_post

08-11 16:42:07  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 16:42:07  DEBUG requested idtoken claims = Array
(
)


08-11 16:42:07  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:42:07  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439304427
    [iat] => 1439304127
    [at_hash] => _ohmdMWdHRrnp_HmdmsxWA
)


08-11 16:42:07  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 16:42:07  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA0NDI3LCJpYXQiOjE0MzkzMDQxMjcsImF0X2hhc2giOiJfb2htZE1XZEhScm5wX0htZG1zeFdBIn0.JnmnEi1U7QSqu-jGk4gsW3BWqlrLGEP_EQC3nQC9kZSFAfa8RQrvegRxRxbyh3EiXto_G5vtFfHqtyHMyfsRcHKNGVSdNzauZq1wZBHUQ4XFLohjqg-EpP91vGkKww6zsiZTz2bswD2HIXYcXP3jQgyF9uTsDw-pf-EB6OpD9XVyPzE1jT5l4Kp9SRuArCu864pHWMEJbUGhIrLQAYlQu-c8JAt7oTCTneCV0KfPuiirJzs0Ro1nl1aSCv5Da4PJsKuOCMCXfr1KLYB-OrBKvH1ZR2BgvN4Cg2mJvgRw_tBCQmrkwQeut0b0CElEelOtfh7abRKN5aFfPkxn5Ivz0A

08-11 16:42:07  DEBUG token response = Array
(
    [access_token] => f_8CbZx3F1QUH_0DGKbnccE3l_uqX6aJs1gmYwUeGgs
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA0NDI3LCJpYXQiOjE0MzkzMDQxMjcsImF0X2hhc2giOiJfb2htZE1XZEhScm5wX0htZG1zeFdBIn0.JnmnEi1U7QSqu-jGk4gsW3BWqlrLGEP_EQC3nQC9kZSFAfa8RQrvegRxRxbyh3EiXto_G5vtFfHqtyHMyfsRcHKNGVSdNzauZq1wZBHUQ4XFLohjqg-EpP91vGkKww6zsiZTz2bswD2HIXYcXP3jQgyF9uTsDw-pf-EB6OpD9XVyPzE1jT5l4Kp9SRuArCu864pHWMEJbUGhIrLQAYlQu-c8JAt7oTCTneCV0KfPuiirJzs0Ro1nl1aSCv5Da4PJsKuOCMCXfr1KLYB-OrBKvH1ZR2BgvN4Cg2mJvgRw_tBCQmrkwQeut0b0CElEelOtfh7abRKN5aFfPkxn5Ivz0A
)


==============================================================================
08-11 16:42:15  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 6611838
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304011
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=6611838","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:42:15  DEBUG prompt = 

08-11 16:42:15  DEBUG num prompt = 0 Array
(
)


08-11 16:42:15  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 6611838
)
 scopes = profile openid

08-11 16:42:15  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:42:15  DEBUG id_token claims = Array
(
)


08-11 16:42:15  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:42:15  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:42:15  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:42:17  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 5582871
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304011
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 6611838
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 6611838
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=5582871","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:42:17  DEBUG prompt = 

08-11 16:42:17  DEBUG num prompt = 0 Array
(
)


08-11 16:42:17  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 5582871
)
 scopes = profile openid

08-11 16:42:17  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:42:17  DEBUG id_token claims = Array
(
)


08-11 16:42:17  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:42:17  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:42:17  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:42:19  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304011
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 5582871
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 5582871
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=5582871"} []
----------------------------------------------------------

08-11 16:42:19  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 5582871
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:42:19  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:42:19  DEBUG id_token claims = Array
(
)


08-11 16:42:19  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:42:19  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:42:19  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d052287f05ec0edf9bb3675500ed1af059).52287f05ec0edf9bb3675500ed1af059

==============================================================================
08-11 16:42:56  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => CoOEcpAlNfZugSyRYhmwvplAnwo5G3nVaXAehJpPhK8
    [state] => 5582871
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token?grant_type=authorization_code&code=CoOEcpAlNfZugSyRYhmwvplAnwo5G3nVaXAehJpPhK8&state=5582871&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/ardecoback.php?state=5582871&session_state=b33ef86f62c61bc9bf7cb3e8484bd942dc74c1852ac5837ea36d3b2bfa9c3239.52287f05ec0edf9bb3675500ed1af059&code=CoOEcpAlNfZugSyRYhmwvplAnwo5G3nVaXAehJpPhK8"} []
----------------------------------------------------------

08-11 16:42:56  DEBUG spardeco
client_secret_post

08-11 16:42:56  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 16:42:56  DEBUG requested idtoken claims = Array
(
)


08-11 16:42:56  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:42:56  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439304476
    [iat] => 1439304176
    [at_hash] => -L2dK5VhhuBER3vkf0_4Iw
)


08-11 16:42:56  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 16:42:56  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA0NDc2LCJpYXQiOjE0MzkzMDQxNzYsImF0X2hhc2giOiItTDJkSzVWaGh1QkVSM3ZrZjBfNEl3In0.Obv23eIyuNzoo2MeV2vbcpaW9vb_oV24DvUIk5FeWWmsU0Ggu-cGcIARd6wIysdk3eW0v_s7wbQQUmJ33zuDMhsnLlMde7xUX2cPdgN9hXM2Ew2OvanAW9U7fohQQHZvDub2bhwN8j4OLaU--kMAmgYIPSSWcbcsIUH06BJOxQyGvlFRlnFonrbMj1VZh2-QDXiaElupuwmRoZR1hy7wsdXW2cQAaw6fOFlGzKewpcylrfhIEP6IhvyQj5HnD7Si9GRISoVKd49RJ1HgMoHujsYAMFtIV7v1q2sFhVH6i191l3AA6B_5AcWLxEZID8gY81eMV-umzwnqk35TMRpUrg

08-11 16:42:56  DEBUG token response = Array
(
    [access_token] => 7_PEh2vq-dPv48xVdraSpFvWPgYnHyHhXDh4NpxRC9U
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA0NDc2LCJpYXQiOjE0MzkzMDQxNzYsImF0X2hhc2giOiItTDJkSzVWaGh1QkVSM3ZrZjBfNEl3In0.Obv23eIyuNzoo2MeV2vbcpaW9vb_oV24DvUIk5FeWWmsU0Ggu-cGcIARd6wIysdk3eW0v_s7wbQQUmJ33zuDMhsnLlMde7xUX2cPdgN9hXM2Ew2OvanAW9U7fohQQHZvDub2bhwN8j4OLaU--kMAmgYIPSSWcbcsIUH06BJOxQyGvlFRlnFonrbMj1VZh2-QDXiaElupuwmRoZR1hy7wsdXW2cQAaw6fOFlGzKewpcylrfhIEP6IhvyQj5HnD7Si9GRISoVKd49RJ1HgMoHujsYAMFtIV7v1q2sFhVH6i191l3AA6B_5AcWLxEZID8gY81eMV-umzwnqk35TMRpUrg
)


==============================================================================
08-11 16:43:49  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 5494790
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304139
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=5494790","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:43:49  DEBUG prompt = 

08-11 16:43:49  DEBUG num prompt = 0 Array
(
)


08-11 16:43:49  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 5494790
)
 scopes = profile openid

08-11 16:43:49  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:43:49  DEBUG id_token claims = Array
(
)


08-11 16:43:49  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:43:49  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:43:49  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:43:51  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304139
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 5494790
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 5494790
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=5494790"} []
----------------------------------------------------------

08-11 16:43:51  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 5494790
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:43:51  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:43:51  DEBUG id_token claims = Array
(
)


08-11 16:43:51  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:43:51  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:43:51  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d01d06ba22d04a23aa4545c3d27525f313).1d06ba22d04a23aa4545c3d27525f313

==============================================================================
08-11 16:45:03  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 2445447
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304231
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=2445447","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:45:03  DEBUG prompt = 

08-11 16:45:03  DEBUG num prompt = 0 Array
(
)


08-11 16:45:03  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 2445447
)
 scopes = profile openid

08-11 16:45:03  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:45:03  DEBUG id_token claims = Array
(
)


08-11 16:45:03  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:45:03  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:45:03  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:45:05  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304231
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 2445447
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 2445447
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=2445447"} []
----------------------------------------------------------

08-11 16:45:05  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 2445447
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:45:05  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:45:05  DEBUG id_token claims = Array
(
)


08-11 16:45:05  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:45:05  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:45:05  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d0f230d2e905143d70bb3e7775751d8aee).f230d2e905143d70bb3e7775751d8aee

==============================================================================
08-11 16:45:42  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 2445447
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304305
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=2445447","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:45:42  DEBUG prompt = 

08-11 16:45:42  DEBUG num prompt = 0 Array
(
)


08-11 16:45:42  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 2445447
)
 scopes = profile openid

08-11 16:45:42  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:45:42  DEBUG id_token claims = Array
(
)


08-11 16:45:42  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:45:42  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:45:42  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:45:44  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 5428852
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304305
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 2445447
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 2445447
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=5428852","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:45:44  DEBUG prompt = 

08-11 16:45:44  DEBUG num prompt = 0 Array
(
)


08-11 16:45:44  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 5428852
)
 scopes = profile openid

08-11 16:45:44  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:45:44  DEBUG id_token claims = Array
(
)


08-11 16:45:44  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:45:44  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:45:44  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:45:46  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304305
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 5428852
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 5428852
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=5428852"} []
----------------------------------------------------------

08-11 16:45:46  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 5428852
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:45:46  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:45:46  DEBUG id_token claims = Array
(
)


08-11 16:45:46  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:45:46  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:45:46  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d036c64b36dca6dd14f38c29b423443099).36c64b36dca6dd14f38c29b423443099

==============================================================================
08-11 16:47:50  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 5428852
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304346
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=5428852","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:47:50  DEBUG prompt = 

08-11 16:47:50  DEBUG num prompt = 0 Array
(
)


08-11 16:47:50  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 5428852
)
 scopes = profile openid

08-11 16:47:50  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:47:50  DEBUG id_token claims = Array
(
)


08-11 16:47:50  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:47:50  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:47:50  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:47:52  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 4930277
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304346
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 5428852
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 5428852
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=4930277","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:47:52  DEBUG prompt = 

08-11 16:47:52  DEBUG num prompt = 0 Array
(
)


08-11 16:47:52  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 4930277
)
 scopes = profile openid

08-11 16:47:52  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:47:52  DEBUG id_token claims = Array
(
)


08-11 16:47:52  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:47:52  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:47:52  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:47:55  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304346
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 4930277
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 4930277
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=4930277"} []
----------------------------------------------------------

08-11 16:47:55  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 4930277
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:47:55  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:47:55  DEBUG id_token claims = Array
(
)


08-11 16:47:55  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:47:55  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:47:55  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d05574fad2c2aa530b48efd5f662814c56).5574fad2c2aa530b48efd5f662814c56

==============================================================================
08-11 16:48:13  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 9162028
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304475
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=9162028","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:48:13  DEBUG prompt = 

08-11 16:48:13  DEBUG num prompt = 0 Array
(
)


08-11 16:48:13  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 9162028
)
 scopes = profile openid

08-11 16:48:13  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:48:13  DEBUG id_token claims = Array
(
)


08-11 16:48:13  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:48:13  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:48:13  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:48:15  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304475
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 9162028
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 9162028
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=9162028"} []
----------------------------------------------------------

08-11 16:48:15  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 9162028
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:48:15  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:48:15  DEBUG id_token claims = Array
(
)


08-11 16:48:15  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:48:15  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:48:15  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d04e1d2c714c64d74353440935fc826335).4e1d2c714c64d74353440935fc826335

==============================================================================
08-11 16:48:15  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => jsa8UUM_SuGwoV7EBxB3wmEOt777Eu763w117DiNKG4
    [state] => 9162028
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=jsa8UUM_SuGwoV7EBxB3wmEOt777Eu763w117DiNKG4&state=9162028&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:48:15  DEBUG spardeco
client_secret_post

08-11 16:48:15  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 16:48:15  DEBUG requested idtoken claims = Array
(
)


08-11 16:48:15  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:48:15  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439304795
    [iat] => 1439304495
    [at_hash] => y3-oGFJ3HNKjKuAwVLROvg
)


08-11 16:48:15  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 16:48:15  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA0Nzk1LCJpYXQiOjE0MzkzMDQ0OTUsImF0X2hhc2giOiJ5My1vR0ZKM0hOS2pLdUF3VkxST3ZnIn0.C3AgUSXDUWzoN7CZpoHnQXzaBA0U9oCRKE1yXundgyNutaFXO3QdJejjQE5Jg6u3fx3JdG0hyh5CSnYZIWyxFon52njGErJYrCNYjgiWQHzNiDJ_yxV8oDN3uQO4MN064_yEY2JCkVcBm-KLXe_2lJVJbPMsf9Tp-ljyFB35SIjbCXTRuUmSOuwEX7ymhwn4U78trbgT8nzYG9UMeTC-mioUll_wv4qR72N9kgbca8pdMvfrzHIeUAIijDH5Vo3pA7vjyX0iRyzvv1TObcxRulJAuJka3fVb9Nhk875QbF60693vzLZ4qe6xBP0ZTnXjhgfnFXWQYia55Z2mWJYLfA

08-11 16:48:15  DEBUG token response = Array
(
    [access_token] => ZvHclBgVudan_9maMCi6cO2DM9IoynPpfCRsTF9sBmE
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA0Nzk1LCJpYXQiOjE0MzkzMDQ0OTUsImF0X2hhc2giOiJ5My1vR0ZKM0hOS2pLdUF3VkxST3ZnIn0.C3AgUSXDUWzoN7CZpoHnQXzaBA0U9oCRKE1yXundgyNutaFXO3QdJejjQE5Jg6u3fx3JdG0hyh5CSnYZIWyxFon52njGErJYrCNYjgiWQHzNiDJ_yxV8oDN3uQO4MN064_yEY2JCkVcBm-KLXe_2lJVJbPMsf9Tp-ljyFB35SIjbCXTRuUmSOuwEX7ymhwn4U78trbgT8nzYG9UMeTC-mioUll_wv4qR72N9kgbca8pdMvfrzHIeUAIijDH5Vo3pA7vjyX0iRyzvv1TObcxRulJAuJka3fVb9Nhk875QbF60693vzLZ4qe6xBP0ZTnXjhgfnFXWQYia55Z2mWJYLfA
)


==============================================================================
08-11 16:48:50  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 9162028
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304495
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=9162028","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:48:50  DEBUG prompt = 

08-11 16:48:50  DEBUG num prompt = 0 Array
(
)


08-11 16:48:50  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 9162028
)
 scopes = profile openid

08-11 16:48:50  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:48:50  DEBUG id_token claims = Array
(
)


08-11 16:48:50  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:48:50  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:48:50  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:48:52  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 8398725
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304495
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 9162028
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 9162028
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=8398725","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:48:52  DEBUG prompt = 

08-11 16:48:52  DEBUG num prompt = 0 Array
(
)


08-11 16:48:52  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 8398725
)
 scopes = profile openid

08-11 16:48:52  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:48:52  DEBUG id_token claims = Array
(
)


08-11 16:48:52  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:48:52  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:48:52  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:48:54  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304495
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 8398725
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 8398725
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=8398725"} []
----------------------------------------------------------

08-11 16:48:54  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 8398725
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:48:54  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:48:54  DEBUG id_token claims = Array
(
)


08-11 16:48:54  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:48:54  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:48:54  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d0b364e8dad8eac4664aa3f63fc5c77abf).b364e8dad8eac4664aa3f63fc5c77abf

==============================================================================
08-11 16:48:55  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 9el-XJr98cj7yXdj4__UgMbwQP1ApRWUPZGqKYaAjm0
    [state] => 8398725
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=9el-XJr98cj7yXdj4__UgMbwQP1ApRWUPZGqKYaAjm0&state=8398725&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:48:55  DEBUG spardeco
client_secret_post

08-11 16:48:55  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 16:48:55  DEBUG requested idtoken claims = Array
(
)


08-11 16:48:55  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:48:55  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439304835
    [iat] => 1439304535
    [at_hash] => r94H0bqVzHS3763HCCDL2Q
)


08-11 16:48:55  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 16:48:55  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA0ODM1LCJpYXQiOjE0MzkzMDQ1MzUsImF0X2hhc2giOiJyOTRIMGJxVnpIUzM3NjNIQ0NETDJRIn0.lnuwrrUuglIGivn-RYA4N2rqSRgPiL-xnMXennL6i_AH1Gv8grWWu8QOXnBpL3LtmURpXSnTbyfg6_oFwy5vmEEg1vm708kuxBHj9izxPfuh2ANKXR3T644COIPUpI1k-zyoLsGYNKYkDnK_hPgnRioQ07MCdWspxuiPXYT75OaqySZDGrdbhZwoqoae7ZS1JR7xnfQ7ADMJyeIUwxAtpkJP7dRuKvi91BvECrcGlJiOtCXTAQw7VE91rw09z5tPcWLJK-lu2cXa_KdA0SOo0QkWvtobmMiRnkZTtKqRz4UR9aNoCiwV0re8HR7z4fODQQoe_79v68Wjip73FhI-qw

08-11 16:48:55  DEBUG token response = Array
(
    [access_token] => a1PFTEbnZHVQC7fyP3_4pe0xyxwSEjpgQUsBTNPSgx4
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA0ODM1LCJpYXQiOjE0MzkzMDQ1MzUsImF0X2hhc2giOiJyOTRIMGJxVnpIUzM3NjNIQ0NETDJRIn0.lnuwrrUuglIGivn-RYA4N2rqSRgPiL-xnMXennL6i_AH1Gv8grWWu8QOXnBpL3LtmURpXSnTbyfg6_oFwy5vmEEg1vm708kuxBHj9izxPfuh2ANKXR3T644COIPUpI1k-zyoLsGYNKYkDnK_hPgnRioQ07MCdWspxuiPXYT75OaqySZDGrdbhZwoqoae7ZS1JR7xnfQ7ADMJyeIUwxAtpkJP7dRuKvi91BvECrcGlJiOtCXTAQw7VE91rw09z5tPcWLJK-lu2cXa_KdA0SOo0QkWvtobmMiRnkZTtKqRz4UR9aNoCiwV0re8HR7z4fODQQoe_79v68Wjip73FhI-qw
)


==============================================================================
08-11 16:51:37  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 4123857
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304534
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=4123857","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/"} []
----------------------------------------------------------

08-11 16:51:37  DEBUG prompt = 

08-11 16:51:37  DEBUG num prompt = 0 Array
(
)


08-11 16:51:37  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 4123857
)
 scopes = profile openid

08-11 16:51:37  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:51:37  DEBUG id_token claims = Array
(
)


08-11 16:51:37  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:51:37  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:51:37  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:51:40  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304534
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 4123857
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 4123857
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=4123857"} []
----------------------------------------------------------

08-11 16:51:40  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 4123857
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:51:40  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:51:40  DEBUG id_token claims = Array
(
)


08-11 16:51:40  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:51:40  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:51:40  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d0a507f3860eb34fbeff7f5b4b421ff77d).a507f3860eb34fbeff7f5b4b421ff77d

==============================================================================
08-11 16:51:40  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => LYCtJRFQlOcT6iIhUNIH1t6WBVcwvgImibBnkm6uwEc
    [state] => 4123857
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=LYCtJRFQlOcT6iIhUNIH1t6WBVcwvgImibBnkm6uwEc&state=4123857&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:51:40  DEBUG spardeco
client_secret_post

08-11 16:51:40  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 16:51:41  DEBUG requested idtoken claims = Array
(
)


08-11 16:51:41  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:51:41  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439305001
    [iat] => 1439304701
    [at_hash] => qZkFgdFWynZ4OVPhrDo-Xg
)


08-11 16:51:41  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 16:51:41  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MDAxLCJpYXQiOjE0MzkzMDQ3MDEsImF0X2hhc2giOiJxWmtGZ2RGV3luWjRPVlBockRvLVhnIn0.IaCsqyxWeaWs3mK0uEaB0RJjSG6GZWSNtvC3rcRBcdtIdFSOwRbTpbYTxTF8Z1gOHibwgI7Mi_OROvqrgLfJVrKl0DLrS8hUhhftigQ12Gj9MqLykx4riR9YhfU8CpzapR3EL8n5KASadc6vEZSraRtTerprBsJ1c8Lw86Mqjs9jnUuEoQwcT_Ft07a11NZS4_WgmhlGW4Axy6xTasVUn8CuoiMiNhSWAyUn6W-G-Kd8Xx-KElEb-yuqfPvxEbj8WVgd5ibWsRzWqLpjzWLMWI0x0g8nYQvOCJx7SiJQJpdsoM9dREOwOEF7DfjCouWdgDh_OzPjmdQR_vB-leaaGw

08-11 16:51:41  DEBUG token response = Array
(
    [access_token] => 9TGqWPCB1LXyo_3JWqG_U5X94ZaGwEVxi5v9roBbFoQ
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MDAxLCJpYXQiOjE0MzkzMDQ3MDEsImF0X2hhc2giOiJxWmtGZ2RGV3luWjRPVlBockRvLVhnIn0.IaCsqyxWeaWs3mK0uEaB0RJjSG6GZWSNtvC3rcRBcdtIdFSOwRbTpbYTxTF8Z1gOHibwgI7Mi_OROvqrgLfJVrKl0DLrS8hUhhftigQ12Gj9MqLykx4riR9YhfU8CpzapR3EL8n5KASadc6vEZSraRtTerprBsJ1c8Lw86Mqjs9jnUuEoQwcT_Ft07a11NZS4_WgmhlGW4Axy6xTasVUn8CuoiMiNhSWAyUn6W-G-Kd8Xx-KElEb-yuqfPvxEbj8WVgd5ibWsRzWqLpjzWLMWI0x0g8nYQvOCJx7SiJQJpdsoM9dREOwOEF7DfjCouWdgDh_OzPjmdQR_vB-leaaGw
)


==============================================================================
08-11 16:52:10  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 4123857
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304700
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=4123857","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/"} []
----------------------------------------------------------

08-11 16:52:10  DEBUG prompt = 

08-11 16:52:10  DEBUG num prompt = 0 Array
(
)


08-11 16:52:10  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 4123857
)
 scopes = profile openid

08-11 16:52:10  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:52:10  DEBUG id_token claims = Array
(
)


08-11 16:52:10  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:52:10  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:52:10  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:52:12  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304700
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 4123857
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 4123857
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=4123857"} []
----------------------------------------------------------

08-11 16:52:12  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 4123857
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:52:12  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:52:12  DEBUG id_token claims = Array
(
)


08-11 16:52:12  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:52:12  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:52:12  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d0ed6f7913f2cfe447913a30c4044ee69a).ed6f7913f2cfe447913a30c4044ee69a

==============================================================================
08-11 16:52:13  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => uuJa_QRh_DX1f4O59hsRRCXNVXuAOMwIpJ7NoTzIAJE
    [state] => 4123857
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=uuJa_QRh_DX1f4O59hsRRCXNVXuAOMwIpJ7NoTzIAJE&state=4123857&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:52:13  DEBUG spardeco
client_secret_post

08-11 16:52:13  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 16:52:13  DEBUG requested idtoken claims = Array
(
)


08-11 16:52:13  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:52:13  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439305033
    [iat] => 1439304733
    [at_hash] => AF-frLG3eYR2_jKq_jseHw
)


08-11 16:52:13  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 16:52:13  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MDMzLCJpYXQiOjE0MzkzMDQ3MzMsImF0X2hhc2giOiJBRi1mckxHM2VZUjJfaktxX2pzZUh3In0.Wp5rUGcQJUCFytugT49Cg_WmzjEsCc6pPjwXl6vOYoAGViPdZzc_BAGK6JDxhCSPnKEPODYJVZKLOsmJnHBvou-FS39tMQqYKtGNa-7CEonZ_dxZy0F_XufEmj9Vp1jzU5zepHABiVwtjVf-tyxdqo_ymSsiC0xsPqXxcTJXOMERW-qYy47trz_YQy3Y3EmUgz7eht-wM6FytBQv6CJi5rjBznCkdkqtWg7ylzuGL52qw1WK2ls_vG7hw4kwQxqq7JZVP18LViXpmlFXJGMRppoPNOfnImIq1r1AuiHvyWhJ7_SUUsEbntx1amXsuAJrPBa9oZAxhA1oQfaOTtoGlA

08-11 16:52:13  DEBUG token response = Array
(
    [access_token] => a_7v5gr9SRMIeCyHPbp6PzFPPoLxz_W1lAum3SKklNo
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MDMzLCJpYXQiOjE0MzkzMDQ3MzMsImF0X2hhc2giOiJBRi1mckxHM2VZUjJfaktxX2pzZUh3In0.Wp5rUGcQJUCFytugT49Cg_WmzjEsCc6pPjwXl6vOYoAGViPdZzc_BAGK6JDxhCSPnKEPODYJVZKLOsmJnHBvou-FS39tMQqYKtGNa-7CEonZ_dxZy0F_XufEmj9Vp1jzU5zepHABiVwtjVf-tyxdqo_ymSsiC0xsPqXxcTJXOMERW-qYy47trz_YQy3Y3EmUgz7eht-wM6FytBQv6CJi5rjBznCkdkqtWg7ylzuGL52qw1WK2ls_vG7hw4kwQxqq7JZVP18LViXpmlFXJGMRppoPNOfnImIq1r1AuiHvyWhJ7_SUUsEbntx1amXsuAJrPBa9oZAxhA1oQfaOTtoGlA
)


==============================================================================
08-11 16:52:13  DEBUG Request: Array
(
    [access_token] => a_7v5gr9SRMIeCyHPbp6PzFPPoLxz_W1lAum3SKklNo
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=a_7v5gr9SRMIeCyHPbp6PzFPPoLxz_W1lAum3SKklNo","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:52:13  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:52:13  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 16:52:13  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 16:52:13  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 4123857
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:52:13  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:52:13  DEBUG REQUESTED_USER_INFO = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:52:13  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:52:13  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 16:52:13  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 16:52:18  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 2335919
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304732
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=2335919","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:52:18  DEBUG prompt = 

08-11 16:52:18  DEBUG num prompt = 0 Array
(
)


08-11 16:52:18  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 2335919
)
 scopes = profile openid

08-11 16:52:18  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:52:18  DEBUG id_token claims = Array
(
)


08-11 16:52:18  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:52:18  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:52:18  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:52:20  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304732
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 2335919
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 2335919
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=2335919"} []
----------------------------------------------------------

08-11 16:52:20  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 2335919
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:52:20  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:52:20  DEBUG id_token claims = Array
(
)


08-11 16:52:20  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:52:20  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:52:20  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d0e3b9925252e3dc5a3c43049646546494).e3b9925252e3dc5a3c43049646546494

==============================================================================
08-11 16:52:20  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => cAGHgSL28DU9JGlkf4B_mcR01UxBrbL9J07x7kUpkqk
    [state] => 2335919
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=cAGHgSL28DU9JGlkf4B_mcR01UxBrbL9J07x7kUpkqk&state=2335919&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:52:20  DEBUG spardeco
client_secret_post

08-11 16:52:20  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 16:52:20  DEBUG requested idtoken claims = Array
(
)


08-11 16:52:20  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:52:20  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439305040
    [iat] => 1439304740
    [at_hash] => s6BB6VQQFL_PbiZARuDHOQ
)


08-11 16:52:20  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 16:52:20  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MDQwLCJpYXQiOjE0MzkzMDQ3NDAsImF0X2hhc2giOiJzNkJCNlZRUUZMX1BiaVpBUnVESE9RIn0.NfjowhcEtz8PlaYzAtAWjDqoTsvimduVG__KBJjlAYFOPvlOPzsU-u_5tm3cruR2eLtiYGPOqoCuDS9psvbidD0JTH7-koUM0Iv6jZ0c5sfAOxo-WEn86-M9LH4YuWyp3wHU_LHIM8yFPeUuOJVkEpk2LxZmuH65R8_O6RSra8WPKKts0C1VfzglnCmCMuGg95SHQYkUvoKAWbmjAO-qu90U8BGBGzmWILyfSWjxvQBKy9wFI-f5SsAgLXyTlRGLLmdIt_cN5wkFw7_iJYWmvSdY4bOGuooapkxsFfarJ3I46o0kPJuYuqa52X42-zVpt3O6YqhoxzzTFxZ-2gz8lw

08-11 16:52:20  DEBUG token response = Array
(
    [access_token] => dJpU3j5zmHu3CNDAeahqACuWYSj3kvNaaLxGmOjNqE8
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MDQwLCJpYXQiOjE0MzkzMDQ3NDAsImF0X2hhc2giOiJzNkJCNlZRUUZMX1BiaVpBUnVESE9RIn0.NfjowhcEtz8PlaYzAtAWjDqoTsvimduVG__KBJjlAYFOPvlOPzsU-u_5tm3cruR2eLtiYGPOqoCuDS9psvbidD0JTH7-koUM0Iv6jZ0c5sfAOxo-WEn86-M9LH4YuWyp3wHU_LHIM8yFPeUuOJVkEpk2LxZmuH65R8_O6RSra8WPKKts0C1VfzglnCmCMuGg95SHQYkUvoKAWbmjAO-qu90U8BGBGzmWILyfSWjxvQBKy9wFI-f5SsAgLXyTlRGLLmdIt_cN5wkFw7_iJYWmvSdY4bOGuooapkxsFfarJ3I46o0kPJuYuqa52X42-zVpt3O6YqhoxzzTFxZ-2gz8lw
)


==============================================================================
08-11 16:52:21  DEBUG Request: Array
(
    [access_token] => dJpU3j5zmHu3CNDAeahqACuWYSj3kvNaaLxGmOjNqE8
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=dJpU3j5zmHu3CNDAeahqACuWYSj3kvNaaLxGmOjNqE8","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:52:21  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:52:21  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 16:52:21  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 16:52:21  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 2335919
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:52:21  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:52:21  DEBUG REQUESTED_USER_INFO = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:52:21  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:52:21  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 16:52:21  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 16:53:11  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 7510097
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304740
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=7510097","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:53:11  DEBUG prompt = 

08-11 16:53:11  DEBUG num prompt = 0 Array
(
)


08-11 16:53:11  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 7510097
)
 scopes = profile openid

08-11 16:53:11  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:53:11  DEBUG id_token claims = Array
(
)


08-11 16:53:11  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:53:11  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:53:11  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:53:14  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304740
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 7510097
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 7510097
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=7510097"} []
----------------------------------------------------------

08-11 16:53:14  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 7510097
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:53:14  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:53:14  DEBUG id_token claims = Array
(
)


08-11 16:53:14  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:53:14  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:53:14  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d08896a1744550e33d76f5ace5bb3aa294).8896a1744550e33d76f5ace5bb3aa294

==============================================================================
08-11 16:53:14  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => xcC5GrTJttSIrQNmJNmXVioQhF7vW128dCFbgJkR3T8
    [state] => 7510097
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=xcC5GrTJttSIrQNmJNmXVioQhF7vW128dCFbgJkR3T8&state=7510097&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:53:14  DEBUG spardeco
client_secret_post

08-11 16:53:14  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 16:53:14  DEBUG requested idtoken claims = Array
(
)


08-11 16:53:14  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:53:14  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439305094
    [iat] => 1439304794
    [at_hash] => KGazRgdl3qSDlND0H5sgCw
)


08-11 16:53:14  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 16:53:14  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MDk0LCJpYXQiOjE0MzkzMDQ3OTQsImF0X2hhc2giOiJLR2F6UmdkbDNxU0RsTkQwSDVzZ0N3In0.ITkB9bHKjXv6NNjfg77N-1yZDhNDICkSOtLWLaqe7G7s4RZ3nR6PGngf6g4FxJ_TawK3fWo6DfhTvNRmbZ2EJOYJzhE7xmUqKV1eAjWG4jQsUvFC0fpRe3mGdJ6VFxscOsMDYxDljOTiLjoZHh_8kuuGE1zEWY0LagFLYAmGTiffUMS_w9WaUfZJiHKlF1VCgTQ1u1gF_Y3rlgg-w6SUJ3OXLlet1exyAY67OLNVvouke2MdCKovxBgcXmwq1si-gs9nZcpU0k4gMOd1gP1B13UDGA1koUPg-W3P2cnCJJtUE2dpoTtqM_7TdFzXKEt9PsA2jF-kOvwMVUSxmi2MGg

08-11 16:53:14  DEBUG token response = Array
(
    [access_token] => KUVyffAn8IpcqiIsfSkvY5J24GM65DTvKis5MVKqk4k
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MDk0LCJpYXQiOjE0MzkzMDQ3OTQsImF0X2hhc2giOiJLR2F6UmdkbDNxU0RsTkQwSDVzZ0N3In0.ITkB9bHKjXv6NNjfg77N-1yZDhNDICkSOtLWLaqe7G7s4RZ3nR6PGngf6g4FxJ_TawK3fWo6DfhTvNRmbZ2EJOYJzhE7xmUqKV1eAjWG4jQsUvFC0fpRe3mGdJ6VFxscOsMDYxDljOTiLjoZHh_8kuuGE1zEWY0LagFLYAmGTiffUMS_w9WaUfZJiHKlF1VCgTQ1u1gF_Y3rlgg-w6SUJ3OXLlet1exyAY67OLNVvouke2MdCKovxBgcXmwq1si-gs9nZcpU0k4gMOd1gP1B13UDGA1koUPg-W3P2cnCJJtUE2dpoTtqM_7TdFzXKEt9PsA2jF-kOvwMVUSxmi2MGg
)


==============================================================================
08-11 16:53:15  DEBUG Request: Array
(
    [access_token] => KUVyffAn8IpcqiIsfSkvY5J24GM65DTvKis5MVKqk4k
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=KUVyffAn8IpcqiIsfSkvY5J24GM65DTvKis5MVKqk4k","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:53:15  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:53:15  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 16:53:15  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 16:53:15  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 7510097
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:53:15  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:53:15  DEBUG REQUESTED_USER_INFO = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:53:15  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:53:15  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 16:53:15  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 16:53:47  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => xcC5GrTJttSIrQNmJNmXVioQhF7vW128dCFbgJkR3T8
    [state] => 7510097
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=xcC5GrTJttSIrQNmJNmXVioQhF7vW128dCFbgJkR3T8&state=7510097&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:53:47  ERROR url: error:invalid_grant desc:no such code uri: state: code:400

08-11 16:53:47  ERROR HTTP/1.0 400 Bad Request
{"error":"invalid_grant","error_description":"no such code"}

==============================================================================
08-11 16:53:53  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 1345670
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304794
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=1345670","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:53:53  DEBUG prompt = 

08-11 16:53:53  DEBUG num prompt = 0 Array
(
)


08-11 16:53:53  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 1345670
)
 scopes = profile openid

08-11 16:53:53  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:53:53  DEBUG id_token claims = Array
(
)


08-11 16:53:53  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:53:53  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:53:53  INFO requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:53:55  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304794
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 1345670
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 1345670
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid&state=1345670"} []
----------------------------------------------------------

08-11 16:53:55  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 1345670
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:53:55  DEBUG userinfo claims = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:53:55  DEBUG id_token claims = Array
(
)


08-11 16:53:55  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => family_name
    [2] => gender
    [3] => given_name
    [4] => locale
    [5] => middle_name
    [6] => name
    [7] => nickname
    [8] => picture
    [9] => preferred_username
    [10] => profile
    [11] => updated_at
    [12] => website
    [13] => zoneinfo
)


08-11 16:53:55  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:53:55  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d0b97bf0975d63c260baee5c651e4b8bed).b97bf0975d63c260baee5c651e4b8bed

==============================================================================
08-11 16:53:55  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => tT8Zue9J0IZ3D9r30fHpV34uCNmGp5YNrTRtHHUFCzE
    [state] => 1345670
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=tT8Zue9J0IZ3D9r30fHpV34uCNmGp5YNrTRtHHUFCzE&state=1345670&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:53:55  DEBUG spardeco
client_secret_post

08-11 16:53:55  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 16:53:55  DEBUG requested idtoken claims = Array
(
)


08-11 16:53:55  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:53:55  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439305135
    [iat] => 1439304835
    [at_hash] => TWPv-X5mMku0fAk3ZvJaGQ
)


08-11 16:53:55  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 16:53:55  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MTM1LCJpYXQiOjE0MzkzMDQ4MzUsImF0X2hhc2giOiJUV1B2LVg1bU1rdTBmQWszWnZKYUdRIn0.YioToz2703wznyscP7uBqkt6uN0oVN06HxiSggOHJT3KMeaYN1CE20Oa1jgfUsOGaF-yZJ3Q66sM34UC7Zg2mu_TJbfn94aWcJOvNThPrTT1V46lbZqJSKHe39SqaaUyvAAhzHUGnmJOZZOFZtQqQY0Fi34huqU5ahu6osTa5EInWYcEIHA388IZZBAqi1KYU00mgPPTVqhqjtHPqm19xSK7jLqxCp0G3SIRgHhlkv2lZDufGHR5pWrtqY_TRSJNNECDOlSdk4mthuAJakwmg9bjPaC3EwWDLSxOBcl-emuCQ1WX_1KANmv26qU1iD8BRnC8nVHOMn_YfFz4Bz6npg

08-11 16:53:55  DEBUG token response = Array
(
    [access_token] => t1h5eWoptvFt_mfPH9ffSLHQZzOnAlzybE2wc8aHFSc
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MTM1LCJpYXQiOjE0MzkzMDQ4MzUsImF0X2hhc2giOiJUV1B2LVg1bU1rdTBmQWszWnZKYUdRIn0.YioToz2703wznyscP7uBqkt6uN0oVN06HxiSggOHJT3KMeaYN1CE20Oa1jgfUsOGaF-yZJ3Q66sM34UC7Zg2mu_TJbfn94aWcJOvNThPrTT1V46lbZqJSKHe39SqaaUyvAAhzHUGnmJOZZOFZtQqQY0Fi34huqU5ahu6osTa5EInWYcEIHA388IZZBAqi1KYU00mgPPTVqhqjtHPqm19xSK7jLqxCp0G3SIRgHhlkv2lZDufGHR5pWrtqY_TRSJNNECDOlSdk4mthuAJakwmg9bjPaC3EwWDLSxOBcl-emuCQ1WX_1KANmv26qU1iD8BRnC8nVHOMn_YfFz4Bz6npg
)


==============================================================================
08-11 16:53:56  DEBUG Request: Array
(
    [access_token] => t1h5eWoptvFt_mfPH9ffSLHQZzOnAlzybE2wc8aHFSc
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=t1h5eWoptvFt_mfPH9ffSLHQZzOnAlzybE2wc8aHFSc","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:53:56  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:53:56  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 16:53:56  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 16:53:56  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid
    [state] => 1345670
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid

08-11 16:53:56  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:53:56  DEBUG REQUESTED_USER_INFO = Array
(
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:53:56  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:53:56  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 16:53:56  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 16:54:46  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6464658
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304835
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6464658","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:54:46  DEBUG prompt = 

08-11 16:54:46  DEBUG num prompt = 0 Array
(
)


08-11 16:54:46  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6464658
)
 scopes = profile openid email

08-11 16:54:46  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:54:46  DEBUG id_token claims = Array
(
)


08-11 16:54:46  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 16:54:46  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:54:46  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:54:55  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304835
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6464658
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6464658
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6464658"} []
----------------------------------------------------------

08-11 16:54:55  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6464658
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid email

08-11 16:54:55  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:54:55  DEBUG id_token claims = Array
(
)


08-11 16:54:55  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 16:54:55  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:54:55  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d0eba2db551aec8c4d204ded2abd3ecfcd).eba2db551aec8c4d204ded2abd3ecfcd

==============================================================================
08-11 16:54:56  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => xlOyvNboUbZDBbIbm0qgtssNgwgkYV0uryAhlp8WNn8
    [state] => 6464658
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=xlOyvNboUbZDBbIbm0qgtssNgwgkYV0uryAhlp8WNn8&state=6464658&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:54:56  DEBUG spardeco
client_secret_post

08-11 16:54:56  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 16:54:56  DEBUG requested idtoken claims = Array
(
)


08-11 16:54:56  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:54:56  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439305196
    [iat] => 1439304896
    [at_hash] => 7QMm7SX4AbJsDgRH6-p6gQ
)


08-11 16:54:56  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 16:54:56  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MTk2LCJpYXQiOjE0MzkzMDQ4OTYsImF0X2hhc2giOiI3UU1tN1NYNEFiSnNEZ1JINi1wNmdRIn0.h_aF_98lAzqglHxJNFCWzvPYhwbZIqmtioWbTbbyEer5vAUUcd7gDWqO4ICn1p7J39mG122Q5Xo2ETWfeU7QP4GVyXGFxWpFeDwaqJjpMlE7qfth5tUgWVk5WjrT_Yfn0ZPTy658j4kpszpJ_Yb8nepCn_A3A42npiXiYc5eYRsZDIKXPU24HuhGt9Sst5FNjkLxDZWt08xcg0s8e0-KB3wramd6_BboHkt9GtkkEh-KtkVKquSaWR6i8Taa_5wwYKMPvu-UFevBQ281O3iE3ExBS9UZvtLDwkFzTZZ-VFcBTlJDvmT_1WMWbDUN_iJX346RhkIIGb_E7gsFRMEC1A

08-11 16:54:56  DEBUG token response = Array
(
    [access_token] => kcl8_kIIOH7fI_3LSW1fPuv5jN1wXJJIxamkkc_sAXU
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MTk2LCJpYXQiOjE0MzkzMDQ4OTYsImF0X2hhc2giOiI3UU1tN1NYNEFiSnNEZ1JINi1wNmdRIn0.h_aF_98lAzqglHxJNFCWzvPYhwbZIqmtioWbTbbyEer5vAUUcd7gDWqO4ICn1p7J39mG122Q5Xo2ETWfeU7QP4GVyXGFxWpFeDwaqJjpMlE7qfth5tUgWVk5WjrT_Yfn0ZPTy658j4kpszpJ_Yb8nepCn_A3A42npiXiYc5eYRsZDIKXPU24HuhGt9Sst5FNjkLxDZWt08xcg0s8e0-KB3wramd6_BboHkt9GtkkEh-KtkVKquSaWR6i8Taa_5wwYKMPvu-UFevBQ281O3iE3ExBS9UZvtLDwkFzTZZ-VFcBTlJDvmT_1WMWbDUN_iJX346RhkIIGb_E7gsFRMEC1A
)


==============================================================================
08-11 16:54:56  DEBUG Request: Array
(
    [access_token] => kcl8_kIIOH7fI_3LSW1fPuv5jN1wXJJIxamkkc_sAXU
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=kcl8_kIIOH7fI_3LSW1fPuv5jN1wXJJIxamkkc_sAXU","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:54:56  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:54:56  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 16:54:56  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 16:54:56  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6464658
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid email

08-11 16:54:56  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:54:56  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:54:56  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:54:56  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 16:54:56  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 16:55:10  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9551377
)

Input: 
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304895
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9551377","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 16:55:10  DEBUG prompt = 

08-11 16:55:10  DEBUG num prompt = 0 Array
(
)


08-11 16:55:10  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9551377
)
 scopes = profile openid email

08-11 16:55:10  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:55:10  DEBUG id_token claims = Array
(
)


08-11 16:55:10  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 16:55:10  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:55:10  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 16:55:12  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439303512
    [lastlogin] => 1439304895
    [username] => alice
    [ops] => 611692db62a013274c9bfc412e4e68d0
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9551377
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9551377
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9551377"} []
----------------------------------------------------------

08-11 16:55:12  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9551377
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid email

08-11 16:55:12  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:55:12  DEBUG id_token claims = Array
(
)


08-11 16:55:12  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 16:55:12  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:55:12  DEBUG ss = sha256(spardecohttps://localhost611692db62a013274c9bfc412e4e68d0406af711139d6248db5afd20cdb3653e).406af711139d6248db5afd20cdb3653e

==============================================================================
08-11 16:55:12  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => HNR0m9Z1EhczhoPViuecoaxUZjE7yPVyfOpetv8oH_s
    [state] => 9551377
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=HNR0m9Z1EhczhoPViuecoaxUZjE7yPVyfOpetv8oH_s&state=9551377&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:55:12  DEBUG spardeco
client_secret_post

08-11 16:55:12  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 16:55:12  DEBUG requested idtoken claims = Array
(
)


08-11 16:55:12  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:55:12  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439305212
    [iat] => 1439304912
    [at_hash] => kxk8nGNR5DFodfOp3e5IKw
)


08-11 16:55:12  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 16:55:12  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MjEyLCJpYXQiOjE0MzkzMDQ5MTIsImF0X2hhc2giOiJreGs4bkdOUjVERm9kZk9wM2U1SUt3In0.mqKxqslI7h2ZCXUxjZpYIyE6AEvCL7X_2-2QfZ5hn-kfQHKzR3R94Ouq6Nu34Y0baz2os2010vsufbDHXADu7MEfDD3OgTWOJl90Ohjke0e7giIyd_dZHEp_T0yU3Lvkz06jeF9-Tg1OmXnwxiO1xYZMQhEYkJ5MColU0ooFg06x291H0RdwuD994kOoYaSN9KKNa66EPGePer2IjjlpsRY6uT0OM2N2uMc8vIrbZgRJH6BTxXqQYLZdh41STY1YGeLTTnQfWkoM5OqQY_2m9HQm6NoUXDcqWzPcF7TwKvko2PZA2hkrzNgGhG5ySPTb0VKXCouetPTVs-qHIskbsQ

08-11 16:55:12  DEBUG token response = Array
(
    [access_token] => o4QMNt3iXdFBiRt6WlXiCfj-XUZ4ddixedY9M-WUp4Y
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA1MjEyLCJpYXQiOjE0MzkzMDQ5MTIsImF0X2hhc2giOiJreGs4bkdOUjVERm9kZk9wM2U1SUt3In0.mqKxqslI7h2ZCXUxjZpYIyE6AEvCL7X_2-2QfZ5hn-kfQHKzR3R94Ouq6Nu34Y0baz2os2010vsufbDHXADu7MEfDD3OgTWOJl90Ohjke0e7giIyd_dZHEp_T0yU3Lvkz06jeF9-Tg1OmXnwxiO1xYZMQhEYkJ5MColU0ooFg06x291H0RdwuD994kOoYaSN9KKNa66EPGePer2IjjlpsRY6uT0OM2N2uMc8vIrbZgRJH6BTxXqQYLZdh41STY1YGeLTTnQfWkoM5OqQY_2m9HQm6NoUXDcqWzPcF7TwKvko2PZA2hkrzNgGhG5ySPTb0VKXCouetPTVs-qHIskbsQ
)


==============================================================================
08-11 16:55:12  DEBUG Request: Array
(
    [access_token] => o4QMNt3iXdFBiRt6WlXiCfj-XUZ4ddixedY9M-WUp4Y
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=o4QMNt3iXdFBiRt6WlXiCfj-XUZ4ddixedY9M-WUp4Y","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 16:55:12  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 16:55:12  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 16:55:12  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 16:55:12  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9551377
    [session_id] => 96k7fh81m98vghmqfegk2dqn24
    [auth_time] => 1439303512
)
 scopes = profile openid email

08-11 16:55:12  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:55:12  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 16:55:12  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 16:55:12  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 16:55:12  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 17:35:31  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2577672
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2577672","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 17:35:31  DEBUG prompt = 

08-11 17:35:31  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-11 17:35:39  DEBUG Request: Array
(
    [username] => simon
    [password] => toto
)

Input: username=simon&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2577672
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2577672
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2577672"} []
----------------------------------------------------------

08-11 17:35:39  DEBUG Auth_time = 1439307339

08-11 17:35:39  DEBUG session id = 5r8j3flpknl1gtbt1cv6d01281

08-11 17:35:39  DEBUG prompt = 

08-11 17:35:39  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2577672
)
 scopes = profile openid email

08-11 17:35:39  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 17:35:39  DEBUG id_token claims = Array
(
)


08-11 17:35:39  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 17:35:39  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:35:39  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 17:35:48  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2577672
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2577672
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439307339
    [ops] => 0a149cfc9982b113203a1a47f4402e24
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-11 17:35:48  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2577672
    [session_id] => 5r8j3flpknl1gtbt1cv6d01281
    [auth_time] => 1439307339
)
 scopes = profile openid email

08-11 17:35:48  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 17:35:48  DEBUG id_token claims = Array
(
)


08-11 17:35:48  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 17:35:48  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:35:49  DEBUG ss = sha256(spardecohttps://localhost0a149cfc9982b113203a1a47f4402e24db0c3499a5ff81d38cacee4b58ce5047).db0c3499a5ff81d38cacee4b58ce5047

==============================================================================
08-11 17:35:49  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => lgcXGa8h0t4ByJnNl883nrPFeocNOz-ta5pSpwXoLYA
    [state] => 2577672
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=lgcXGa8h0t4ByJnNl883nrPFeocNOz-ta5pSpwXoLYA&state=2577672&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 17:35:49  DEBUG spardeco
client_secret_post

08-11 17:35:49  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 17:35:49  DEBUG no ops in sessionid 5r8j3flpknl1gtbt1cv6d01281

08-11 17:35:49  DEBUG requested idtoken claims = Array
(
)


08-11 17:35:49  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-11 17:35:49  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439307649
    [iat] => 1439307349
    [at_hash] => 2xZNGoEhh7qP8rS3eO73bQ
)


08-11 17:35:49  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 17:35:49  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA3NjQ5LCJpYXQiOjE0MzkzMDczNDksImF0X2hhc2giOiIyeFpOR29FaGg3cVA4clMzZU83M2JRIn0.pIOTaKMmFAOC-yy8QJHwqFeO2qR3Ed4iQxKI6tPQd_lg8XCDiGqJFMxwfRwXbU9TuiLwNih6NW3nJr-gCvLztbeqK6Aj9lI6jME6JzFvJXaOSSXUnn0Kxy0QQbJqruQk_mp7WNHcIU-OFuSsFxcsz-7qRWTskPJMtBs5ZRD_ACr4lm9tHHEWNvRHBU-p3ZMXC9jD8f5XtCCEoZTnJzDj1epAulRd5EGGhF1CyuEBKQn54LRD-tlQTIorTU66P5tqFC06YEFkjdz1jplvjVLQhkqXW-7QG--ppL2y1SyQsbFVmWlRoK0WQpjxY_JBSyAOb57CyPmkmhMMU-ucnIMUDg

08-11 17:35:49  DEBUG token response = Array
(
    [access_token] => ng3ICXA9tn3SMBAxWldERBBuTPScfMDF21HVle5ORZs
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA3NjQ5LCJpYXQiOjE0MzkzMDczNDksImF0X2hhc2giOiIyeFpOR29FaGg3cVA4clMzZU83M2JRIn0.pIOTaKMmFAOC-yy8QJHwqFeO2qR3Ed4iQxKI6tPQd_lg8XCDiGqJFMxwfRwXbU9TuiLwNih6NW3nJr-gCvLztbeqK6Aj9lI6jME6JzFvJXaOSSXUnn0Kxy0QQbJqruQk_mp7WNHcIU-OFuSsFxcsz-7qRWTskPJMtBs5ZRD_ACr4lm9tHHEWNvRHBU-p3ZMXC9jD8f5XtCCEoZTnJzDj1epAulRd5EGGhF1CyuEBKQn54LRD-tlQTIorTU66P5tqFC06YEFkjdz1jplvjVLQhkqXW-7QG--ppL2y1SyQsbFVmWlRoK0WQpjxY_JBSyAOb57CyPmkmhMMU-ucnIMUDg
)


==============================================================================
08-11 17:35:49  DEBUG Request: Array
(
    [access_token] => ng3ICXA9tn3SMBAxWldERBBuTPScfMDF21HVle5ORZs
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=ng3ICXA9tn3SMBAxWldERBBuTPScfMDF21HVle5ORZs","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 17:35:49  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-11 17:35:49  DEBUG wrapped |wFF#9yFk6Ca unwrapped = 1:simon

08-11 17:35:49  DEBUG userid = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8  unwrapped = simon

08-11 17:35:49  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2577672
    [session_id] => 5r8j3flpknl1gtbt1cv6d01281
    [auth_time] => 1439307339
)
 scopes = profile openid email

08-11 17:35:49  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:35:49  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 17:35:49  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:35:49  DEBUG returning = Array
(
    [birthdate] => 1898
    [email] => simon.becot@orange.com
    [email_verified] => 1
    [family_name] => Becot
    [gender] => male
    [given_name] => Simon
    [locale] => fr
    [middle_name] => 
    [name] => Simon Becot
    [nickname] => 
    [picture] => https://localhost/phpOp/profiles/pic.jpg
    [preferred_username] => 
    [profile] => http://profile/simon
    [updated_at] => 
    [website] => http://website
    [zoneinfo] => 
)


08-11 17:35:49  DEBUG userinfo response = {"sub":"c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8","birthdate":"1898","email":"simon.becot@orange.com","email_verified":true,"family_name":"Becot","gender":"male","given_name":"Simon","locale":"fr","middle_name":null,"name":"Simon Becot","nickname":null,"picture":"https:\/\/localhost\/phpOp\/profiles\/pic.jpg","preferred_username":null,"profile":"http:\/\/profile\/simon","updated_at":null,"website":"http:\/\/website","zoneinfo":null}

==============================================================================
08-11 17:37:10  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8231388
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8231388","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 17:37:10  DEBUG prompt = 

08-11 17:37:10  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-11 17:49:07  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4737941
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4737941","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 17:49:07  DEBUG prompt = 

08-11 17:49:07  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-11 17:49:09  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4737941
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4737941
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4737941"} []
----------------------------------------------------------

08-11 17:49:09  DEBUG Auth_time = 1439308149

08-11 17:49:09  DEBUG session id = oit2117fgp055mhah8up81r8d4

08-11 17:49:09  DEBUG prompt = 

08-11 17:49:09  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4737941
)
 scopes = profile openid email

08-11 17:49:09  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 17:49:09  DEBUG id_token claims = Array
(
)


08-11 17:49:09  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 17:49:09  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:49:09  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 17:49:13  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4737941
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4737941
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439308149
    [ops] => 1700fa44c5a21d224348872726e681d8
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-11 17:49:13  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4737941
    [session_id] => oit2117fgp055mhah8up81r8d4
    [auth_time] => 1439308149
)
 scopes = profile openid email

08-11 17:49:13  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 17:49:13  DEBUG id_token claims = Array
(
)


08-11 17:49:13  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 17:49:13  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:49:13  DEBUG ss = sha256(spardecohttps://localhost1700fa44c5a21d224348872726e681d8be05a33d9c1e4a4fd8a72c6e604a545f).be05a33d9c1e4a4fd8a72c6e604a545f

==============================================================================
08-11 17:52:13  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4012891
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4012891","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 17:52:13  DEBUG prompt = 

08-11 17:52:13  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-11 17:52:14  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
    [persist] => on
)

Input: username=alice&password=wonderland&persist=on
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4012891
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4012891
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4012891"} []
----------------------------------------------------------

08-11 17:52:15  DEBUG Auth_time = 1439308335

08-11 17:52:15  DEBUG session id = oit2117fgp055mhah8up81r8d4

08-11 17:52:15  DEBUG prompt = 

08-11 17:52:15  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4012891
)
 scopes = profile openid email

08-11 17:52:15  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 17:52:15  DEBUG id_token claims = Array
(
)


08-11 17:52:15  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 17:52:15  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:52:15  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 17:52:16  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4012891
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4012891
        )

    [login] => 1
    [username] => alice
    [persist] => on
    [auth_time] => 1439308335
    [ops] => fa3d3c2296732bd1062c5e417d8b9622
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-11 17:52:16  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4012891
    [session_id] => oit2117fgp055mhah8up81r8d4
    [auth_time] => 1439308335
)
 scopes = profile openid email

08-11 17:52:16  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 17:52:16  DEBUG id_token claims = Array
(
)


08-11 17:52:16  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 17:52:16  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:52:16  DEBUG ss = sha256(spardecohttps://localhostfa3d3c2296732bd1062c5e417d8b9622cb1fe27de301960869afe7c3dd78dd40).cb1fe27de301960869afe7c3dd78dd40

==============================================================================
08-11 17:52:37  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => zs4Dvoxo3r3KSamJgwQ4JEcidrkL87S3ajTDW9mu5Qg
    [state] => 4012891
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=zs4Dvoxo3r3KSamJgwQ4JEcidrkL87S3ajTDW9mu5Qg&state=4012891&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 17:52:37  DEBUG spardeco
client_secret_post

08-11 17:52:37  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 17:52:38  DEBUG requested idtoken claims = Array
(
)


08-11 17:52:38  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 17:52:38  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439308658
    [iat] => 1439308358
    [at_hash] => AiXvIBt6g4lQy3HOFcR0iQ
)


08-11 17:52:38  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 17:52:38  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA4NjU4LCJpYXQiOjE0MzkzMDgzNTgsImF0X2hhc2giOiJBaVh2SUJ0Nmc0bFF5M0hPRmNSMGlRIn0.Qs2PfE1HMhHpkllXFVF0MrWNSIB2zdevdfqmjCyynVNM1jaU5jqJvAcdGf8S4IN7wIpi12jln2qMsYU-yAtI5HXu2iTkqf2CxrYLU89FoEJk-XjK4whpUYwFN7cKv-wI0fLRy0ehcun4GEbTu0A2kCxIoGEJe2N9V3gbOJD4GjN_zyvotwxy6aDPOyFHNoMnNRskllFI0PlrkvzKKUcsGGvd9QLckbqiOlfXxBftjCk6_8Lp5_QMWfjmyZCfbYa1bKnA2SN375u-dlvCb5tL3QtLYr7b2UYnLDlAEp5OlryUcuIJ10XZNDyJ4ZlDBl2iUd4EazQWmqESaGkjrbMycw

08-11 17:52:38  DEBUG token response = Array
(
    [access_token] => zEKvoK0-DUNg79um3c8sD7JrDg8uZIm_WWh2WcZ7snM
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA4NjU4LCJpYXQiOjE0MzkzMDgzNTgsImF0X2hhc2giOiJBaVh2SUJ0Nmc0bFF5M0hPRmNSMGlRIn0.Qs2PfE1HMhHpkllXFVF0MrWNSIB2zdevdfqmjCyynVNM1jaU5jqJvAcdGf8S4IN7wIpi12jln2qMsYU-yAtI5HXu2iTkqf2CxrYLU89FoEJk-XjK4whpUYwFN7cKv-wI0fLRy0ehcun4GEbTu0A2kCxIoGEJe2N9V3gbOJD4GjN_zyvotwxy6aDPOyFHNoMnNRskllFI0PlrkvzKKUcsGGvd9QLckbqiOlfXxBftjCk6_8Lp5_QMWfjmyZCfbYa1bKnA2SN375u-dlvCb5tL3QtLYr7b2UYnLDlAEp5OlryUcuIJ10XZNDyJ4ZlDBl2iUd4EazQWmqESaGkjrbMycw
)


==============================================================================
08-11 17:52:38  DEBUG Request: Array
(
    [access_token] => zEKvoK0-DUNg79um3c8sD7JrDg8uZIm_WWh2WcZ7snM
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=zEKvoK0-DUNg79um3c8sD7JrDg8uZIm_WWh2WcZ7snM","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 17:52:38  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 17:52:38  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 17:52:38  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 17:52:38  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4012891
    [session_id] => oit2117fgp055mhah8up81r8d4
    [auth_time] => 1439308335
)
 scopes = profile openid email

08-11 17:52:38  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:52:38  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 17:52:38  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:52:38  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 17:52:38  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 17:58:00  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2372835
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2372835","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 17:58:00  DEBUG prompt = 

08-11 17:58:00  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-11 17:58:02  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2372835
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2372835
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2372835"} []
----------------------------------------------------------

08-11 17:58:02  DEBUG Auth_time = 1439308682

08-11 17:58:02  DEBUG session id = rgl0ovj7opuv5untvfee0lo5c1

08-11 17:58:02  DEBUG prompt = 

08-11 17:58:02  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2372835
)
 scopes = profile openid email

08-11 17:58:02  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 17:58:02  DEBUG id_token claims = Array
(
)


08-11 17:58:02  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 17:58:02  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:58:02  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 17:58:04  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2372835
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2372835
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439308682
    [ops] => f57d376a4ced30adcb5fd3d92352c2fc
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-11 17:58:04  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2372835
    [session_id] => rgl0ovj7opuv5untvfee0lo5c1
    [auth_time] => 1439308682
)
 scopes = profile openid email

08-11 17:58:04  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 17:58:04  DEBUG id_token claims = Array
(
)


08-11 17:58:04  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 17:58:04  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:58:04  DEBUG ss = sha256(spardecohttps://localhostf57d376a4ced30adcb5fd3d92352c2fc5eb1a27c3e065f87886a58ffe3a1b9e2).5eb1a27c3e065f87886a58ffe3a1b9e2

==============================================================================
08-11 17:58:04  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => aeMRqkHTDPgGCAbtQvYW3SyesmAq_XI58p6zfsa0TSg
    [state] => 2372835
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=aeMRqkHTDPgGCAbtQvYW3SyesmAq_XI58p6zfsa0TSg&state=2372835&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 17:58:04  DEBUG spardeco
client_secret_post

08-11 17:58:04  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 17:58:04  DEBUG no ops in sessionid rgl0ovj7opuv5untvfee0lo5c1

08-11 17:58:04  DEBUG requested idtoken claims = Array
(
)


08-11 17:58:04  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 17:58:04  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439308984
    [iat] => 1439308684
    [at_hash] => IK0X4WHPzpssukfqixpkPw
)


08-11 17:58:04  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 17:58:04  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA4OTg0LCJpYXQiOjE0MzkzMDg2ODQsImF0X2hhc2giOiJJSzBYNFdIUHpwc3N1a2ZxaXhwa1B3In0.HGlpZn4l1K7EWQDPUuLyOypzrE2lXNtZUc0yEWzL1StDxj6DuyWyZCB4V82wJIJaRd-x8n3_d6d1V-7_uArTUFTiBzUN4mYkb39KHOUdHqucogGCrgft626BTPd9AEymSPGbb_fXpdF2X6nTOSWhLSn8bOSQC6pS4tk0G928K5i4LgXTt0aJR9DJzhQxfr0NFujVzOu7xlKVyEWQfivDwAdsc5dxx3CZhv9j4n1OvJEIezt40Xye6ao8ZzpvySXrXiR9s5B1deD1AdEW_r5Pqg3FYCpju8CjezKsioluxXmYvvFQgAGfqBrmEFVrn6jVjzejOku3kamen2tcjcVkdw

08-11 17:58:04  DEBUG token response = Array
(
    [access_token] => adO3Ss75mcLz8OVUNZuSWjR8AqUDNkxjMNfvAoaQ3Hw
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA4OTg0LCJpYXQiOjE0MzkzMDg2ODQsImF0X2hhc2giOiJJSzBYNFdIUHpwc3N1a2ZxaXhwa1B3In0.HGlpZn4l1K7EWQDPUuLyOypzrE2lXNtZUc0yEWzL1StDxj6DuyWyZCB4V82wJIJaRd-x8n3_d6d1V-7_uArTUFTiBzUN4mYkb39KHOUdHqucogGCrgft626BTPd9AEymSPGbb_fXpdF2X6nTOSWhLSn8bOSQC6pS4tk0G928K5i4LgXTt0aJR9DJzhQxfr0NFujVzOu7xlKVyEWQfivDwAdsc5dxx3CZhv9j4n1OvJEIezt40Xye6ao8ZzpvySXrXiR9s5B1deD1AdEW_r5Pqg3FYCpju8CjezKsioluxXmYvvFQgAGfqBrmEFVrn6jVjzejOku3kamen2tcjcVkdw
)


==============================================================================
08-11 17:58:04  DEBUG Request: Array
(
    [access_token] => adO3Ss75mcLz8OVUNZuSWjR8AqUDNkxjMNfvAoaQ3Hw
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=adO3Ss75mcLz8OVUNZuSWjR8AqUDNkxjMNfvAoaQ3Hw","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 17:58:04  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 17:58:04  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 17:58:04  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 17:58:04  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2372835
    [session_id] => rgl0ovj7opuv5untvfee0lo5c1
    [auth_time] => 1439308682
)
 scopes = profile openid email

08-11 17:58:04  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:58:04  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 17:58:04  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 17:58:04  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 17:58:04  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 18:00:36  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2624467
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2624467","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 18:00:36  DEBUG prompt = 

08-11 18:00:36  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-11 18:00:37  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
    [persist] => on
)

Input: username=alice&password=wonderland&persist=on
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2624467
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2624467
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2624467"} []
----------------------------------------------------------

08-11 18:00:37  DEBUG Auth_time = 1439308837

08-11 18:00:37  DEBUG session id = rgl0ovj7opuv5untvfee0lo5c1

08-11 18:00:37  DEBUG prompt = 

08-11 18:00:37  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2624467
)
 scopes = profile openid email

08-11 18:00:37  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:00:37  DEBUG id_token claims = Array
(
)


08-11 18:00:37  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:00:37  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:00:37  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 18:00:39  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2624467
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2624467
        )

    [login] => 1
    [username] => alice
    [persist] => on
    [auth_time] => 1439308837
    [ops] => 30fba0bdc58ebeee4f5133557b54d553
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-11 18:00:39  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2624467
    [session_id] => rgl0ovj7opuv5untvfee0lo5c1
    [auth_time] => 1439308837
)
 scopes = profile openid email

08-11 18:00:39  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:00:39  DEBUG id_token claims = Array
(
)


08-11 18:00:39  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:00:39  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:00:39  DEBUG ss = sha256(spardecohttps://localhost30fba0bdc58ebeee4f5133557b54d5531d5acde74bc3266b3fb0dc9b740b5d5a).1d5acde74bc3266b3fb0dc9b740b5d5a

==============================================================================
08-11 18:00:39  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => AH20C0BKjOKrsDSKMpIbsOMBTgGWI_F-hMm8wHqCiao
    [state] => 2624467
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=AH20C0BKjOKrsDSKMpIbsOMBTgGWI_F-hMm8wHqCiao&state=2624467&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:00:39  DEBUG spardeco
client_secret_post

08-11 18:00:39  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 18:00:39  DEBUG requested idtoken claims = Array
(
)


08-11 18:00:39  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 18:00:39  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439309139
    [iat] => 1439308839
    [at_hash] => fTfkOyNKXsQPmz51WVYKFA
)


08-11 18:00:39  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 18:00:39  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA5MTM5LCJpYXQiOjE0MzkzMDg4MzksImF0X2hhc2giOiJmVGZrT3lOS1hzUVBtejUxV1ZZS0ZBIn0.HkIPmzyP5b9mhV4f_aonog9A7drjCN7aAshBiEb3oKQzW62aU5e5e4MJdD8p92fC9F0bqwa9f1Fpk3AFJR_m2XhJu4dHIg14vWvZk7WbI82TpMD8NKkccokV_L2YAq_ZjvsUvS_dMV20tEYstX1QBm59rOUb4h1c86OagNBuv7cynFeQahKfXbur6TU2lvvM9D-N43GFYVCGmcydOWa0dsYbkJT-5ybh5uheRZuC7ZhuwN8PhVTTlBCYN706djGhZEvHZudkHe7Ly6Wyw9HUms3-T9D0bGTRXIZ9lYtfpm73W52NI_pBPorx0c-hnYQaEVksnNQ1Z8DLYpOnt_S17g

08-11 18:00:39  DEBUG token response = Array
(
    [access_token] => 5CoyhntrluDnzax2uhu1YagFjNk6F6yC-PWcChdK3Po
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA5MTM5LCJpYXQiOjE0MzkzMDg4MzksImF0X2hhc2giOiJmVGZrT3lOS1hzUVBtejUxV1ZZS0ZBIn0.HkIPmzyP5b9mhV4f_aonog9A7drjCN7aAshBiEb3oKQzW62aU5e5e4MJdD8p92fC9F0bqwa9f1Fpk3AFJR_m2XhJu4dHIg14vWvZk7WbI82TpMD8NKkccokV_L2YAq_ZjvsUvS_dMV20tEYstX1QBm59rOUb4h1c86OagNBuv7cynFeQahKfXbur6TU2lvvM9D-N43GFYVCGmcydOWa0dsYbkJT-5ybh5uheRZuC7ZhuwN8PhVTTlBCYN706djGhZEvHZudkHe7Ly6Wyw9HUms3-T9D0bGTRXIZ9lYtfpm73W52NI_pBPorx0c-hnYQaEVksnNQ1Z8DLYpOnt_S17g
)


==============================================================================
08-11 18:00:40  DEBUG Request: Array
(
    [access_token] => 5CoyhntrluDnzax2uhu1YagFjNk6F6yC-PWcChdK3Po
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=5CoyhntrluDnzax2uhu1YagFjNk6F6yC-PWcChdK3Po","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:00:40  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 18:00:40  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 18:00:40  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 18:00:40  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2624467
    [session_id] => rgl0ovj7opuv5untvfee0lo5c1
    [auth_time] => 1439308837
)
 scopes = profile openid email

08-11 18:00:40  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:00:40  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:00:40  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:00:40  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 18:00:40  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 18:02:29  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4109403
)

Input: 
Session:Array
(
    [auth_time] => 1439308837
    [lastlogin] => 1439308839
    [username] => alice
    [ops] => 30fba0bdc58ebeee4f5133557b54d553
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4109403","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 18:02:29  DEBUG prompt = 

08-11 18:02:29  DEBUG num prompt = 0 Array
(
)


08-11 18:02:29  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4109403
)
 scopes = profile openid email

08-11 18:02:29  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:02:29  DEBUG id_token claims = Array
(
)


08-11 18:02:29  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:02:29  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:02:29  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 18:02:31  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439308837
    [lastlogin] => 1439308839
    [username] => alice
    [ops] => 30fba0bdc58ebeee4f5133557b54d553
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4109403
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4109403
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4109403"} []
----------------------------------------------------------

08-11 18:02:31  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4109403
    [session_id] => rgl0ovj7opuv5untvfee0lo5c1
    [auth_time] => 1439308837
)
 scopes = profile openid email

08-11 18:02:31  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:02:31  DEBUG id_token claims = Array
(
)


08-11 18:02:31  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:02:31  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:02:31  DEBUG ss = sha256(spardecohttps://localhost30fba0bdc58ebeee4f5133557b54d553537317ebf6f8afb1d7d00a45476f25fc).537317ebf6f8afb1d7d00a45476f25fc

==============================================================================
08-11 18:02:31  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => O-zrGzFu-O2s4Hg4VFFMA_W486i8h8OHRQiKbqAz0lc
    [state] => 4109403
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=O-zrGzFu-O2s4Hg4VFFMA_W486i8h8OHRQiKbqAz0lc&state=4109403&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:02:31  DEBUG spardeco
client_secret_post

08-11 18:02:31  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 18:02:31  DEBUG requested idtoken claims = Array
(
)


08-11 18:02:31  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 18:02:31  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439309251
    [iat] => 1439308951
    [at_hash] => 2LrFQW3edkrtXX6GNGglVA
)


08-11 18:02:31  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 18:02:31  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA5MjUxLCJpYXQiOjE0MzkzMDg5NTEsImF0X2hhc2giOiIyTHJGUVczZWRrcnRYWDZHTkdnbFZBIn0.Omik1gParu2rGY86tVMh2RpY-JyRF8TY5WhNtuLNqGQPB05N-z90Y3XM-tABJ89UAgYzjQ53ATs_h9xhsEOjeQDYNHXj_DczYd89UCxRnQRu7vTWYEIwr4fJLmHvnGqWXcpBBPWIyzrclX_pCimJatTNFkFwcbt7vg5mtFPJmBtnO7Y8OrEBTIfob3Di4wjT6EibBdoRVlsVXLT7_bPgvJV43NFYqouWblas_6g2o-t-nqXBDh4cNYz5edjcpAenrbbZh6irG1Z2kCl959Tw_ogN89OsspkIAxNv4_HC09hVeJ0ASfUNjxQYvw_o9mOuLJx7ex5dgriZ_zCf9-9_5A

08-11 18:02:31  DEBUG token response = Array
(
    [access_token] => CHPTyMyf7Xwc0U0bisCC99bVKe9uWogDRtmIwoevbU4
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA5MjUxLCJpYXQiOjE0MzkzMDg5NTEsImF0X2hhc2giOiIyTHJGUVczZWRrcnRYWDZHTkdnbFZBIn0.Omik1gParu2rGY86tVMh2RpY-JyRF8TY5WhNtuLNqGQPB05N-z90Y3XM-tABJ89UAgYzjQ53ATs_h9xhsEOjeQDYNHXj_DczYd89UCxRnQRu7vTWYEIwr4fJLmHvnGqWXcpBBPWIyzrclX_pCimJatTNFkFwcbt7vg5mtFPJmBtnO7Y8OrEBTIfob3Di4wjT6EibBdoRVlsVXLT7_bPgvJV43NFYqouWblas_6g2o-t-nqXBDh4cNYz5edjcpAenrbbZh6irG1Z2kCl959Tw_ogN89OsspkIAxNv4_HC09hVeJ0ASfUNjxQYvw_o9mOuLJx7ex5dgriZ_zCf9-9_5A
)


==============================================================================
08-11 18:02:31  DEBUG Request: Array
(
    [access_token] => CHPTyMyf7Xwc0U0bisCC99bVKe9uWogDRtmIwoevbU4
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=CHPTyMyf7Xwc0U0bisCC99bVKe9uWogDRtmIwoevbU4","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:02:31  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 18:02:31  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 18:02:31  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 18:02:31  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4109403
    [session_id] => rgl0ovj7opuv5untvfee0lo5c1
    [auth_time] => 1439308837
)
 scopes = profile openid email

08-11 18:02:31  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:02:31  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:02:31  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:02:31  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 18:02:31  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 18:03:01  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => O-zrGzFu-O2s4Hg4VFFMA_W486i8h8OHRQiKbqAz0lc
    [state] => 4109403
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=O-zrGzFu-O2s4Hg4VFFMA_W486i8h8OHRQiKbqAz0lc&state=4109403&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:03:01  ERROR url: error:invalid_grant desc:no such code uri: state: code:400

08-11 18:03:01  ERROR HTTP/1.0 400 Bad Request
{"error":"invalid_grant","error_description":"no such code"}

==============================================================================
08-11 18:03:06  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4109403
)

Input: 
Session:Array
(
    [auth_time] => 1439308837
    [lastlogin] => 1439308951
    [username] => alice
    [ops] => 30fba0bdc58ebeee4f5133557b54d553
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4109403","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 18:03:06  DEBUG prompt = 

08-11 18:03:06  DEBUG num prompt = 0 Array
(
)


08-11 18:03:06  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4109403
)
 scopes = profile openid email

08-11 18:03:06  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:03:06  DEBUG id_token claims = Array
(
)


08-11 18:03:06  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:03:06  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:03:06  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 18:03:08  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439308837
    [lastlogin] => 1439308951
    [username] => alice
    [ops] => 30fba0bdc58ebeee4f5133557b54d553
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4109403
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4109403
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4109403"} []
----------------------------------------------------------

08-11 18:03:08  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4109403
    [session_id] => rgl0ovj7opuv5untvfee0lo5c1
    [auth_time] => 1439308837
)
 scopes = profile openid email

08-11 18:03:08  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:03:08  DEBUG id_token claims = Array
(
)


08-11 18:03:08  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:03:08  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:03:08  DEBUG ss = sha256(spardecohttps://localhost30fba0bdc58ebeee4f5133557b54d553e7c57374d96474cf58ae156e32a7dcf1).e7c57374d96474cf58ae156e32a7dcf1

==============================================================================
08-11 18:03:08  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => b683VFazeZGfplw4AM8HMg_EM9aUH4wmjZ5xaT85f3M
    [state] => 4109403
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=b683VFazeZGfplw4AM8HMg_EM9aUH4wmjZ5xaT85f3M&state=4109403&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:03:08  DEBUG spardeco
client_secret_post

08-11 18:03:08  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 18:03:09  DEBUG requested idtoken claims = Array
(
)


08-11 18:03:09  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 18:03:09  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439309289
    [iat] => 1439308989
    [at_hash] => hAjDx2Wd3am-8WgZjM53sA
)


08-11 18:03:09  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 18:03:09  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA5Mjg5LCJpYXQiOjE0MzkzMDg5ODksImF0X2hhc2giOiJoQWpEeDJXZDNhbS04V2daak01M3NBIn0.bKZkL3UIH3-K7zxFS9IJgCCrPoR5UmPgRBPZB5r1SafmR2jRKRrv535BfzMIjZx6DTsHXuyu0J94gap7_eyjBintU9leXMF2WmnGEAng045sdYtZg0aZMGwZ8gb5WCMyDltQuaY9NmsNavsnS8v7apctKHK1_3KTpORtAqZdN3AwMiP2KQju8WMzphUinJSUuk3sn5EIptjmqnHjrrROAcBKsIWMOcwKCj2whtRtGaNh2jQAqW1rq2Yqd_RLhj4wl9dMARYVOz0GiheAmCC3IzGkPExK8Sgd_YrHe1E80hKcWSi0EbhprZ1Cc8WYsIWILJb21adMHbuVVjsVxTHvQg

08-11 18:03:09  DEBUG token response = Array
(
    [access_token] => _BBtqjg7JedUpIkuEtgTrqvjjG3-Obn22KRn1QpPjiY
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA5Mjg5LCJpYXQiOjE0MzkzMDg5ODksImF0X2hhc2giOiJoQWpEeDJXZDNhbS04V2daak01M3NBIn0.bKZkL3UIH3-K7zxFS9IJgCCrPoR5UmPgRBPZB5r1SafmR2jRKRrv535BfzMIjZx6DTsHXuyu0J94gap7_eyjBintU9leXMF2WmnGEAng045sdYtZg0aZMGwZ8gb5WCMyDltQuaY9NmsNavsnS8v7apctKHK1_3KTpORtAqZdN3AwMiP2KQju8WMzphUinJSUuk3sn5EIptjmqnHjrrROAcBKsIWMOcwKCj2whtRtGaNh2jQAqW1rq2Yqd_RLhj4wl9dMARYVOz0GiheAmCC3IzGkPExK8Sgd_YrHe1E80hKcWSi0EbhprZ1Cc8WYsIWILJb21adMHbuVVjsVxTHvQg
)


==============================================================================
08-11 18:03:09  DEBUG Request: Array
(
    [access_token] => _BBtqjg7JedUpIkuEtgTrqvjjG3-Obn22KRn1QpPjiY
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=_BBtqjg7JedUpIkuEtgTrqvjjG3-Obn22KRn1QpPjiY","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:03:09  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 18:03:09  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 18:03:09  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 18:03:09  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4109403
    [session_id] => rgl0ovj7opuv5untvfee0lo5c1
    [auth_time] => 1439308837
)
 scopes = profile openid email

08-11 18:03:09  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:03:09  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:03:09  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:03:09  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 18:03:09  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 18:03:24  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2624467
)

Input: 
Session:Array
(
    [auth_time] => 1439308837
    [lastlogin] => 1439308988
    [username] => alice
    [ops] => 30fba0bdc58ebeee4f5133557b54d553
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2624467","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 18:03:24  DEBUG prompt = 

08-11 18:03:24  DEBUG num prompt = 0 Array
(
)


08-11 18:03:24  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2624467
)
 scopes = profile openid email

08-11 18:03:24  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:03:24  DEBUG id_token claims = Array
(
)


08-11 18:03:24  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:03:24  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:03:24  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 18:03:28  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7851781
)

Input: 
Session:Array
(
    [auth_time] => 1439308837
    [lastlogin] => 1439308988
    [username] => alice
    [ops] => 30fba0bdc58ebeee4f5133557b54d553
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2624467
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2624467
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7851781","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 18:03:28  DEBUG prompt = 

08-11 18:03:28  DEBUG num prompt = 0 Array
(
)


08-11 18:03:28  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7851781
)
 scopes = profile openid email

08-11 18:03:28  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:03:28  DEBUG id_token claims = Array
(
)


08-11 18:03:28  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:03:28  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:03:28  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 18:03:29  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439308837
    [lastlogin] => 1439308988
    [username] => alice
    [ops] => 30fba0bdc58ebeee4f5133557b54d553
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7851781
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7851781
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7851781"} []
----------------------------------------------------------

08-11 18:03:29  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7851781
    [session_id] => rgl0ovj7opuv5untvfee0lo5c1
    [auth_time] => 1439308837
)
 scopes = profile openid email

08-11 18:03:29  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:03:29  DEBUG id_token claims = Array
(
)


08-11 18:03:29  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:03:29  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:03:29  DEBUG ss = sha256(spardecohttps://localhost30fba0bdc58ebeee4f5133557b54d5538e2b3eefec7ad8ae5a016017d01cc4d0).8e2b3eefec7ad8ae5a016017d01cc4d0

==============================================================================
08-11 18:03:30  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => b2zODQae_39C3hz_-ycuwjMVavB9wFrKR_HpekmiQyA
    [state] => 7851781
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=b2zODQae_39C3hz_-ycuwjMVavB9wFrKR_HpekmiQyA&state=7851781&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:03:30  DEBUG spardeco
client_secret_post

08-11 18:03:30  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 18:03:30  DEBUG requested idtoken claims = Array
(
)


08-11 18:03:30  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 18:03:30  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439309310
    [iat] => 1439309010
    [at_hash] => gteVIW9zi9z-r0knv1DNjQ
)


08-11 18:03:30  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 18:03:30  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA5MzEwLCJpYXQiOjE0MzkzMDkwMTAsImF0X2hhc2giOiJndGVWSVc5emk5ei1yMGtudjFETmpRIn0.rZR1aRsy--dHhwEViBObTk2FKWR7qMHWwmrs53p1xfrOncW7wO4UURSEHxBtmLJmp7wqfcDtLgpgjpXikSWPnTk9_ug_6MqoEmWp46em2Gh9elAuDmH1W1yTOZl7xxYOabu11uzBEuE4MgPwc-jW2LGFyfn-hCk_AQ4-GRVF2L7P0jAPippNz_DRgocmeOxUs98oAt65vfgP_fJrwYZ6F1A8Bjvepgc_u5Bo4-6PTnRyKwLpOK-OJBErr-8frLOhkyVTxSTlv0VOOmLxRfxDfsRNK8oI18bYdcmcoQJV6qIc6a_vflME0jog_R1j9ONAKI45Du6PdikPNI8KM20mBA

08-11 18:03:30  DEBUG token response = Array
(
    [access_token] => MKLxli2APap4WKW7NNIj46U3W5gcOK3BmrVRNYhyo5s
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA5MzEwLCJpYXQiOjE0MzkzMDkwMTAsImF0X2hhc2giOiJndGVWSVc5emk5ei1yMGtudjFETmpRIn0.rZR1aRsy--dHhwEViBObTk2FKWR7qMHWwmrs53p1xfrOncW7wO4UURSEHxBtmLJmp7wqfcDtLgpgjpXikSWPnTk9_ug_6MqoEmWp46em2Gh9elAuDmH1W1yTOZl7xxYOabu11uzBEuE4MgPwc-jW2LGFyfn-hCk_AQ4-GRVF2L7P0jAPippNz_DRgocmeOxUs98oAt65vfgP_fJrwYZ6F1A8Bjvepgc_u5Bo4-6PTnRyKwLpOK-OJBErr-8frLOhkyVTxSTlv0VOOmLxRfxDfsRNK8oI18bYdcmcoQJV6qIc6a_vflME0jog_R1j9ONAKI45Du6PdikPNI8KM20mBA
)


==============================================================================
08-11 18:03:30  DEBUG Request: Array
(
    [access_token] => MKLxli2APap4WKW7NNIj46U3W5gcOK3BmrVRNYhyo5s
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=MKLxli2APap4WKW7NNIj46U3W5gcOK3BmrVRNYhyo5s","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:03:30  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 18:03:30  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 18:03:30  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 18:03:30  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7851781
    [session_id] => rgl0ovj7opuv5untvfee0lo5c1
    [auth_time] => 1439308837
)
 scopes = profile openid email

08-11 18:03:30  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:03:30  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:03:30  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:03:30  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 18:03:30  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 18:03:58  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2372835
)

Input: 
Session:Array
(
    [auth_time] => 1439308837
    [lastlogin] => 1439309009
    [username] => alice
    [ops] => 30fba0bdc58ebeee4f5133557b54d553
    [login] => 1
    [persist] => on
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2372835","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 18:03:58  DEBUG prompt = 

08-11 18:03:58  DEBUG num prompt = 0 Array
(
)


08-11 18:03:58  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2372835
)
 scopes = profile openid email

08-11 18:03:58  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:03:58  DEBUG id_token claims = Array
(
)


08-11 18:03:58  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:03:58  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:03:58  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 18:04:05  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9883639
)

Input: 
Session:Array
(
    [auth_time] => 1439308837
    [lastlogin] => 1439309009
    [username] => alice
    [ops] => 30fba0bdc58ebeee4f5133557b54d553
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2372835
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2372835
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9883639","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 18:04:05  DEBUG prompt = 

08-11 18:04:05  DEBUG num prompt = 0 Array
(
)


08-11 18:04:05  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9883639
)
 scopes = profile openid email

08-11 18:04:05  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:04:05  DEBUG id_token claims = Array
(
)


08-11 18:04:05  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:04:05  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:04:05  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 18:04:06  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [auth_time] => 1439308837
    [lastlogin] => 1439309009
    [username] => alice
    [ops] => 30fba0bdc58ebeee4f5133557b54d553
    [login] => 1
    [persist] => on
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9883639
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9883639
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9883639"} []
----------------------------------------------------------

08-11 18:04:06  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9883639
    [session_id] => rgl0ovj7opuv5untvfee0lo5c1
    [auth_time] => 1439308837
)
 scopes = profile openid email

08-11 18:04:06  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:04:06  DEBUG id_token claims = Array
(
)


08-11 18:04:06  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:04:06  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:04:06  DEBUG ss = sha256(spardecohttps://localhost30fba0bdc58ebeee4f5133557b54d55365627c8d0887722a3c677ae534e0b043).65627c8d0887722a3c677ae534e0b043

==============================================================================
08-11 18:04:07  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => HrO1DmJjvhgTs0k3QInFbpwOctpqN37iR3UW0pbYxik
    [state] => 9883639
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=HrO1DmJjvhgTs0k3QInFbpwOctpqN37iR3UW0pbYxik&state=9883639&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:04:07  DEBUG spardeco
client_secret_post

08-11 18:04:07  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 18:04:07  DEBUG requested idtoken claims = Array
(
)


08-11 18:04:07  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 18:04:07  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439309347
    [iat] => 1439309047
    [at_hash] => YQh2F6ZiLF-fyneB41wonw
)


08-11 18:04:07  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 18:04:07  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA5MzQ3LCJpYXQiOjE0MzkzMDkwNDcsImF0X2hhc2giOiJZUWgyRjZaaUxGLWZ5bmVCNDF3b253In0.PpDl2Dm9B3oxSfCixsYF6nKbzsaoaZONZBxp7iY0GhwmbdaoNEoI5QnL6JbLg9XCKjh0lDLRSzIP_CoMwbris9XnlYTctqoVrBVJ2nCSzQogJ2XBIEVF-xU3rP6-cl9vKJhYuHrPhpfYQ2ANf-0QdNVUL9OBMUuPGVjKPvzbk-gViTEPJDOzTZ_S_qhGLu4aSD4Z5surmCcw48-A1VpfWiOVLb_G8hl7qcGxVbQucIA1liPDLvRnea4MpMOKh85uZDTwtjvt1haHWlUHpQuPLR_xM6I4f3x3vymd5O149FHRtFml0fO_na2zBeF4_CE3jAo1F5wbZNWDs9rUlZPGxQ

08-11 18:04:07  DEBUG token response = Array
(
    [access_token] => enQUfV_K_VK6boAkg4VO_6zst1AE-LDsseyMDjDBol4
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA5MzQ3LCJpYXQiOjE0MzkzMDkwNDcsImF0X2hhc2giOiJZUWgyRjZaaUxGLWZ5bmVCNDF3b253In0.PpDl2Dm9B3oxSfCixsYF6nKbzsaoaZONZBxp7iY0GhwmbdaoNEoI5QnL6JbLg9XCKjh0lDLRSzIP_CoMwbris9XnlYTctqoVrBVJ2nCSzQogJ2XBIEVF-xU3rP6-cl9vKJhYuHrPhpfYQ2ANf-0QdNVUL9OBMUuPGVjKPvzbk-gViTEPJDOzTZ_S_qhGLu4aSD4Z5surmCcw48-A1VpfWiOVLb_G8hl7qcGxVbQucIA1liPDLvRnea4MpMOKh85uZDTwtjvt1haHWlUHpQuPLR_xM6I4f3x3vymd5O149FHRtFml0fO_na2zBeF4_CE3jAo1F5wbZNWDs9rUlZPGxQ
)


==============================================================================
08-11 18:04:07  DEBUG Request: Array
(
    [access_token] => enQUfV_K_VK6boAkg4VO_6zst1AE-LDsseyMDjDBol4
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=enQUfV_K_VK6boAkg4VO_6zst1AE-LDsseyMDjDBol4","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:04:07  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 18:04:07  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 18:04:07  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 18:04:07  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9883639
    [session_id] => rgl0ovj7opuv5untvfee0lo5c1
    [auth_time] => 1439308837
)
 scopes = profile openid email

08-11 18:04:07  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:04:07  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:04:07  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:04:07  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 18:04:07  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-11 18:04:48  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5671854
)

Input: 
Session:Array
(
    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439299535
    [ops] => 8ae42122234d91bbe108e8fa10a0acd8
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 7813386
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid
            [state] => 7813386
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5671854","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-11 18:04:48  DEBUG prompt = 

08-11 18:04:48  DEBUG num prompt = 0 Array
(
)


08-11 18:04:48  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5671854
)
 scopes = profile openid email

08-11 18:04:48  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:04:48  DEBUG id_token claims = Array
(
)


08-11 18:04:48  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:04:48  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:04:48  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-11 18:04:50  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439299535
    [ops] => 8ae42122234d91bbe108e8fa10a0acd8
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5671854
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5671854
        )

)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5671854"} []
----------------------------------------------------------

08-11 18:04:50  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5671854
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439299535
)
 scopes = profile openid email

08-11 18:04:50  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:04:50  DEBUG id_token claims = Array
(
)


08-11 18:04:50  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-11 18:04:50  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:04:50  DEBUG ss = sha256(spardecohttps://localhost8ae42122234d91bbe108e8fa10a0acd8d35a9894d2317287743bb63bb3c3f97e).d35a9894d2317287743bb63bb3c3f97e

==============================================================================
08-11 18:04:50  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => D5gEI4dDeoWXdPqIKzsxja21t3saxT7qPLAaTNEUUGE
    [state] => 5671854
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=D5gEI4dDeoWXdPqIKzsxja21t3saxT7qPLAaTNEUUGE&state=5671854&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:04:50  DEBUG spardeco
client_secret_post

08-11 18:04:50  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-11 18:04:50  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-11 18:04:50  DEBUG requested idtoken claims = Array
(
)


08-11 18:04:50  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 18:04:50  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439309390
    [iat] => 1439309090
    [at_hash] => Z-8E0SoZ0FIimc18-N46aw
)


08-11 18:04:50  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-11 18:04:50  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA5MzkwLCJpYXQiOjE0MzkzMDkwOTAsImF0X2hhc2giOiJaLThFMFNvWjBGSWltYzE4LU40NmF3In0.V3908QIgxN_BxW-5grVkIzRzzrZv94vmTJS2jq81Fujc_ge0fK9AwSKZV3ae_DaTkP_JLNf52Y59isqC9hWoeA0g5Vw989eft0KCbsiHg-xR84bIw5Yo2zXiklWFEPGd4eDbnl-NopKJNBpNh0UZiKvHb-Y08Kjr-1JLLgqK8ChsRnct0ApnMLEELVIOLfGIawWZHiWFcKOzoR4AWARV9u-51YfEzq5UP8MUApfoZSWv-KyGtA5pKGbQoenpUIPgKaRntuPzWhRQedRtbO77ia01Uw3SMoZKkV8IpZs3vaRKfX6DORtV49H6OW6dy6cw7DftVxIEmiVpcdGpDROZpw

08-11 18:04:50  DEBUG token response = Array
(
    [access_token] => DXxHRqG-JmXyvLfFFuLiWH_Xs5YStbEu-h_PsC4Ja20
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzA5MzkwLCJpYXQiOjE0MzkzMDkwOTAsImF0X2hhc2giOiJaLThFMFNvWjBGSWltYzE4LU40NmF3In0.V3908QIgxN_BxW-5grVkIzRzzrZv94vmTJS2jq81Fujc_ge0fK9AwSKZV3ae_DaTkP_JLNf52Y59isqC9hWoeA0g5Vw989eft0KCbsiHg-xR84bIw5Yo2zXiklWFEPGd4eDbnl-NopKJNBpNh0UZiKvHb-Y08Kjr-1JLLgqK8ChsRnct0ApnMLEELVIOLfGIawWZHiWFcKOzoR4AWARV9u-51YfEzq5UP8MUApfoZSWv-KyGtA5pKGbQoenpUIPgKaRntuPzWhRQedRtbO77ia01Uw3SMoZKkV8IpZs3vaRKfX6DORtV49H6OW6dy6cw7DftVxIEmiVpcdGpDROZpw
)


==============================================================================
08-11 18:04:50  DEBUG Request: Array
(
    [access_token] => DXxHRqG-JmXyvLfFFuLiWH_Xs5YStbEu-h_PsC4Ja20
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=DXxHRqG-JmXyvLfFFuLiWH_Xs5YStbEu-h_PsC4Ja20","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-11 18:04:51  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-11 18:04:51  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-11 18:04:51  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-11 18:04:51  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5671854
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439299535
)
 scopes = profile openid email

08-11 18:04:51  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:04:51  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-11 18:04:51  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-11 18:04:51  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-11 18:04:51  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 10:29:43  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2365895
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2365895","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 10:29:44  DEBUG prompt = 

08-12 10:29:44  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 10:29:46  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2365895
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2365895
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2365895"} []
----------------------------------------------------------

08-12 10:29:46  DEBUG Auth_time = 1439368186

08-12 10:29:46  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 10:29:46  DEBUG prompt = 

08-12 10:29:46  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2365895
)
 scopes = profile openid email

08-12 10:29:46  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 10:29:46  DEBUG id_token claims = Array
(
)


08-12 10:29:46  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 10:29:46  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 10:29:46  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 10:29:49  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2365895
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2365895
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439368186
    [ops] => 043ab46466f26b016d95b9c76ce92572
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 10:29:49  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2365895
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439368186
)
 scopes = profile openid email

08-12 10:29:49  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 10:29:49  DEBUG id_token claims = Array
(
)


08-12 10:29:49  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 10:29:49  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 10:29:49  DEBUG ss = sha256(spardecohttps://localhost043ab46466f26b016d95b9c76ce92572db2665604ef1749a61e32019651d28d3).db2665604ef1749a61e32019651d28d3

==============================================================================
08-12 10:29:49  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 6LD2gT5J2mPgLN1oCPKsLkzLgS3xWMhKttAPRAJBqKI
    [state] => 2365895
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=6LD2gT5J2mPgLN1oCPKsLkzLgS3xWMhKttAPRAJBqKI&state=2365895&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 10:29:49  DEBUG spardeco
client_secret_post

08-12 10:29:49  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 10:29:50  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 10:29:50  DEBUG requested idtoken claims = Array
(
)


08-12 10:29:50  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 10:29:50  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439368490
    [iat] => 1439368190
    [at_hash] => mmARyrDbIN3N7nskjHmVOw
)


08-12 10:29:50  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 10:29:50  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzY4NDkwLCJpYXQiOjE0MzkzNjgxOTAsImF0X2hhc2giOiJtbUFSeXJEYklOM043bnNrakhtVk93In0.wxVMyemL74-QAHxwLzm_qgXZbXSgkCZoIQvZe6EPL2ipS2xOC-2bZCCY0BbCgUWrgDDQE5OWgX0HySIdYy4sS4eenEGzKQVWj5ldMRn8R15_D6gnME2ojHt3_C0QRxzCJtcAO3XpPQ88o61JqZBpAFoLbdzPmYpq2EohSxTPPQ_qhTo-KnSxKqoyqwnD4I3mrWWmuUqin00I6u-UpAEJaAadBmf7a0EcKsh58cb5VYioLfksV40ybkJoKde0JsPnSA8tGJIogJI7VuSeCcUxnrm_GSWAPMTA_rQdVJbwYUWVaRglv-yMf3y-ruRS7nIIVkn-2dwNW9ggJwnIGg5_pg

08-12 10:29:50  DEBUG token response = Array
(
    [access_token] => 2QWLcvS1A1-lkboJEYINMxPQH4wfb2kOOJFrPhHm8_4
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzY4NDkwLCJpYXQiOjE0MzkzNjgxOTAsImF0X2hhc2giOiJtbUFSeXJEYklOM043bnNrakhtVk93In0.wxVMyemL74-QAHxwLzm_qgXZbXSgkCZoIQvZe6EPL2ipS2xOC-2bZCCY0BbCgUWrgDDQE5OWgX0HySIdYy4sS4eenEGzKQVWj5ldMRn8R15_D6gnME2ojHt3_C0QRxzCJtcAO3XpPQ88o61JqZBpAFoLbdzPmYpq2EohSxTPPQ_qhTo-KnSxKqoyqwnD4I3mrWWmuUqin00I6u-UpAEJaAadBmf7a0EcKsh58cb5VYioLfksV40ybkJoKde0JsPnSA8tGJIogJI7VuSeCcUxnrm_GSWAPMTA_rQdVJbwYUWVaRglv-yMf3y-ruRS7nIIVkn-2dwNW9ggJwnIGg5_pg
)


==============================================================================
08-12 10:29:50  DEBUG Request: Array
(
    [access_token] => 2QWLcvS1A1-lkboJEYINMxPQH4wfb2kOOJFrPhHm8_4
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=2QWLcvS1A1-lkboJEYINMxPQH4wfb2kOOJFrPhHm8_4","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 10:29:50  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 10:29:50  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 10:29:50  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 10:29:50  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2365895
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439368186
)
 scopes = profile openid email

08-12 10:29:50  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 10:29:50  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 10:29:50  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 10:29:50  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 10:29:50  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 10:33:17  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 6LD2gT5J2mPgLN1oCPKsLkzLgS3xWMhKttAPRAJBqKI
    [state] => 2365895
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=6LD2gT5J2mPgLN1oCPKsLkzLgS3xWMhKttAPRAJBqKI&state=2365895&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 10:33:17  ERROR url: error:invalid_grant desc:no such code uri: state: code:400

08-12 10:33:17  ERROR HTTP/1.0 400 Bad Request
{"error":"invalid_grant","error_description":"no such code"}

==============================================================================
08-12 10:33:27  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2365895
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2365895","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 10:33:27  DEBUG prompt = 

08-12 10:33:27  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 10:33:28  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2365895
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2365895
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2365895"} []
----------------------------------------------------------

08-12 10:33:28  DEBUG Auth_time = 1439368408

08-12 10:33:28  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 10:33:28  DEBUG prompt = 

08-12 10:33:28  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2365895
)
 scopes = profile openid email

08-12 10:33:28  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 10:33:28  DEBUG id_token claims = Array
(
)


08-12 10:33:28  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 10:33:28  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 10:33:28  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 10:33:30  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2365895
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2365895
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439368408
    [ops] => bef968e0db76a95fed41e58a19f6935f
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 10:33:30  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2365895
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439368408
)
 scopes = profile openid email

08-12 10:33:30  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 10:33:30  DEBUG id_token claims = Array
(
)


08-12 10:33:30  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 10:33:30  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 10:33:30  DEBUG ss = sha256(spardecohttps://localhostbef968e0db76a95fed41e58a19f6935f119a1781c9e8698779e8dbbbe203a06e).119a1781c9e8698779e8dbbbe203a06e

==============================================================================
08-12 10:33:31  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => yF_nIyTH1s_V_7ArMQk2yPo7r3zBqu-MmgzL72Wk71s
    [state] => 2365895
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=yF_nIyTH1s_V_7ArMQk2yPo7r3zBqu-MmgzL72Wk71s&state=2365895&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 10:33:31  DEBUG spardeco
client_secret_post

08-12 10:33:31  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 10:33:31  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 10:33:31  DEBUG requested idtoken claims = Array
(
)


08-12 10:33:31  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 10:33:31  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439368711
    [iat] => 1439368411
    [at_hash] => X7fYDB1GYX90PrXiUAiNeA
)


08-12 10:33:31  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 10:33:31  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzY4NzExLCJpYXQiOjE0MzkzNjg0MTEsImF0X2hhc2giOiJYN2ZZREIxR1lYOTBQclhpVUFpTmVBIn0.PAe95ojgEYnvTsuaa5QFTYfQGR2wGiNXh4o8-qPWOvZmg4-UB0ifcm92mAqWH4HLcPb1jYCR-Di7GcSNT6R85vfdoFMsjnIZYTELOpVAbxIrV3vLPo5OABh4sSfP4v55OB7qLBhj_hmo_VJg7EqF1VfOF1HipbMOTAO0B8cJcCCQTAysAZd4H5liT5CCKBmyiRh3-1TeWOauYY0jc36pspepIHI10VArPraXqAoDimov5OrP1W9iOgYH_FIh3QA2WkXt1YGD0XPGBAoOBKK8H0nucbxmOX_ZKs9_ySmlmgoPCAWUE_lg7jfsAewcidkeCAykoICBsldpoJMhsY_X_A

08-12 10:33:31  DEBUG token response = Array
(
    [access_token] => _zt-YmU_C8wENT-F15WEf_-_2TJVgm6jMiNaqT3sv4g
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzY4NzExLCJpYXQiOjE0MzkzNjg0MTEsImF0X2hhc2giOiJYN2ZZREIxR1lYOTBQclhpVUFpTmVBIn0.PAe95ojgEYnvTsuaa5QFTYfQGR2wGiNXh4o8-qPWOvZmg4-UB0ifcm92mAqWH4HLcPb1jYCR-Di7GcSNT6R85vfdoFMsjnIZYTELOpVAbxIrV3vLPo5OABh4sSfP4v55OB7qLBhj_hmo_VJg7EqF1VfOF1HipbMOTAO0B8cJcCCQTAysAZd4H5liT5CCKBmyiRh3-1TeWOauYY0jc36pspepIHI10VArPraXqAoDimov5OrP1W9iOgYH_FIh3QA2WkXt1YGD0XPGBAoOBKK8H0nucbxmOX_ZKs9_ySmlmgoPCAWUE_lg7jfsAewcidkeCAykoICBsldpoJMhsY_X_A
)


==============================================================================
08-12 10:33:31  DEBUG Request: Array
(
    [access_token] => _zt-YmU_C8wENT-F15WEf_-_2TJVgm6jMiNaqT3sv4g
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=_zt-YmU_C8wENT-F15WEf_-_2TJVgm6jMiNaqT3sv4g","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 10:33:31  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 10:33:31  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 10:33:31  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 10:33:31  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2365895
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439368408
)
 scopes = profile openid email

08-12 10:33:31  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 10:33:31  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 10:33:31  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 10:33:31  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 10:33:31  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:10:58  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6488430
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6488430","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:10:58  DEBUG prompt = 

08-12 11:10:58  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:11:00  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6488430
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6488430
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6488430"} []
----------------------------------------------------------

08-12 11:11:00  DEBUG Auth_time = 1439370660

08-12 11:11:00  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:11:00  DEBUG prompt = 

08-12 11:11:00  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6488430
)
 scopes = profile openid email

08-12 11:11:00  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:11:00  DEBUG id_token claims = Array
(
)


08-12 11:11:00  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:11:00  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:11:00  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:11:02  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6488430
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6488430
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439370660
    [ops] => b3af79c44ce5d35b9898962c2ae3e443
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:11:02  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6488430
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439370660
)
 scopes = profile openid email

08-12 11:11:02  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:11:02  DEBUG id_token claims = Array
(
)


08-12 11:11:02  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:11:02  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:11:02  DEBUG ss = sha256(spardecohttps://localhostb3af79c44ce5d35b9898962c2ae3e443f87cda67ca5454950e85a607689c68d6).f87cda67ca5454950e85a607689c68d6

==============================================================================
08-12 11:11:02  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => XGMjV6kb4YsDsbMcUOP_cMCzm-GlGytUaxxyOi35xZk
    [state] => 6488430
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=XGMjV6kb4YsDsbMcUOP_cMCzm-GlGytUaxxyOi35xZk&state=6488430&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:11:02  DEBUG spardeco
client_secret_post

08-12 11:11:02  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:11:02  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:11:02  DEBUG requested idtoken claims = Array
(
)


08-12 11:11:02  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:11:02  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439370962
    [iat] => 1439370662
    [at_hash] => B8o-RQLfqnTVn3yU3MMyLQ
)


08-12 11:11:02  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:11:02  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcwOTYyLCJpYXQiOjE0MzkzNzA2NjIsImF0X2hhc2giOiJCOG8tUlFMZnFuVFZuM3lVM01NeUxRIn0.bMFWj_vQL_hKc86REDmtUTWQUkXlg6ABN83z_l_IKu1Uz9cykAirmOpJ1eFqNuaq6ehxEGTqZJ_ufO43MXLXVziaSpahi364t4VuP8_UJX99XVxSFujW3QUfThM6rjrxfQWIAIGQMoiSHZ_UFmktKGvU_c2UeX92wi_fBB-OOtRz52TxlYGLGVmaKPdReZZSn94siYUS4mfjM6LIdOSfYRpWT45j6puacx-iaye3puJtxljNeqv4qXgZyFoUhr8QGgqw_PMh6QjMb69svgjS8jsKSIUaeuoBThypPKTu5OVe99xkEDBd9GhE2FkI4CTkdZ380_Snb0MjClSZmETNOQ

08-12 11:11:02  DEBUG token response = Array
(
    [access_token] => rVUe20LaKCxRM7axhHA8wVwl-GiMASLE4HXZYNbYmNI
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcwOTYyLCJpYXQiOjE0MzkzNzA2NjIsImF0X2hhc2giOiJCOG8tUlFMZnFuVFZuM3lVM01NeUxRIn0.bMFWj_vQL_hKc86REDmtUTWQUkXlg6ABN83z_l_IKu1Uz9cykAirmOpJ1eFqNuaq6ehxEGTqZJ_ufO43MXLXVziaSpahi364t4VuP8_UJX99XVxSFujW3QUfThM6rjrxfQWIAIGQMoiSHZ_UFmktKGvU_c2UeX92wi_fBB-OOtRz52TxlYGLGVmaKPdReZZSn94siYUS4mfjM6LIdOSfYRpWT45j6puacx-iaye3puJtxljNeqv4qXgZyFoUhr8QGgqw_PMh6QjMb69svgjS8jsKSIUaeuoBThypPKTu5OVe99xkEDBd9GhE2FkI4CTkdZ380_Snb0MjClSZmETNOQ
)


==============================================================================
08-12 11:11:02  DEBUG Request: Array
(
    [access_token] => rVUe20LaKCxRM7axhHA8wVwl-GiMASLE4HXZYNbYmNI
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=rVUe20LaKCxRM7axhHA8wVwl-GiMASLE4HXZYNbYmNI","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:11:03  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:11:03  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:11:03  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:11:03  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6488430
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439370660
)
 scopes = profile openid email

08-12 11:11:03  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:11:03  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:11:03  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:11:03  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:11:03  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:12:33  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6488430
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6488430","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:12:34  DEBUG prompt = 

08-12 11:12:34  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:12:38  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1956365
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6488430
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6488430
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1956365","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:12:38  DEBUG prompt = 

08-12 11:12:38  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:12:40  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1956365
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1956365
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1956365"} []
----------------------------------------------------------

08-12 11:12:40  DEBUG Auth_time = 1439370760

08-12 11:12:40  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:12:40  DEBUG prompt = 

08-12 11:12:40  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1956365
)
 scopes = profile openid email

08-12 11:12:40  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:12:40  DEBUG id_token claims = Array
(
)


08-12 11:12:40  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:12:40  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:12:40  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:12:41  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1956365
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1956365
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439370760
    [ops] => 2df00305be7ba981ee6b80ef1771ceaa
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:12:41  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1956365
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439370760
)
 scopes = profile openid email

08-12 11:12:41  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:12:41  DEBUG id_token claims = Array
(
)


08-12 11:12:41  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:12:41  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:12:41  DEBUG ss = sha256(spardecohttps://localhost2df00305be7ba981ee6b80ef1771ceaa11735115eeaec9de9cf8b1b37d7c2a65).11735115eeaec9de9cf8b1b37d7c2a65

==============================================================================
08-12 11:12:41  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 2OccC16hqJSvWrxE0Qaf9jVHXSX2FTO6tSXI4xpQCRc
    [state] => 1956365
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=2OccC16hqJSvWrxE0Qaf9jVHXSX2FTO6tSXI4xpQCRc&state=1956365&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:12:42  DEBUG spardeco
client_secret_post

08-12 11:12:42  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:12:42  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:12:42  DEBUG requested idtoken claims = Array
(
)


08-12 11:12:42  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:12:42  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439371062
    [iat] => 1439370762
    [at_hash] => lutGXWk443MuVAYOXjzhEg
)


08-12 11:12:42  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:12:42  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcxMDYyLCJpYXQiOjE0MzkzNzA3NjIsImF0X2hhc2giOiJsdXRHWFdrNDQzTXVWQVlPWGp6aEVnIn0.kEI3FBp5nTIPal4-EBgYv7x88xX4yvmOh0N9mUGDD4MIQPJhAS-z_fyjFxc7qeRd6rb-2-0HK0oV9Vk67BNaTo29bpxdWOjPZ1guLKWFG6oX-cAFBCWSqa5b-KnsXI6nfO4dbns_RiLrCUxQOr-ttWH2JdP86K6MwY39of5Z4_jvZCHFdY4OizMiTHsH21VqP-7JeC6GErmcbPwvUUOYfnkPCV22X7R4TBF-Sc4tptErHUrClznhRF6CE6LBPgk6R7gUkaBf-a_F2ZJmFQjABpPkgwadXEJTOEsJuj3mn0tNT9ToBKlTXb1g7kYXJsuLDOPORXeB_xv86viB4cMLIA

08-12 11:12:42  DEBUG token response = Array
(
    [access_token] => 7q3J2XZDsIFgGkxlt7ax11KiFeUp-_u8aMd5DrIRqGY
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcxMDYyLCJpYXQiOjE0MzkzNzA3NjIsImF0X2hhc2giOiJsdXRHWFdrNDQzTXVWQVlPWGp6aEVnIn0.kEI3FBp5nTIPal4-EBgYv7x88xX4yvmOh0N9mUGDD4MIQPJhAS-z_fyjFxc7qeRd6rb-2-0HK0oV9Vk67BNaTo29bpxdWOjPZ1guLKWFG6oX-cAFBCWSqa5b-KnsXI6nfO4dbns_RiLrCUxQOr-ttWH2JdP86K6MwY39of5Z4_jvZCHFdY4OizMiTHsH21VqP-7JeC6GErmcbPwvUUOYfnkPCV22X7R4TBF-Sc4tptErHUrClznhRF6CE6LBPgk6R7gUkaBf-a_F2ZJmFQjABpPkgwadXEJTOEsJuj3mn0tNT9ToBKlTXb1g7kYXJsuLDOPORXeB_xv86viB4cMLIA
)


==============================================================================
08-12 11:12:42  DEBUG Request: Array
(
    [access_token] => 7q3J2XZDsIFgGkxlt7ax11KiFeUp-_u8aMd5DrIRqGY
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=7q3J2XZDsIFgGkxlt7ax11KiFeUp-_u8aMd5DrIRqGY","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:12:42  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:12:42  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:12:42  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:12:42  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1956365
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439370760
)
 scopes = profile openid email

08-12 11:12:42  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:12:42  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:12:42  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:12:42  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:12:42  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:13:22  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1956365
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1956365","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:13:22  DEBUG prompt = 

08-12 11:13:22  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:13:27  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3989186
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1956365
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1956365
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3989186","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:13:27  DEBUG prompt = 

08-12 11:13:27  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:13:30  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3989186
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3989186
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3989186"} []
----------------------------------------------------------

08-12 11:13:30  DEBUG Auth_time = 1439370810

08-12 11:13:30  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:13:30  DEBUG prompt = 

08-12 11:13:30  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3989186
)
 scopes = profile openid email

08-12 11:13:30  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:13:30  DEBUG id_token claims = Array
(
)


08-12 11:13:30  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:13:30  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:13:30  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:13:31  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3989186
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3989186
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439370810
    [ops] => 455778d44ce4178e45c185763ae73b47
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:13:32  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3989186
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439370810
)
 scopes = profile openid email

08-12 11:13:32  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:13:32  DEBUG id_token claims = Array
(
)


08-12 11:13:32  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:13:32  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:13:32  DEBUG ss = sha256(spardecohttps://localhost455778d44ce4178e45c185763ae73b472ab963959b96c1c3701ce0bb91914ea0).2ab963959b96c1c3701ce0bb91914ea0

==============================================================================
08-12 11:13:32  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => yyTzGlX-4XtgYk7DB8IrYXyvOlTC7R9TooULlI3PXss
    [state] => 3989186
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=yyTzGlX-4XtgYk7DB8IrYXyvOlTC7R9TooULlI3PXss&state=3989186&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:13:32  DEBUG spardeco
client_secret_post

08-12 11:13:32  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:13:32  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:13:32  DEBUG requested idtoken claims = Array
(
)


08-12 11:13:32  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:13:32  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439371112
    [iat] => 1439370812
    [at_hash] => 26A6ruO1hzp35HjLnYknkg
)


08-12 11:13:32  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:13:32  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcxMTEyLCJpYXQiOjE0MzkzNzA4MTIsImF0X2hhc2giOiIyNkE2cnVPMWh6cDM1SGpMbllrbmtnIn0.MKxzxt7e3_nAjuztufzTTolQNA_6oB0K7KLsbqj6a6MTMOcJMsLEuBdmUQIP0W2ABw2i8ksyFoLdtUy6zShIaSLMek6eJxOJPWyXQI1WzESQg7_CX9MwxRqtBRysfbkLgm4c48JG5I_ayjePlLCU1RFMR43xgBgOOQTEYQ_cxFsplMiv8_X9EH4v5X1tebOdysyKnUH5gtTbklux4zU1-N1cpxG78traUQHZ4kSmPdR9Mq7BF52mVDPDRbq6mXg2ELKd6i5AHJo7fTTyZ0Ia_dZtWhyZoZ4oGLTAJffiJN-4vjwdQ0L17uJSaGuHjuzabl0RQDyJrORRrb-rK5pNAA

08-12 11:13:32  DEBUG token response = Array
(
    [access_token] => grBnVvuHdM_FUrG2P7qWtHa_q6RwHgCBNsHJglKptdw
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcxMTEyLCJpYXQiOjE0MzkzNzA4MTIsImF0X2hhc2giOiIyNkE2cnVPMWh6cDM1SGpMbllrbmtnIn0.MKxzxt7e3_nAjuztufzTTolQNA_6oB0K7KLsbqj6a6MTMOcJMsLEuBdmUQIP0W2ABw2i8ksyFoLdtUy6zShIaSLMek6eJxOJPWyXQI1WzESQg7_CX9MwxRqtBRysfbkLgm4c48JG5I_ayjePlLCU1RFMR43xgBgOOQTEYQ_cxFsplMiv8_X9EH4v5X1tebOdysyKnUH5gtTbklux4zU1-N1cpxG78traUQHZ4kSmPdR9Mq7BF52mVDPDRbq6mXg2ELKd6i5AHJo7fTTyZ0Ia_dZtWhyZoZ4oGLTAJffiJN-4vjwdQ0L17uJSaGuHjuzabl0RQDyJrORRrb-rK5pNAA
)


==============================================================================
08-12 11:13:32  DEBUG Request: Array
(
    [access_token] => grBnVvuHdM_FUrG2P7qWtHa_q6RwHgCBNsHJglKptdw
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=grBnVvuHdM_FUrG2P7qWtHa_q6RwHgCBNsHJglKptdw","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:13:32  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:13:32  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:13:32  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:13:32  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3989186
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439370810
)
 scopes = profile openid email

08-12 11:13:32  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:13:32  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:13:32  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:13:32  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:13:32  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:14:08  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3989186
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3989186","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:14:08  DEBUG prompt = 

08-12 11:14:08  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:14:10  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3989186
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3989186
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3989186"} []
----------------------------------------------------------

08-12 11:14:10  DEBUG Auth_time = 1439370850

08-12 11:14:10  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:14:10  DEBUG prompt = 

08-12 11:14:10  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3989186
)
 scopes = profile openid email

08-12 11:14:10  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:14:10  DEBUG id_token claims = Array
(
)


08-12 11:14:10  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:14:10  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:14:10  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:14:12  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3989186
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3989186
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439370850
    [ops] => 2bb717c5d41dc3ea041cbaf42e401036
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:14:12  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3989186
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439370850
)
 scopes = profile openid email

08-12 11:14:12  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:14:12  DEBUG id_token claims = Array
(
)


08-12 11:14:12  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:14:12  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:14:12  DEBUG ss = sha256(spardecohttps://localhost2bb717c5d41dc3ea041cbaf42e401036a22434f2303ae78a698fbb52adb0db90).a22434f2303ae78a698fbb52adb0db90

==============================================================================
08-12 11:14:12  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => VOpZwaEk_HsFpkfboBL6mGgd11BtpDogdiTJhw-pink
    [state] => 3989186
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=VOpZwaEk_HsFpkfboBL6mGgd11BtpDogdiTJhw-pink&state=3989186&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:14:12  DEBUG spardeco
client_secret_post

08-12 11:14:12  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:14:12  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:14:12  DEBUG requested idtoken claims = Array
(
)


08-12 11:14:12  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:14:12  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439371152
    [iat] => 1439370852
    [at_hash] => S3c24jFpym4n9U7g23Xc4w
)


08-12 11:14:12  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:14:12  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcxMTUyLCJpYXQiOjE0MzkzNzA4NTIsImF0X2hhc2giOiJTM2MyNGpGcHltNG45VTdnMjNYYzR3In0.EBnQFrYCVuorFSDgAUc0OM5_xw9VH-8Z58ad23tWluaMbOEKwQo8GAKtG51px1xnqdJO86UyPSWPwmLJrYzBVFp4A3yeICTUaYV7pvdGdrABEykrHXwHf1lyuNALDuh9n5lrNqUNk3YnQoZiLo2Q98oDcXTKSw-QkIRoL8LUTM3I2plpNUy2a1s7ZKiH86C50gEg2biiU9coTnpiJTNX_DeEZVJB_ZxTrn-WzftrggNWVdwDneGH0aUXFFO4LfOtXyMToC4ZijAW_F2Z8SkVgOu5NixdYC4VibefIi2nxgY62LhCUlOPDnV3lxRb8wMEy5GZAa7UornBK6q44AWJqA

08-12 11:14:12  DEBUG token response = Array
(
    [access_token] => 9oFnn9tkQLZVwJhhvipF2voEDLKm2Yhdz4DLlPsle7M
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcxMTUyLCJpYXQiOjE0MzkzNzA4NTIsImF0X2hhc2giOiJTM2MyNGpGcHltNG45VTdnMjNYYzR3In0.EBnQFrYCVuorFSDgAUc0OM5_xw9VH-8Z58ad23tWluaMbOEKwQo8GAKtG51px1xnqdJO86UyPSWPwmLJrYzBVFp4A3yeICTUaYV7pvdGdrABEykrHXwHf1lyuNALDuh9n5lrNqUNk3YnQoZiLo2Q98oDcXTKSw-QkIRoL8LUTM3I2plpNUy2a1s7ZKiH86C50gEg2biiU9coTnpiJTNX_DeEZVJB_ZxTrn-WzftrggNWVdwDneGH0aUXFFO4LfOtXyMToC4ZijAW_F2Z8SkVgOu5NixdYC4VibefIi2nxgY62LhCUlOPDnV3lxRb8wMEy5GZAa7UornBK6q44AWJqA
)


==============================================================================
08-12 11:14:12  DEBUG Request: Array
(
    [access_token] => 9oFnn9tkQLZVwJhhvipF2voEDLKm2Yhdz4DLlPsle7M
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=9oFnn9tkQLZVwJhhvipF2voEDLKm2Yhdz4DLlPsle7M","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:14:12  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:14:12  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:14:12  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:14:12  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3989186
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439370850
)
 scopes = profile openid email

08-12 11:14:12  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:14:12  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:14:12  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:14:12  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:14:12  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:19:19  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2117107
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2117107","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:19:19  DEBUG prompt = 

08-12 11:19:19  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:19:21  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2117107
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2117107
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2117107"} []
----------------------------------------------------------

08-12 11:19:21  DEBUG Auth_time = 1439371161

08-12 11:19:21  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:19:21  DEBUG prompt = 

08-12 11:19:21  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2117107
)
 scopes = profile openid email

08-12 11:19:21  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:19:21  DEBUG id_token claims = Array
(
)


08-12 11:19:21  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:19:21  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:19:21  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:19:22  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2117107
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2117107
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439371161
    [ops] => 18787f1a690c3252c722af1dee2cff15
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:19:22  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2117107
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371161
)
 scopes = profile openid email

08-12 11:19:22  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:19:22  DEBUG id_token claims = Array
(
)


08-12 11:19:22  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:19:22  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:19:22  DEBUG ss = sha256(spardecohttps://localhost18787f1a690c3252c722af1dee2cff159e6070f9253a66ca428da30cbcabe7dc).9e6070f9253a66ca428da30cbcabe7dc

==============================================================================
08-12 11:19:23  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 51XSQAmvdZN4XUr9hd8R3hB_3PR96wPf4qiovHLGXLA
    [state] => 2117107
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=51XSQAmvdZN4XUr9hd8R3hB_3PR96wPf4qiovHLGXLA&state=2117107&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:19:23  DEBUG spardeco
client_secret_post

08-12 11:19:23  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:19:23  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:19:23  DEBUG requested idtoken claims = Array
(
)


08-12 11:19:23  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:19:23  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439371463
    [iat] => 1439371163
    [at_hash] => k8bo-IJKVSLt3dB9gSlmVQ
)


08-12 11:19:23  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:19:23  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcxNDYzLCJpYXQiOjE0MzkzNzExNjMsImF0X2hhc2giOiJrOGJvLUlKS1ZTTHQzZEI5Z1NsbVZRIn0.q3lh4w--3FriS4jYmTHUS6fsTgUbbIYz5RBk28OJfjYCP50_zQ5nG8xnN09QLm-Ixie_G5cATLHqmzSWmUGm8Za3VadLnLkIwRZLMZNgrVP2A8EUcYzvc1XxQ7vMImM9T-8utqfwTgm1f634BcAG2Jx-2pHpifNI3ZTL0MPKzH5yoTegsQ2cvcGkaInCCWF2BdSFrURCZBcDAp0Cqo0dJIPC_ZQFbIokMkDbtcseFyw1IlG5uC-1mQjZpJDpptTvXCLkD2Xgy2NFzHsRcXjQIkRUFUA4_ZHmkNY_W1fHGeX4Aju_B6yvg2BahaI2lrwQRfeqS3ukomBMsXaHB9TI6g

08-12 11:19:23  DEBUG token response = Array
(
    [access_token] => BsPkPhqc2Q4hV5i0idFPPiJkLtyIuCLgpCmHFUJr_v4
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcxNDYzLCJpYXQiOjE0MzkzNzExNjMsImF0X2hhc2giOiJrOGJvLUlKS1ZTTHQzZEI5Z1NsbVZRIn0.q3lh4w--3FriS4jYmTHUS6fsTgUbbIYz5RBk28OJfjYCP50_zQ5nG8xnN09QLm-Ixie_G5cATLHqmzSWmUGm8Za3VadLnLkIwRZLMZNgrVP2A8EUcYzvc1XxQ7vMImM9T-8utqfwTgm1f634BcAG2Jx-2pHpifNI3ZTL0MPKzH5yoTegsQ2cvcGkaInCCWF2BdSFrURCZBcDAp0Cqo0dJIPC_ZQFbIokMkDbtcseFyw1IlG5uC-1mQjZpJDpptTvXCLkD2Xgy2NFzHsRcXjQIkRUFUA4_ZHmkNY_W1fHGeX4Aju_B6yvg2BahaI2lrwQRfeqS3ukomBMsXaHB9TI6g
)


==============================================================================
08-12 11:19:23  DEBUG Request: Array
(
    [access_token] => BsPkPhqc2Q4hV5i0idFPPiJkLtyIuCLgpCmHFUJr_v4
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=BsPkPhqc2Q4hV5i0idFPPiJkLtyIuCLgpCmHFUJr_v4","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:19:23  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:19:23  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:19:23  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:19:23  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2117107
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371161
)
 scopes = profile openid email

08-12 11:19:23  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:19:23  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:19:23  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:19:24  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:19:24  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:19:34  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2117107
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2117107","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:19:34  DEBUG prompt = 

08-12 11:19:34  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:26:32  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7274552
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2117107
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2117107
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7274552","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:26:32  DEBUG prompt = 

08-12 11:26:32  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:26:34  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7274552
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7274552
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7274552"} []
----------------------------------------------------------

08-12 11:26:34  DEBUG Auth_time = 1439371594

08-12 11:26:34  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:26:34  DEBUG prompt = 

08-12 11:26:34  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7274552
)
 scopes = profile openid email

08-12 11:26:34  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:26:34  DEBUG id_token claims = Array
(
)


08-12 11:26:34  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:26:34  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:26:34  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:26:37  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7274552
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7274552
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439371594
    [ops] => b26e65ee410b4237d843e0b24e5dc134
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:26:37  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7274552
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371594
)
 scopes = profile openid email

08-12 11:26:37  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:26:37  DEBUG id_token claims = Array
(
)


08-12 11:26:37  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:26:37  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:26:37  DEBUG ss = sha256(spardecohttps://localhostb26e65ee410b4237d843e0b24e5dc1344d34c64baf1fd67d2fd93dd97fb376be).4d34c64baf1fd67d2fd93dd97fb376be

==============================================================================
08-12 11:26:38  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => Q5A42n2l9UO6DW685GT9Hz7zCrj8WArKLNImMuHSnQs
    [state] => 7274552
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=Q5A42n2l9UO6DW685GT9Hz7zCrj8WArKLNImMuHSnQs&state=7274552&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:26:38  DEBUG spardeco
client_secret_post

08-12 11:26:38  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:26:38  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:26:38  DEBUG requested idtoken claims = Array
(
)


08-12 11:26:38  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:26:38  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439371898
    [iat] => 1439371598
    [at_hash] => Cv_qki-yMv4Bz6VBJ7qV3Q
)


08-12 11:26:38  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:26:38  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcxODk4LCJpYXQiOjE0MzkzNzE1OTgsImF0X2hhc2giOiJDdl9xa2kteU12NEJ6NlZCSjdxVjNRIn0.naqAxPZWUjXElBm3KCJ7RJMMKJzxwMTj7my7SnnsEyL1yQVbeqL-eYeNeEBZkshKOSnl6Cz2Nh0-8fooqbAm_hosln1TkMpb7sLlMazAPSuH3LbwSiY6xeNb_t0hUk2cBMR4s_LEW8PonrH152YkvErykZU5KaP1bMpgIPdxN1ciiVKOq11yyq8RsXSgvUSw4PXSj8s8bHIaDHpTbRNDrCCXegXglEhEyWziprfPMsYNKwIx4hFQyqaxZV_trM1eBhYQ0iqqr9skK1uMuwLz8ohd78y4nLUJs6AeMfuzlm_dGbGtd1gvLqqYo1CymfpKiut3r8UvPYsl6WctEN6BUw

08-12 11:26:38  DEBUG token response = Array
(
    [access_token] => tpziJ3JfdYvsItZtvzRsPZV6u5532DkmBxYl2QuDkzI
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcxODk4LCJpYXQiOjE0MzkzNzE1OTgsImF0X2hhc2giOiJDdl9xa2kteU12NEJ6NlZCSjdxVjNRIn0.naqAxPZWUjXElBm3KCJ7RJMMKJzxwMTj7my7SnnsEyL1yQVbeqL-eYeNeEBZkshKOSnl6Cz2Nh0-8fooqbAm_hosln1TkMpb7sLlMazAPSuH3LbwSiY6xeNb_t0hUk2cBMR4s_LEW8PonrH152YkvErykZU5KaP1bMpgIPdxN1ciiVKOq11yyq8RsXSgvUSw4PXSj8s8bHIaDHpTbRNDrCCXegXglEhEyWziprfPMsYNKwIx4hFQyqaxZV_trM1eBhYQ0iqqr9skK1uMuwLz8ohd78y4nLUJs6AeMfuzlm_dGbGtd1gvLqqYo1CymfpKiut3r8UvPYsl6WctEN6BUw
)


==============================================================================
08-12 11:26:38  DEBUG Request: Array
(
    [access_token] => tpziJ3JfdYvsItZtvzRsPZV6u5532DkmBxYl2QuDkzI
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=tpziJ3JfdYvsItZtvzRsPZV6u5532DkmBxYl2QuDkzI","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:26:38  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:26:38  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:26:38  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:26:38  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7274552
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371594
)
 scopes = profile openid email

08-12 11:26:38  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:26:38  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:26:38  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:26:38  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:26:38  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:27:36  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7569864
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7569864","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:27:36  DEBUG prompt = 

08-12 11:27:36  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:27:38  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7569864
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7569864
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7569864"} []
----------------------------------------------------------

08-12 11:27:38  DEBUG Auth_time = 1439371658

08-12 11:27:38  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:27:38  DEBUG prompt = 

08-12 11:27:38  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7569864
)
 scopes = profile openid email

08-12 11:27:38  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:27:38  DEBUG id_token claims = Array
(
)


08-12 11:27:38  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:27:38  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:27:38  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:27:39  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7569864
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7569864
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439371658
    [ops] => cda4f0ddcdf9cffb24aab898c5f7b22d
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:27:40  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7569864
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371658
)
 scopes = profile openid email

08-12 11:27:40  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:27:40  DEBUG id_token claims = Array
(
)


08-12 11:27:40  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:27:40  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:27:40  DEBUG ss = sha256(spardecohttps://localhostcda4f0ddcdf9cffb24aab898c5f7b22db5307a418565722d6737724529d6866d).b5307a418565722d6737724529d6866d

==============================================================================
08-12 11:27:40  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => jG0ekF_BhbSnJ3TFwJT2ACziyuPMDmPT_nZytpbP3WY
    [state] => 7569864
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=jG0ekF_BhbSnJ3TFwJT2ACziyuPMDmPT_nZytpbP3WY&state=7569864&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:27:40  DEBUG spardeco
client_secret_post

08-12 11:27:40  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:27:40  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:27:40  DEBUG requested idtoken claims = Array
(
)


08-12 11:27:40  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:27:40  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439371960
    [iat] => 1439371660
    [at_hash] => 8fsLBCIsa8hjLv4eB8RfoA
)


08-12 11:27:40  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:27:40  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcxOTYwLCJpYXQiOjE0MzkzNzE2NjAsImF0X2hhc2giOiI4ZnNMQkNJc2E4aGpMdjRlQjhSZm9BIn0.RZIqYPkaai6I0rgNiS6dl-eKCDH12h7to7RUzJteeSAxjHXs8s8r8VAAURgkzvkBIqrBuNH2bpedOOEkWU5W-l-6zibCls0xC_GiBZODypd62h6-p2XHYTOJ3F2UGQbmrLwc3iPJoKdSXn4SSb91WMMdqq1nY-F0LinNMonnVUiwsPFqojRyxqMCqj0eJGwQKBRtdSuusAsyK_Iu_KNTX8ijTUlM2D-X4un-AHMXEqHvOgeCAm9dLiG78glQEncypGa9_Ve2qggJLx_ALASokC0YQicDJvks5xZwQcDDhNxIwRcWRqvCi5Umwi_QNE-ePCCw7DC29pD8fynZXbadPw

08-12 11:27:40  DEBUG token response = Array
(
    [access_token] => d9hbsM5xw4wEv1f2H0kEzkOCiDJaviR4nQ1WNbW7E2s
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcxOTYwLCJpYXQiOjE0MzkzNzE2NjAsImF0X2hhc2giOiI4ZnNMQkNJc2E4aGpMdjRlQjhSZm9BIn0.RZIqYPkaai6I0rgNiS6dl-eKCDH12h7to7RUzJteeSAxjHXs8s8r8VAAURgkzvkBIqrBuNH2bpedOOEkWU5W-l-6zibCls0xC_GiBZODypd62h6-p2XHYTOJ3F2UGQbmrLwc3iPJoKdSXn4SSb91WMMdqq1nY-F0LinNMonnVUiwsPFqojRyxqMCqj0eJGwQKBRtdSuusAsyK_Iu_KNTX8ijTUlM2D-X4un-AHMXEqHvOgeCAm9dLiG78glQEncypGa9_Ve2qggJLx_ALASokC0YQicDJvks5xZwQcDDhNxIwRcWRqvCi5Umwi_QNE-ePCCw7DC29pD8fynZXbadPw
)


==============================================================================
08-12 11:27:40  DEBUG Request: Array
(
    [access_token] => d9hbsM5xw4wEv1f2H0kEzkOCiDJaviR4nQ1WNbW7E2s
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=d9hbsM5xw4wEv1f2H0kEzkOCiDJaviR4nQ1WNbW7E2s","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:27:40  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:27:40  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:27:40  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:27:40  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7569864
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371658
)
 scopes = profile openid email

08-12 11:27:40  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:27:40  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:27:40  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:27:40  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:27:40  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:29:09  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7569864
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7569864","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:29:09  DEBUG prompt = 

08-12 11:29:09  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:29:11  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5461232
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7569864
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7569864
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5461232","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:29:11  DEBUG prompt = 

08-12 11:29:11  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:29:13  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5461232
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5461232
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5461232"} []
----------------------------------------------------------

08-12 11:29:13  DEBUG Auth_time = 1439371753

08-12 11:29:13  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:29:13  DEBUG prompt = 

08-12 11:29:13  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5461232
)
 scopes = profile openid email

08-12 11:29:13  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:29:13  DEBUG id_token claims = Array
(
)


08-12 11:29:13  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:29:13  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:29:13  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:29:15  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5461232
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5461232
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439371753
    [ops] => 9f3823edb9c03e8a22dc9caf5672bd28
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:29:15  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5461232
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371753
)
 scopes = profile openid email

08-12 11:29:15  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:29:15  DEBUG id_token claims = Array
(
)


08-12 11:29:15  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:29:15  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:29:15  DEBUG ss = sha256(spardecohttps://localhost9f3823edb9c03e8a22dc9caf5672bd28463791e6ce0bcafe28b99314ceb09b22).463791e6ce0bcafe28b99314ceb09b22

==============================================================================
08-12 11:29:15  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => j8Np9Ht0gLUoXc_6JhIFeoKkgHbyRCvvcqzQeorJu7Q
    [state] => 5461232
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=j8Np9Ht0gLUoXc_6JhIFeoKkgHbyRCvvcqzQeorJu7Q&state=5461232&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:29:15  DEBUG spardeco
client_secret_post

08-12 11:29:15  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:29:15  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:29:15  DEBUG requested idtoken claims = Array
(
)


08-12 11:29:15  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:29:15  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439372055
    [iat] => 1439371755
    [at_hash] => N_-CmxQAdFHsLd2RrlBMrw
)


08-12 11:29:15  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:29:15  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMDU1LCJpYXQiOjE0MzkzNzE3NTUsImF0X2hhc2giOiJOXy1DbXhRQWRGSHNMZDJScmxCTXJ3In0.Vfglmy6eGV3uwJguRiPRg6rCQ7ONSVng8jaJNUlqIO_abLMRJYvbd8Y00X8VSovfE1rSAIivz7BUJUJNJAqqdINZ-pkQpiPgfFrB8TDZvQuvyapZIWazaudbX1dqCYPd976fBN7V87n1cUeubCBmXuxxYAINrV9hodAQQjgJEReljsaAMhE1RjeMicxKPtJvKpvNqib4lfkvbhTzOWcL2AH3xsRhHsZWzaPTPCJvABh0JFHRemN90OZdTM_1n6OLAzoQe7CHGZIzZjzwCO-PKRbt3Qs6_vGm3ERQlSox0Ob9LJX-7yA_Cm7cpYucQ71DAgk_nez4_EJITJy4cDrSrg

08-12 11:29:15  DEBUG token response = Array
(
    [access_token] => EDhtpthULjE73wR8pHrcgi1IfB4C4rx5IzG2qposaEY
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMDU1LCJpYXQiOjE0MzkzNzE3NTUsImF0X2hhc2giOiJOXy1DbXhRQWRGSHNMZDJScmxCTXJ3In0.Vfglmy6eGV3uwJguRiPRg6rCQ7ONSVng8jaJNUlqIO_abLMRJYvbd8Y00X8VSovfE1rSAIivz7BUJUJNJAqqdINZ-pkQpiPgfFrB8TDZvQuvyapZIWazaudbX1dqCYPd976fBN7V87n1cUeubCBmXuxxYAINrV9hodAQQjgJEReljsaAMhE1RjeMicxKPtJvKpvNqib4lfkvbhTzOWcL2AH3xsRhHsZWzaPTPCJvABh0JFHRemN90OZdTM_1n6OLAzoQe7CHGZIzZjzwCO-PKRbt3Qs6_vGm3ERQlSox0Ob9LJX-7yA_Cm7cpYucQ71DAgk_nez4_EJITJy4cDrSrg
)


==============================================================================
08-12 11:29:16  DEBUG Request: Array
(
    [access_token] => EDhtpthULjE73wR8pHrcgi1IfB4C4rx5IzG2qposaEY
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=EDhtpthULjE73wR8pHrcgi1IfB4C4rx5IzG2qposaEY","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:29:16  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:29:16  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:29:16  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:29:16  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5461232
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371753
)
 scopes = profile openid email

08-12 11:29:16  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:29:16  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:29:16  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:29:16  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:29:16  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:30:57  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5461232
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5461232","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:30:57  DEBUG prompt = 

08-12 11:30:57  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:30:59  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2434655
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5461232
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5461232
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2434655","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:30:59  DEBUG prompt = 

08-12 11:30:59  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:31:00  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2434655
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2434655
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2434655"} []
----------------------------------------------------------

08-12 11:31:00  DEBUG Auth_time = 1439371860

08-12 11:31:00  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:31:00  DEBUG prompt = 

08-12 11:31:00  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2434655
)
 scopes = profile openid email

08-12 11:31:00  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:31:00  DEBUG id_token claims = Array
(
)


08-12 11:31:00  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:31:00  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:31:00  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:31:02  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2434655
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2434655
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439371860
    [ops] => 094649c5fc992bc17d49aa1998b063e5
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:31:02  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2434655
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371860
)
 scopes = profile openid email

08-12 11:31:02  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:31:02  DEBUG id_token claims = Array
(
)


08-12 11:31:02  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:31:02  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:31:02  DEBUG ss = sha256(spardecohttps://localhost094649c5fc992bc17d49aa1998b063e51630e88361c3a1d3e1f6b2113d164764).1630e88361c3a1d3e1f6b2113d164764

==============================================================================
08-12 11:31:02  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => F_0d0HFk8K0RxiKaxWsIm0OldebHxuT3WpRAjY4qD5I
    [state] => 2434655
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=F_0d0HFk8K0RxiKaxWsIm0OldebHxuT3WpRAjY4qD5I&state=2434655&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:31:02  DEBUG spardeco
client_secret_post

08-12 11:31:02  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:31:02  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:31:02  DEBUG requested idtoken claims = Array
(
)


08-12 11:31:02  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:31:02  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439372162
    [iat] => 1439371862
    [at_hash] => KGFss4zeb5mt8DeUrGB4sQ
)


08-12 11:31:02  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:31:02  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMTYyLCJpYXQiOjE0MzkzNzE4NjIsImF0X2hhc2giOiJLR0ZzczR6ZWI1bXQ4RGVVckdCNHNRIn0.ObLvR2m1VheJq9_q6AiL_dUmJjylXXexC-BmzoNAHgHU_rkRWhJQfB2-qYcHpXe3mEK8aV79CPwZOuF4MdJ3tTqkLptUIg8pFmutkBNPiyCDWtEEwhZyq5p1BUPSMZw405IC725B_jGWi2sN0CDdEh6ENGFt03YsDVNkz0EtL9MWpMPmst1UaQA9wcXvcE0giTr8TUUXQ7It6ZaDIs4vB1Dz6M37W_BU6WYm1n4uzb91yyfw1NOGo_v3-kGsRSVxw3wEXdaiwFmbWYhRIAHHDveqM0o_Gfq3LY0t8rk5TCmsTwXtK5N1ZGv_hPr-dgyT8s38fSJvjHKpSeWpOItfBw

08-12 11:31:02  DEBUG token response = Array
(
    [access_token] => _bXSIwk-0Cmnuq5LByru7ywegj0mv8o-j4_8c6vSWsM
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMTYyLCJpYXQiOjE0MzkzNzE4NjIsImF0X2hhc2giOiJLR0ZzczR6ZWI1bXQ4RGVVckdCNHNRIn0.ObLvR2m1VheJq9_q6AiL_dUmJjylXXexC-BmzoNAHgHU_rkRWhJQfB2-qYcHpXe3mEK8aV79CPwZOuF4MdJ3tTqkLptUIg8pFmutkBNPiyCDWtEEwhZyq5p1BUPSMZw405IC725B_jGWi2sN0CDdEh6ENGFt03YsDVNkz0EtL9MWpMPmst1UaQA9wcXvcE0giTr8TUUXQ7It6ZaDIs4vB1Dz6M37W_BU6WYm1n4uzb91yyfw1NOGo_v3-kGsRSVxw3wEXdaiwFmbWYhRIAHHDveqM0o_Gfq3LY0t8rk5TCmsTwXtK5N1ZGv_hPr-dgyT8s38fSJvjHKpSeWpOItfBw
)


==============================================================================
08-12 11:31:03  DEBUG Request: Array
(
    [access_token] => _bXSIwk-0Cmnuq5LByru7ywegj0mv8o-j4_8c6vSWsM
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=_bXSIwk-0Cmnuq5LByru7ywegj0mv8o-j4_8c6vSWsM","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:31:03  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:31:03  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:31:03  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:31:03  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2434655
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371860
)
 scopes = profile openid email

08-12 11:31:03  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:31:03  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:31:03  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:31:03  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:31:03  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:31:26  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2434655
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2434655","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:31:26  DEBUG prompt = 

08-12 11:31:26  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:31:27  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2434655
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2434655
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7314389","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:31:27  DEBUG prompt = 

08-12 11:31:27  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:31:29  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7314389"} []
----------------------------------------------------------

08-12 11:31:29  DEBUG Auth_time = 1439371889

08-12 11:31:29  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:31:29  DEBUG prompt = 

08-12 11:31:29  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
)
 scopes = profile openid email

08-12 11:31:29  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:31:29  DEBUG id_token claims = Array
(
)


08-12 11:31:29  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:31:29  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:31:29  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:31:31  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439371889
    [ops] => 93bc81fa91acbf8d41adca7a9a76ec2f
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:31:31  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371889
)
 scopes = profile openid email

08-12 11:31:31  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:31:31  DEBUG id_token claims = Array
(
)


08-12 11:31:31  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:31:31  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:31:31  DEBUG ss = sha256(spardecohttps://localhost93bc81fa91acbf8d41adca7a9a76ec2fa1f8b2e1ce63f27663f4dc2237cfad3f).a1f8b2e1ce63f27663f4dc2237cfad3f

==============================================================================
08-12 11:31:31  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => Tfww2C7sbWJHrA_e1OiTIfwj23DnschMkeXtMtWO7tw
    [state] => 7314389
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=Tfww2C7sbWJHrA_e1OiTIfwj23DnschMkeXtMtWO7tw&state=7314389&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:31:31  DEBUG spardeco
client_secret_post

08-12 11:31:31  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:31:31  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:31:31  DEBUG requested idtoken claims = Array
(
)


08-12 11:31:31  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:31:31  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439372191
    [iat] => 1439371891
    [at_hash] => rIpOMR3mJNFkdlkgWHIjpg
)


08-12 11:31:31  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:31:31  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMTkxLCJpYXQiOjE0MzkzNzE4OTEsImF0X2hhc2giOiJySXBPTVIzbUpORmtkbGtnV0hJanBnIn0.iGo_kNjrIATh6LybZkwl4fA9B1_zc_O4uPUvgcQygbk1FPjOW5g-5Kxrjj-nc7LVi__BNK3ohTjU3Uxaeb162jdfffmPUX_fRsnwJssZGRhXvGCcy4rhXLN_igPT8oCK5ypFKOg-CjK7_E74B76VWV-sHRpZb83mtjvxO9YwnlkOqN8KAtksrrlDZXqVvZTUX5uuin4iBM9T69-VyMPrMHfL2BFvwBKdLtky5LYmIbLBswavrmm5n8c_c10WyiVbp6OvrvLNYQWx9hfZUytFhL31ri9snLZkqB5AkMED_KanvPEzzelkTpE2UY6kBllFEdLRRjFeHvvsYMWW2YgfeA

08-12 11:31:31  DEBUG token response = Array
(
    [access_token] => i1d_IAHyXLjVXxnAdemNSR2KhNThBpR3ni2WCOSTazM
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMTkxLCJpYXQiOjE0MzkzNzE4OTEsImF0X2hhc2giOiJySXBPTVIzbUpORmtkbGtnV0hJanBnIn0.iGo_kNjrIATh6LybZkwl4fA9B1_zc_O4uPUvgcQygbk1FPjOW5g-5Kxrjj-nc7LVi__BNK3ohTjU3Uxaeb162jdfffmPUX_fRsnwJssZGRhXvGCcy4rhXLN_igPT8oCK5ypFKOg-CjK7_E74B76VWV-sHRpZb83mtjvxO9YwnlkOqN8KAtksrrlDZXqVvZTUX5uuin4iBM9T69-VyMPrMHfL2BFvwBKdLtky5LYmIbLBswavrmm5n8c_c10WyiVbp6OvrvLNYQWx9hfZUytFhL31ri9snLZkqB5AkMED_KanvPEzzelkTpE2UY6kBllFEdLRRjFeHvvsYMWW2YgfeA
)


==============================================================================
08-12 11:31:32  DEBUG Request: Array
(
    [access_token] => i1d_IAHyXLjVXxnAdemNSR2KhNThBpR3ni2WCOSTazM
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=i1d_IAHyXLjVXxnAdemNSR2KhNThBpR3ni2WCOSTazM","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:31:32  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:31:32  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:31:32  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:31:32  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371889
)
 scopes = profile openid email

08-12 11:31:32  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:31:32  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:31:32  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:31:32  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:31:32  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:32:25  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7314389","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:32:25  DEBUG prompt = 

08-12 11:32:25  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:32:27  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7314389"} []
----------------------------------------------------------

08-12 11:32:27  DEBUG Auth_time = 1439371947

08-12 11:32:27  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:32:27  DEBUG prompt = 

08-12 11:32:27  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
)
 scopes = profile openid email

08-12 11:32:27  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:32:27  DEBUG id_token claims = Array
(
)


08-12 11:32:27  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:32:27  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:32:27  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:32:28  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439371947
    [ops] => 92c5795657047c69d0e87e2feb24051d
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:32:28  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371947
)
 scopes = profile openid email

08-12 11:32:28  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:32:28  DEBUG id_token claims = Array
(
)


08-12 11:32:28  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:32:28  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:32:28  DEBUG ss = sha256(spardecohttps://localhost92c5795657047c69d0e87e2feb24051daf8bbb89fa287827b6817d1f2c7732eb).af8bbb89fa287827b6817d1f2c7732eb

==============================================================================
08-12 11:32:29  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => v6iphABQfavvEjHrzP0O_x6qemgwxYC3QtTl3DJFmIA
    [state] => 7314389
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=v6iphABQfavvEjHrzP0O_x6qemgwxYC3QtTl3DJFmIA&state=7314389&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:32:29  DEBUG spardeco
client_secret_post

08-12 11:32:29  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:32:29  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:32:29  DEBUG requested idtoken claims = Array
(
)


08-12 11:32:29  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:32:29  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439372249
    [iat] => 1439371949
    [at_hash] => ZQGsyELEpr8S4Q-lNEFuXQ
)


08-12 11:32:29  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:32:29  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMjQ5LCJpYXQiOjE0MzkzNzE5NDksImF0X2hhc2giOiJaUUdzeUVMRXByOFM0US1sTkVGdVhRIn0.HqJtA96-KJhgVcJhWqLItCA6SkJ4D0g2pekU0Ej6kBDqUAcrF4eYpw4z5XjxD24mXq9ErX7ykTAiNS6OegV29vMAQejSkJep5KkAEivO2YOTfnHLdvNG6bDbPFUYcJmWbltrIHwvt-x0Iz-Z7Xja6wIfX83MpxgYXv0V2hVAyCoFdWYtXW6OhdGjAsMIj8FnelWjaWgWAqwtH7gjCf4fKOLF-PoSMbFQrrdBVXXwloh0foaFruxxpXZ_NmQAgZX5f1263D_VgSaifP31MGVME_6zypZIBMLkrgUZpd625WE3cxBFJrc-99Osx1gm49-YCNVM9VlV_vo0sgqigC-EDQ

08-12 11:32:29  DEBUG token response = Array
(
    [access_token] => 12Ys3bHGcv92E-yu00SnwtR4IloX5zsaopq6ljnd1ZU
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMjQ5LCJpYXQiOjE0MzkzNzE5NDksImF0X2hhc2giOiJaUUdzeUVMRXByOFM0US1sTkVGdVhRIn0.HqJtA96-KJhgVcJhWqLItCA6SkJ4D0g2pekU0Ej6kBDqUAcrF4eYpw4z5XjxD24mXq9ErX7ykTAiNS6OegV29vMAQejSkJep5KkAEivO2YOTfnHLdvNG6bDbPFUYcJmWbltrIHwvt-x0Iz-Z7Xja6wIfX83MpxgYXv0V2hVAyCoFdWYtXW6OhdGjAsMIj8FnelWjaWgWAqwtH7gjCf4fKOLF-PoSMbFQrrdBVXXwloh0foaFruxxpXZ_NmQAgZX5f1263D_VgSaifP31MGVME_6zypZIBMLkrgUZpd625WE3cxBFJrc-99Osx1gm49-YCNVM9VlV_vo0sgqigC-EDQ
)


==============================================================================
08-12 11:32:29  DEBUG Request: Array
(
    [access_token] => 12Ys3bHGcv92E-yu00SnwtR4IloX5zsaopq6ljnd1ZU
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=12Ys3bHGcv92E-yu00SnwtR4IloX5zsaopq6ljnd1ZU","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:32:29  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:32:29  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:32:29  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:32:29  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371947
)
 scopes = profile openid email

08-12 11:32:29  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:32:29  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:32:29  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:32:29  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:32:29  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:33:08  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7314389","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:33:08  DEBUG prompt = 

08-12 11:33:08  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:33:09  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7314389"} []
----------------------------------------------------------

08-12 11:33:09  DEBUG Auth_time = 1439371989

08-12 11:33:09  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:33:09  DEBUG prompt = 

08-12 11:33:09  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
)
 scopes = profile openid email

08-12 11:33:09  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:33:09  DEBUG id_token claims = Array
(
)


08-12 11:33:09  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:33:09  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:33:09  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:33:10  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439371989
    [ops] => 604b9e027657d4a277d8045b813ff8cd
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:33:11  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371989
)
 scopes = profile openid email

08-12 11:33:11  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:33:11  DEBUG id_token claims = Array
(
)


08-12 11:33:11  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:33:11  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:33:11  DEBUG ss = sha256(spardecohttps://localhost604b9e027657d4a277d8045b813ff8cd81bf1575a5c64923f94fb9c676e68421).81bf1575a5c64923f94fb9c676e68421

==============================================================================
08-12 11:33:11  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => yZ06wIupAEPO4lmKsaNWj94QM9dQiPqlFGNzm0Gnj_4
    [state] => 7314389
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=yZ06wIupAEPO4lmKsaNWj94QM9dQiPqlFGNzm0Gnj_4&state=7314389&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:33:11  DEBUG spardeco
client_secret_post

08-12 11:33:11  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:33:11  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:33:11  DEBUG requested idtoken claims = Array
(
)


08-12 11:33:11  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:33:11  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439372291
    [iat] => 1439371991
    [at_hash] => oOroQplY6U0-EXaT9NiDxg
)


08-12 11:33:11  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:33:11  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMjkxLCJpYXQiOjE0MzkzNzE5OTEsImF0X2hhc2giOiJvT3JvUXBsWTZVMC1FWGFUOU5pRHhnIn0.PlUjhzBJQYW7ajFgjBap0EtzHwfLN5V_jQu0LG4EryYlI6ak4NwlZ6fMV5hGdrZFtkC9TEvCxEXT9cAVnxDEFIgzfX_F8fupxgJ9VQH0K-WC7B5F0bK2N5y32qHFW5PxTgIbsbl_C9JjVA_FGWXyGGxx9xjFlCmmvHv-D-oXKdYwhLHlS1IBa6ki1Zy1Vl0XHz-n-TJzFaQLdzk7xVwQ9to1yXnOKQv_A3L9nX13HaNu4Ow-cxViO6mkgtiTOSTfZwM7qFvPiuiKl756aT1rJVgYJ3HycKzNl8dkQG1xRy9BexVX8aV-NF1PUkqp-O8b1RovSbib0V_wEbm5Uqn3kg

08-12 11:33:11  DEBUG token response = Array
(
    [access_token] => DbSUEDdGJOvGxukBPTWhhZhxByMINfS_CaFd8W51BTg
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMjkxLCJpYXQiOjE0MzkzNzE5OTEsImF0X2hhc2giOiJvT3JvUXBsWTZVMC1FWGFUOU5pRHhnIn0.PlUjhzBJQYW7ajFgjBap0EtzHwfLN5V_jQu0LG4EryYlI6ak4NwlZ6fMV5hGdrZFtkC9TEvCxEXT9cAVnxDEFIgzfX_F8fupxgJ9VQH0K-WC7B5F0bK2N5y32qHFW5PxTgIbsbl_C9JjVA_FGWXyGGxx9xjFlCmmvHv-D-oXKdYwhLHlS1IBa6ki1Zy1Vl0XHz-n-TJzFaQLdzk7xVwQ9to1yXnOKQv_A3L9nX13HaNu4Ow-cxViO6mkgtiTOSTfZwM7qFvPiuiKl756aT1rJVgYJ3HycKzNl8dkQG1xRy9BexVX8aV-NF1PUkqp-O8b1RovSbib0V_wEbm5Uqn3kg
)


==============================================================================
08-12 11:33:11  DEBUG Request: Array
(
    [access_token] => DbSUEDdGJOvGxukBPTWhhZhxByMINfS_CaFd8W51BTg
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=DbSUEDdGJOvGxukBPTWhhZhxByMINfS_CaFd8W51BTg","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:33:11  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:33:11  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:33:11  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:33:11  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439371989
)
 scopes = profile openid email

08-12 11:33:11  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:33:11  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:33:11  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:33:11  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:33:11  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:33:29  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7314389","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:33:29  DEBUG prompt = 

08-12 11:33:29  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:33:30  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7314389"} []
----------------------------------------------------------

08-12 11:33:31  DEBUG Auth_time = 1439372011

08-12 11:33:31  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:33:31  DEBUG prompt = 

08-12 11:33:31  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
)
 scopes = profile openid email

08-12 11:33:31  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:33:31  DEBUG id_token claims = Array
(
)


08-12 11:33:31  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:33:31  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:33:31  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:33:32  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439372011
    [ops] => 75a8a635077fccad4cd335ed4c154eb0
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:33:32  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372011
)
 scopes = profile openid email

08-12 11:33:32  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:33:32  DEBUG id_token claims = Array
(
)


08-12 11:33:32  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:33:32  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:33:32  DEBUG ss = sha256(spardecohttps://localhost75a8a635077fccad4cd335ed4c154eb08e00a5710bb2df4d8046b3a91ca47e91).8e00a5710bb2df4d8046b3a91ca47e91

==============================================================================
08-12 11:33:32  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => voHbY_2n26n4fLW6jG75s7LCjbqrtm-jopAavHTqBaY
    [state] => 7314389
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=voHbY_2n26n4fLW6jG75s7LCjbqrtm-jopAavHTqBaY&state=7314389&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:33:32  DEBUG spardeco
client_secret_post

08-12 11:33:32  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:33:33  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:33:33  DEBUG requested idtoken claims = Array
(
)


08-12 11:33:33  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:33:33  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439372313
    [iat] => 1439372013
    [at_hash] => _CwQa_oieBr-StfTGWce4Q
)


08-12 11:33:33  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:33:33  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMzEzLCJpYXQiOjE0MzkzNzIwMTMsImF0X2hhc2giOiJfQ3dRYV9vaWVCci1TdGZUR1djZTRRIn0.CFHWswLtbWQqD-8Vo0FqU2kLsECSrhruwGjP2dwKkvNVCTzG4py_yhb4IFPKdTAmx3Xn9s2qSGTy4jPTOE5WP4UF7iy02K59iTk8vWiiOSEJEkobCtqaK-UX_kY3djVykNyc-gnNC2Q_yw9k7IRkW0mIdHwHWP7b_efyyyM_W1thT9TFoJYA53JTkz2ZJLEPMHqsu67F8bzSbFcsHyaALvXoeWtgMP43pPoAsOfVp27VMuCrseGmY0LhH7MW3PyfoZFBVGLS6Yni6Xyjz-u161BG24me6JA0qMxawwnGk90-Q78EwJbSbxTcRVaKe9vm44WXAgBO1MmZjc-638rjpQ

08-12 11:33:33  DEBUG token response = Array
(
    [access_token] => ii6G4HSCW_r8J5g6I9Gk8jgNKQzHuyuherUOOftsScQ
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMzEzLCJpYXQiOjE0MzkzNzIwMTMsImF0X2hhc2giOiJfQ3dRYV9vaWVCci1TdGZUR1djZTRRIn0.CFHWswLtbWQqD-8Vo0FqU2kLsECSrhruwGjP2dwKkvNVCTzG4py_yhb4IFPKdTAmx3Xn9s2qSGTy4jPTOE5WP4UF7iy02K59iTk8vWiiOSEJEkobCtqaK-UX_kY3djVykNyc-gnNC2Q_yw9k7IRkW0mIdHwHWP7b_efyyyM_W1thT9TFoJYA53JTkz2ZJLEPMHqsu67F8bzSbFcsHyaALvXoeWtgMP43pPoAsOfVp27VMuCrseGmY0LhH7MW3PyfoZFBVGLS6Yni6Xyjz-u161BG24me6JA0qMxawwnGk90-Q78EwJbSbxTcRVaKe9vm44WXAgBO1MmZjc-638rjpQ
)


==============================================================================
08-12 11:33:33  DEBUG Request: Array
(
    [access_token] => ii6G4HSCW_r8J5g6I9Gk8jgNKQzHuyuherUOOftsScQ
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=ii6G4HSCW_r8J5g6I9Gk8jgNKQzHuyuherUOOftsScQ","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:33:33  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:33:33  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:33:33  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:33:33  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372011
)
 scopes = profile openid email

08-12 11:33:33  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:33:33  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:33:33  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:33:33  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:33:33  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:33:53  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7314389","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:33:53  DEBUG prompt = 

08-12 11:33:53  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:33:55  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7314389"} []
----------------------------------------------------------

08-12 11:33:55  DEBUG Auth_time = 1439372035

08-12 11:33:55  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:33:55  DEBUG prompt = 

08-12 11:33:55  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
)
 scopes = profile openid email

08-12 11:33:55  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:33:55  DEBUG id_token claims = Array
(
)


08-12 11:33:55  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:33:55  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:33:55  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:33:57  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439372035
    [ops] => b13eb889dc2572a1cc88ce6f57d6e120
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:33:57  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372035
)
 scopes = profile openid email

08-12 11:33:57  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:33:57  DEBUG id_token claims = Array
(
)


08-12 11:33:57  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:33:57  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:33:57  DEBUG ss = sha256(spardecohttps://localhostb13eb889dc2572a1cc88ce6f57d6e12077c6fb4636a318d9ceb9bd64127b2b92).77c6fb4636a318d9ceb9bd64127b2b92

==============================================================================
08-12 11:33:57  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => Dc8k1BW4N2QNfI0yJrU0608N4cuo1YA_-c6ssdOR6Ts
    [state] => 7314389
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=Dc8k1BW4N2QNfI0yJrU0608N4cuo1YA_-c6ssdOR6Ts&state=7314389&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:33:57  DEBUG spardeco
client_secret_post

08-12 11:33:57  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:33:57  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:33:57  DEBUG requested idtoken claims = Array
(
)


08-12 11:33:57  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:33:57  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439372337
    [iat] => 1439372037
    [at_hash] => LAPTQur-c5KVF6admXeq2g
)


08-12 11:33:57  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:33:57  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMzM3LCJpYXQiOjE0MzkzNzIwMzcsImF0X2hhc2giOiJMQVBUUXVyLWM1S1ZGNmFkbVhlcTJnIn0.FB0KBrl-NuJU0lRC4Oh9h-KzOHcraD9Yu6V88fyf0735rhcy8z6T9TZ_jl5PiMl8nhX9PIYl8vd8XmEdQomkq8h9S0lcHgRBjuqgnZea4ckz5vqJyJEBP73cZnm3EQa8Wnewg21bzUHGVB5DBZg8LXvYli8f5ko4PYBclZtx-PMu8F-i--mHVx9e0Ix-qIBPEvYd-gCRyrAFQoa80jbTxp2n-srPd2bkYlOjGqce0Mgfpj4b8k1ArA8G9tDB6jw1uTO9qb6devF26xfjRQZn-ounMF_DqIIGrIHsb6MZ632jx9HQvArqC9f6k8XXAf1d_W0W1vaYYBECKYFkPf7ERw

08-12 11:33:57  DEBUG token response = Array
(
    [access_token] => 4E1ghMCGpFxp_-DVz5Jtm8axXXedm4ENmHUyIOB0_PM
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyMzM3LCJpYXQiOjE0MzkzNzIwMzcsImF0X2hhc2giOiJMQVBUUXVyLWM1S1ZGNmFkbVhlcTJnIn0.FB0KBrl-NuJU0lRC4Oh9h-KzOHcraD9Yu6V88fyf0735rhcy8z6T9TZ_jl5PiMl8nhX9PIYl8vd8XmEdQomkq8h9S0lcHgRBjuqgnZea4ckz5vqJyJEBP73cZnm3EQa8Wnewg21bzUHGVB5DBZg8LXvYli8f5ko4PYBclZtx-PMu8F-i--mHVx9e0Ix-qIBPEvYd-gCRyrAFQoa80jbTxp2n-srPd2bkYlOjGqce0Mgfpj4b8k1ArA8G9tDB6jw1uTO9qb6devF26xfjRQZn-ounMF_DqIIGrIHsb6MZ632jx9HQvArqC9f6k8XXAf1d_W0W1vaYYBECKYFkPf7ERw
)


==============================================================================
08-12 11:33:58  DEBUG Request: Array
(
    [access_token] => 4E1ghMCGpFxp_-DVz5Jtm8axXXedm4ENmHUyIOB0_PM
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=4E1ghMCGpFxp_-DVz5Jtm8axXXedm4ENmHUyIOB0_PM","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:33:58  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:33:58  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:33:58  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:33:58  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372035
)
 scopes = profile openid email

08-12 11:33:58  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:33:58  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:33:58  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:33:58  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:33:58  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:35:37  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7314389","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:35:37  DEBUG prompt = 

08-12 11:35:37  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:35:39  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7314389"} []
----------------------------------------------------------

08-12 11:35:39  DEBUG Auth_time = 1439372139

08-12 11:35:39  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:35:39  DEBUG prompt = 

08-12 11:35:39  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
)
 scopes = profile openid email

08-12 11:35:39  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:35:39  DEBUG id_token claims = Array
(
)


08-12 11:35:39  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:35:39  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:35:39  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:35:40  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7314389
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439372139
    [ops] => 95caff1c4ebe06dbaafa3365e18a1ae6
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:35:40  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372139
)
 scopes = profile openid email

08-12 11:35:40  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:35:40  DEBUG id_token claims = Array
(
)


08-12 11:35:40  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:35:40  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:35:41  DEBUG ss = sha256(spardecohttps://localhost95caff1c4ebe06dbaafa3365e18a1ae6ec4b7d5942351d00ca4e36b0c11c4035).ec4b7d5942351d00ca4e36b0c11c4035

==============================================================================
08-12 11:35:41  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => s0HFuJRvQ_ichglA9i6qeAqjMDiw6gwUgoXUv4ferYI
    [state] => 7314389
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=s0HFuJRvQ_ichglA9i6qeAqjMDiw6gwUgoXUv4ferYI&state=7314389&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:35:41  DEBUG spardeco
client_secret_post

08-12 11:35:41  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:35:41  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:35:41  DEBUG requested idtoken claims = Array
(
)


08-12 11:35:41  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:35:41  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439372441
    [iat] => 1439372141
    [at_hash] => gdk_TMbKjp-6fFdEvZYhpg
)


08-12 11:35:41  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:35:41  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyNDQxLCJpYXQiOjE0MzkzNzIxNDEsImF0X2hhc2giOiJnZGtfVE1iS2pwLTZmRmRFdlpZaHBnIn0.aDzpeXSCYdgypUoNsxFNjouFK5jyLIt0kZZJSoUj2NiqrtLCoqYD92hCg3tnoKCL8lrZX5mM6mtzUa2Q2UyjmQOnn9iLnPHGoZ42_vWDuf9dke922CDwHnr9RTAt4PYdrWR0Ffo0PwMurd8JfW1OP6sK-MWLexz-0AwzjcLsqBzNYWU7ey6_nLpbB3gkz90mSRuTtPPtq-b9DIjxot8UFriwbdoQV9CwNm_DCq9hV6yyowp762hT5zVyIhmfX4iENJihtoMjfRcX4kKHUpz584kHI5TtdpA34OXiKw63Od3EB_0JozmibXLlXsFlIiWbYWz_-6CPUTEO5ilRNzjEyw

08-12 11:35:41  DEBUG token response = Array
(
    [access_token] => Aeay80FIEGxr-PDCN6UvOlh3IiRYpeEaqC7aQde90DY
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyNDQxLCJpYXQiOjE0MzkzNzIxNDEsImF0X2hhc2giOiJnZGtfVE1iS2pwLTZmRmRFdlpZaHBnIn0.aDzpeXSCYdgypUoNsxFNjouFK5jyLIt0kZZJSoUj2NiqrtLCoqYD92hCg3tnoKCL8lrZX5mM6mtzUa2Q2UyjmQOnn9iLnPHGoZ42_vWDuf9dke922CDwHnr9RTAt4PYdrWR0Ffo0PwMurd8JfW1OP6sK-MWLexz-0AwzjcLsqBzNYWU7ey6_nLpbB3gkz90mSRuTtPPtq-b9DIjxot8UFriwbdoQV9CwNm_DCq9hV6yyowp762hT5zVyIhmfX4iENJihtoMjfRcX4kKHUpz584kHI5TtdpA34OXiKw63Od3EB_0JozmibXLlXsFlIiWbYWz_-6CPUTEO5ilRNzjEyw
)


==============================================================================
08-12 11:35:41  DEBUG Request: Array
(
    [access_token] => Aeay80FIEGxr-PDCN6UvOlh3IiRYpeEaqC7aQde90DY
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=Aeay80FIEGxr-PDCN6UvOlh3IiRYpeEaqC7aQde90DY","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:35:41  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:35:41  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:35:41  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:35:41  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7314389
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372139
)
 scopes = profile openid email

08-12 11:35:41  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:35:41  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:35:41  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:35:41  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:35:41  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:39:14  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6261954
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6261954","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:39:14  DEBUG prompt = 

08-12 11:39:14  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:39:16  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6261954
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6261954
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6261954"} []
----------------------------------------------------------

08-12 11:39:16  DEBUG Auth_time = 1439372356

08-12 11:39:16  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:39:16  DEBUG prompt = 

08-12 11:39:16  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6261954
)
 scopes = profile openid email

08-12 11:39:16  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:39:16  DEBUG id_token claims = Array
(
)


08-12 11:39:16  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:39:16  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:39:16  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:39:17  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6261954
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6261954
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439372356
    [ops] => 55bb225f53afa6d2de9b65fc8097fbde
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:39:17  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6261954
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372356
)
 scopes = profile openid email

08-12 11:39:17  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:39:17  DEBUG id_token claims = Array
(
)


08-12 11:39:17  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:39:17  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:39:17  DEBUG ss = sha256(spardecohttps://localhost55bb225f53afa6d2de9b65fc8097fbde7876d24d4c8435f01ea4793a86237c0d).7876d24d4c8435f01ea4793a86237c0d

==============================================================================
08-12 11:39:17  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => DqWI1qhY4Oj1ss3ABHfOCstOa_1xTBKsiuyCMmN-8BM
    [state] => 6261954
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=DqWI1qhY4Oj1ss3ABHfOCstOa_1xTBKsiuyCMmN-8BM&state=6261954&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:39:17  DEBUG spardeco
client_secret_post

08-12 11:39:17  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:39:17  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:39:17  DEBUG requested idtoken claims = Array
(
)


08-12 11:39:17  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:39:17  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439372657
    [iat] => 1439372357
    [at_hash] => PZCc6vwCqPm2DnVPUYyl8g
)


08-12 11:39:17  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:39:17  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyNjU3LCJpYXQiOjE0MzkzNzIzNTcsImF0X2hhc2giOiJQWkNjNnZ3Q3FQbTJEblZQVVl5bDhnIn0.hxfg0QKzHq-VrrBL4OSKvye1VKeNg4LmqRoy1lxHVRVRGUZ6QBlR4UZn3yenztZ4r19-zPFn253kSJCGhH9mQ0FpUZTq0VIb_ug3H7wKMwoLHVaaw2RCxFfnk2bXz9eUT9BzMctsRoRYkmIAvRcQwnwxJ5AeUTG6CtXnh2Ss7HSQbxBGh4k8Hn3lZBSvRSdau0TuOqGhnvWhqqKBvNFoJKzgaoJpw496hOJeOBHM8gf4ij3rBcqtquQ1o35LNYJzxXjLvH8-c8IMS6GMMYEYmvGfH52zF9Bgp76NgRTogTAGK-8hpQgIRXIlktTnh5LvavQVWKnDDKdlMB81otNOLg

08-12 11:39:17  DEBUG token response = Array
(
    [access_token] => tFr8BEHWO0Cvh45yA-BmI7eagOEABO3gLaDp3Z3tOQg
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyNjU3LCJpYXQiOjE0MzkzNzIzNTcsImF0X2hhc2giOiJQWkNjNnZ3Q3FQbTJEblZQVVl5bDhnIn0.hxfg0QKzHq-VrrBL4OSKvye1VKeNg4LmqRoy1lxHVRVRGUZ6QBlR4UZn3yenztZ4r19-zPFn253kSJCGhH9mQ0FpUZTq0VIb_ug3H7wKMwoLHVaaw2RCxFfnk2bXz9eUT9BzMctsRoRYkmIAvRcQwnwxJ5AeUTG6CtXnh2Ss7HSQbxBGh4k8Hn3lZBSvRSdau0TuOqGhnvWhqqKBvNFoJKzgaoJpw496hOJeOBHM8gf4ij3rBcqtquQ1o35LNYJzxXjLvH8-c8IMS6GMMYEYmvGfH52zF9Bgp76NgRTogTAGK-8hpQgIRXIlktTnh5LvavQVWKnDDKdlMB81otNOLg
)


==============================================================================
08-12 11:39:18  DEBUG Request: Array
(
    [access_token] => tFr8BEHWO0Cvh45yA-BmI7eagOEABO3gLaDp3Z3tOQg
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=tFr8BEHWO0Cvh45yA-BmI7eagOEABO3gLaDp3Z3tOQg","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:39:18  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:39:18  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:39:18  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:39:18  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6261954
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372356
)
 scopes = profile openid email

08-12 11:39:18  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:39:18  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:39:18  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:39:18  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:39:18  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:39:58  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6466101
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6466101","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:39:58  DEBUG prompt = 

08-12 11:39:58  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:40:00  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6466101
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6466101
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6466101"} []
----------------------------------------------------------

08-12 11:40:00  DEBUG Auth_time = 1439372400

08-12 11:40:00  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:40:00  DEBUG prompt = 

08-12 11:40:00  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6466101
)
 scopes = profile openid email

08-12 11:40:00  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:40:00  DEBUG id_token claims = Array
(
)


08-12 11:40:00  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:40:00  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:40:00  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:40:01  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6466101
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6466101
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439372400
    [ops] => 3c9b60717a2ad0d0e88f46f0d8384ecd
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:40:01  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6466101
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372400
)
 scopes = profile openid email

08-12 11:40:01  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:40:01  DEBUG id_token claims = Array
(
)


08-12 11:40:01  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:40:01  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:40:01  DEBUG ss = sha256(spardecohttps://localhost3c9b60717a2ad0d0e88f46f0d8384ecd1d96c4d30aacf628a163e7a55a058fd7).1d96c4d30aacf628a163e7a55a058fd7

==============================================================================
08-12 11:40:02  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 9yl6J0zxIg3ae1g0E8Lu6Jkh9VkbJelkElO-HLSXVYE
    [state] => 6466101
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=9yl6J0zxIg3ae1g0E8Lu6Jkh9VkbJelkElO-HLSXVYE&state=6466101&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:40:02  DEBUG spardeco
client_secret_post

08-12 11:40:02  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:40:02  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:40:02  DEBUG requested idtoken claims = Array
(
)


08-12 11:40:02  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:40:02  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439372702
    [iat] => 1439372402
    [at_hash] => LFbJvHrxNGmD3qIihuxkYg
)


08-12 11:40:02  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:40:02  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyNzAyLCJpYXQiOjE0MzkzNzI0MDIsImF0X2hhc2giOiJMRmJKdkhyeE5HbUQzcUlpaHV4a1lnIn0.QPmpI0Iko7pZ_fzu2xIVS5WGgFurgKZpyHacaffxjbVuMWqKpq5XB_N3OL6zEDi6-X70lje-_zh32vOB0EZwNlloeHi00rGUfCwWUM_wr6A7f3HTY6j5eclcOLnq9H1197xyTpLXzxm00xmAPka3ZQhWKD4W0KrdELrd4xyQDE2Zcrie1p5hWRbtGgUy8JtG76vcZ99vcyQauV24OFFWdrI-ppOHH902xBvWN0p2_BCxoZV2M-bWhbCALASwJNVpVk-iNCPCBjd4le8z1gqQTzTLe_vbG2Y9sgYVbxgfAhZc86QxMbb-1ulYqR4lsYbOMrT8IV3D5CMLb-hL08lO5Q

08-12 11:40:02  DEBUG token response = Array
(
    [access_token] => D-bsqPf2UOk6aeHn8A6G2OkOUOcFOaHpj8iliRn_a5o
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyNzAyLCJpYXQiOjE0MzkzNzI0MDIsImF0X2hhc2giOiJMRmJKdkhyeE5HbUQzcUlpaHV4a1lnIn0.QPmpI0Iko7pZ_fzu2xIVS5WGgFurgKZpyHacaffxjbVuMWqKpq5XB_N3OL6zEDi6-X70lje-_zh32vOB0EZwNlloeHi00rGUfCwWUM_wr6A7f3HTY6j5eclcOLnq9H1197xyTpLXzxm00xmAPka3ZQhWKD4W0KrdELrd4xyQDE2Zcrie1p5hWRbtGgUy8JtG76vcZ99vcyQauV24OFFWdrI-ppOHH902xBvWN0p2_BCxoZV2M-bWhbCALASwJNVpVk-iNCPCBjd4le8z1gqQTzTLe_vbG2Y9sgYVbxgfAhZc86QxMbb-1ulYqR4lsYbOMrT8IV3D5CMLb-hL08lO5Q
)


==============================================================================
08-12 11:40:02  DEBUG Request: Array
(
    [access_token] => D-bsqPf2UOk6aeHn8A6G2OkOUOcFOaHpj8iliRn_a5o
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=D-bsqPf2UOk6aeHn8A6G2OkOUOcFOaHpj8iliRn_a5o","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:40:02  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:40:02  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:40:02  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:40:02  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6466101
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372400
)
 scopes = profile openid email

08-12 11:40:02  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:40:02  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:40:02  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:40:02  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:40:02  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:41:37  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6466101
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6466101","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:41:37  DEBUG prompt = 

08-12 11:41:37  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:41:39  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6466101
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6466101
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6466101"} []
----------------------------------------------------------

08-12 11:41:39  DEBUG Auth_time = 1439372499

08-12 11:41:39  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:41:39  DEBUG prompt = 

08-12 11:41:39  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6466101
)
 scopes = profile openid email

08-12 11:41:39  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:41:39  DEBUG id_token claims = Array
(
)


08-12 11:41:39  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:41:39  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:41:39  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:41:40  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6466101
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6466101
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439372499
    [ops] => 9131c63fa167ee111ba4d08740b72e5b
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:41:40  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6466101
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372499
)
 scopes = profile openid email

08-12 11:41:40  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:41:40  DEBUG id_token claims = Array
(
)


08-12 11:41:40  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:41:40  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:41:40  DEBUG ss = sha256(spardecohttps://localhost9131c63fa167ee111ba4d08740b72e5b06c8afa973a8619334f9b9a52a14c99f).06c8afa973a8619334f9b9a52a14c99f

==============================================================================
08-12 11:41:40  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => SXMOHd7Jw1WietO5sGO5S6m1rJxK66E-zeS-ZFMR2JU
    [state] => 6466101
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=SXMOHd7Jw1WietO5sGO5S6m1rJxK66E-zeS-ZFMR2JU&state=6466101&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:41:41  DEBUG spardeco
client_secret_post

08-12 11:41:41  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:41:41  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:41:41  DEBUG requested idtoken claims = Array
(
)


08-12 11:41:41  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:41:41  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439372801
    [iat] => 1439372501
    [at_hash] => vCobh2-UKa6OskCe0_CqNQ
)


08-12 11:41:41  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:41:41  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyODAxLCJpYXQiOjE0MzkzNzI1MDEsImF0X2hhc2giOiJ2Q29iaDItVUthNk9za0NlMF9DcU5RIn0.iWseWiZXmd4QBkFVRUOqaTq5X-EQKHft3Jd22OiHN-RsaCHw3xxZewLnXInvPBusJn72ImyBr-qDMfTDsBkKD9EmCZS4jX00inKy-xNHHvWLpHzfdYya2W8jWdEvd1Yx-heELZUNCZeUFlcQYE0i4mLwJbGJQVS71f7_NgFj043QE0we2Y_d6TprmHQoXM7-EtQekXT17q3t68SNjTNU9AaeBFdAeS5jSlGqTG7vfz1eiRR9HSzr2HWVlmGxz-_CrHD6F3FUu0f2IAcGWthBmLfEt25kzu8hLs0CMlEPvSu1Pz8cn-5SiFjRrLPHiDQx-yo68nZ9NBmRkGmLCOHjKw

08-12 11:41:41  DEBUG token response = Array
(
    [access_token] => VLmcGIhVPNMcgtCRpItEw6ZGdxa2S9XEkUgsgojxMFs
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzcyODAxLCJpYXQiOjE0MzkzNzI1MDEsImF0X2hhc2giOiJ2Q29iaDItVUthNk9za0NlMF9DcU5RIn0.iWseWiZXmd4QBkFVRUOqaTq5X-EQKHft3Jd22OiHN-RsaCHw3xxZewLnXInvPBusJn72ImyBr-qDMfTDsBkKD9EmCZS4jX00inKy-xNHHvWLpHzfdYya2W8jWdEvd1Yx-heELZUNCZeUFlcQYE0i4mLwJbGJQVS71f7_NgFj043QE0we2Y_d6TprmHQoXM7-EtQekXT17q3t68SNjTNU9AaeBFdAeS5jSlGqTG7vfz1eiRR9HSzr2HWVlmGxz-_CrHD6F3FUu0f2IAcGWthBmLfEt25kzu8hLs0CMlEPvSu1Pz8cn-5SiFjRrLPHiDQx-yo68nZ9NBmRkGmLCOHjKw
)


==============================================================================
08-12 11:41:41  DEBUG Request: Array
(
    [access_token] => VLmcGIhVPNMcgtCRpItEw6ZGdxa2S9XEkUgsgojxMFs
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=VLmcGIhVPNMcgtCRpItEw6ZGdxa2S9XEkUgsgojxMFs","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:41:41  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:41:41  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:41:41  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:41:41  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6466101
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372499
)
 scopes = profile openid email

08-12 11:41:41  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:41:41  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:41:41  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:41:41  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:41:41  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:44:59  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8428214
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8428214","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:44:59  DEBUG prompt = 

08-12 11:44:59  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:45:00  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8428214
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8428214
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8428214"} []
----------------------------------------------------------

08-12 11:45:00  DEBUG Auth_time = 1439372700

08-12 11:45:00  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:45:00  DEBUG prompt = 

08-12 11:45:00  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8428214
)
 scopes = profile openid email

08-12 11:45:00  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:45:00  DEBUG id_token claims = Array
(
)


08-12 11:45:00  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:45:00  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:45:00  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:45:02  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8428214
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8428214
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439372700
    [ops] => acb823cd141f99b9e7806d58479161d3
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:45:02  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8428214
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372700
)
 scopes = profile openid email

08-12 11:45:02  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:45:02  DEBUG id_token claims = Array
(
)


08-12 11:45:02  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:45:02  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:45:02  DEBUG ss = sha256(spardecohttps://localhostacb823cd141f99b9e7806d58479161d38ea4ed0bad3232b7eefa18eaa0a672e3).8ea4ed0bad3232b7eefa18eaa0a672e3

==============================================================================
08-12 11:45:02  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => Gj-1t4f5XeV1be5Ui6GLYqfdwxPnq6_Ebx-pSjIkdSo
    [state] => 8428214
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=Gj-1t4f5XeV1be5Ui6GLYqfdwxPnq6_Ebx-pSjIkdSo&state=8428214&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:45:02  DEBUG spardeco
client_secret_post

08-12 11:45:02  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:45:02  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:45:02  DEBUG requested idtoken claims = Array
(
)


08-12 11:45:02  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:45:02  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439373002
    [iat] => 1439372702
    [at_hash] => sn7ea2QElSk6s35hMAE8rA
)


08-12 11:45:02  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:45:02  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczMDAyLCJpYXQiOjE0MzkzNzI3MDIsImF0X2hhc2giOiJzbjdlYTJRRWxTazZzMzVoTUFFOHJBIn0.n5wt2iYQkKGeT7sTBowolBsh83I3YiDTPenZhXaEzRwaoMKzA-gsuf8XdMW8G_lcJU8JtGdbIYRwmUYLo0YIJBi6TFxFlcq168_NFw8P3xcEwhGucEDkCtd_EQbA29A5KX4L-bWjQERUcLv1JPGiyGbCbzbaziPhiGUmsIuc_NihCD0KXJJ6Ld4JFsfwGXw9L_FoEynJfjLsMlOJgCOsnQT1e44-9bm84Cu67KMrePHoxw8-YTkJhWDGefNBTReGMnHfEdU5vJMN-_lv7A0_eb3CreltBVHXZ6RLUcGaFdSp1KILk2GPB9UpqauTtZF0bz-94JmiMWoiaCc6ObaY_Q

08-12 11:45:02  DEBUG token response = Array
(
    [access_token] => QVtgELWOurdiaB35cfY_Y8wroTvJUS21LSnpKt57FG8
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczMDAyLCJpYXQiOjE0MzkzNzI3MDIsImF0X2hhc2giOiJzbjdlYTJRRWxTazZzMzVoTUFFOHJBIn0.n5wt2iYQkKGeT7sTBowolBsh83I3YiDTPenZhXaEzRwaoMKzA-gsuf8XdMW8G_lcJU8JtGdbIYRwmUYLo0YIJBi6TFxFlcq168_NFw8P3xcEwhGucEDkCtd_EQbA29A5KX4L-bWjQERUcLv1JPGiyGbCbzbaziPhiGUmsIuc_NihCD0KXJJ6Ld4JFsfwGXw9L_FoEynJfjLsMlOJgCOsnQT1e44-9bm84Cu67KMrePHoxw8-YTkJhWDGefNBTReGMnHfEdU5vJMN-_lv7A0_eb3CreltBVHXZ6RLUcGaFdSp1KILk2GPB9UpqauTtZF0bz-94JmiMWoiaCc6ObaY_Q
)


==============================================================================
08-12 11:45:03  DEBUG Request: Array
(
    [access_token] => QVtgELWOurdiaB35cfY_Y8wroTvJUS21LSnpKt57FG8
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=QVtgELWOurdiaB35cfY_Y8wroTvJUS21LSnpKt57FG8","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:45:03  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:45:03  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:45:03  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:45:03  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8428214
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372700
)
 scopes = profile openid email

08-12 11:45:03  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:45:03  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:45:03  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:45:03  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:45:03  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:45:29  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => Gj-1t4f5XeV1be5Ui6GLYqfdwxPnq6_Ebx-pSjIkdSo
    [state] => 8428214
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=Gj-1t4f5XeV1be5Ui6GLYqfdwxPnq6_Ebx-pSjIkdSo&state=8428214&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:45:29  ERROR url: error:invalid_grant desc:no such code uri: state: code:400

08-12 11:45:29  ERROR HTTP/1.0 400 Bad Request
{"error":"invalid_grant","error_description":"no such code"}

==============================================================================
08-12 11:45:33  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8428214
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8428214","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:45:33  DEBUG prompt = 

08-12 11:45:33  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:45:35  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 0907302
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8428214
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8428214
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=0907302","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:45:35  DEBUG prompt = 

08-12 11:45:35  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:45:36  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 0907302
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 0907302
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=0907302"} []
----------------------------------------------------------

08-12 11:45:37  DEBUG Auth_time = 1439372737

08-12 11:45:37  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:45:37  DEBUG prompt = 

08-12 11:45:37  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 0907302
)
 scopes = profile openid email

08-12 11:45:37  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:45:37  DEBUG id_token claims = Array
(
)


08-12 11:45:37  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:45:37  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:45:37  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:45:38  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 0907302
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 0907302
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439372737
    [ops] => 2435f6288ca44dd96b7aa0e3497482eb
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:45:38  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 0907302
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372737
)
 scopes = profile openid email

08-12 11:45:38  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:45:38  DEBUG id_token claims = Array
(
)


08-12 11:45:38  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:45:38  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:45:38  DEBUG ss = sha256(spardecohttps://localhost2435f6288ca44dd96b7aa0e3497482ebcbca65bf2f897ea943a281b4ab91a283).cbca65bf2f897ea943a281b4ab91a283

==============================================================================
08-12 11:45:38  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 4jsuhhHCRbJNTY0Omt7tlxFbSnlQhLV59P5GcugQdCA
    [state] => 0907302
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=4jsuhhHCRbJNTY0Omt7tlxFbSnlQhLV59P5GcugQdCA&state=0907302&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:45:38  DEBUG spardeco
client_secret_post

08-12 11:45:38  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:45:39  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:45:39  DEBUG requested idtoken claims = Array
(
)


08-12 11:45:39  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:45:39  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439373039
    [iat] => 1439372739
    [at_hash] => dFIacNpQjy1aoCdUD1Kl9w
)


08-12 11:45:39  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:45:39  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczMDM5LCJpYXQiOjE0MzkzNzI3MzksImF0X2hhc2giOiJkRklhY05wUWp5MWFvQ2RVRDFLbDl3In0.CX0oyFRbHX0l4A_M1AIFTJqiRj9RV4RGrYPLfRkiDt1_tEzV2x1AOxYBGllcf_wZBrn3u77lblWcaFd3EAtbKOxZ6hY9LM91ZFWmZrJcWzCyKKS3GgQ0bJFeDLCQPtQEt_rA0y7K_In6stUSmCTrYxMAmlE5YOm8Mzau7w_HLL-V5rhvxzhlmOlx253hoO0VD2rskPvGTmxbU3p2u4U0zgSIHPjJekwD3s5LQW4WoLMjVLWxoaL9PxB_dTRCOqjGL2-r6tdpr-JZQ5I4LJRYlNr2tdm4OYiZeIj07diH6py_KHFPRmpzmp7eKHjrdEHcwF4lrjTouH7kVQIDmiBWLA

08-12 11:45:39  DEBUG token response = Array
(
    [access_token] => jtAghkKhBcvqc07P3uE1QdDGgVBXR76OyeaWWP4ljVQ
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczMDM5LCJpYXQiOjE0MzkzNzI3MzksImF0X2hhc2giOiJkRklhY05wUWp5MWFvQ2RVRDFLbDl3In0.CX0oyFRbHX0l4A_M1AIFTJqiRj9RV4RGrYPLfRkiDt1_tEzV2x1AOxYBGllcf_wZBrn3u77lblWcaFd3EAtbKOxZ6hY9LM91ZFWmZrJcWzCyKKS3GgQ0bJFeDLCQPtQEt_rA0y7K_In6stUSmCTrYxMAmlE5YOm8Mzau7w_HLL-V5rhvxzhlmOlx253hoO0VD2rskPvGTmxbU3p2u4U0zgSIHPjJekwD3s5LQW4WoLMjVLWxoaL9PxB_dTRCOqjGL2-r6tdpr-JZQ5I4LJRYlNr2tdm4OYiZeIj07diH6py_KHFPRmpzmp7eKHjrdEHcwF4lrjTouH7kVQIDmiBWLA
)


==============================================================================
08-12 11:45:39  DEBUG Request: Array
(
    [access_token] => jtAghkKhBcvqc07P3uE1QdDGgVBXR76OyeaWWP4ljVQ
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=jtAghkKhBcvqc07P3uE1QdDGgVBXR76OyeaWWP4ljVQ","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:45:39  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:45:39  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:45:39  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:45:39  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 0907302
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372737
)
 scopes = profile openid email

08-12 11:45:39  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:45:39  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:45:39  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:45:39  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:45:39  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:47:05  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3961852
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3961852","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:47:05  DEBUG prompt = 

08-12 11:47:05  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:47:06  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3961852
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3961852
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3961852"} []
----------------------------------------------------------

08-12 11:47:06  DEBUG Auth_time = 1439372826

08-12 11:47:06  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:47:06  DEBUG prompt = 

08-12 11:47:06  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3961852
)
 scopes = profile openid email

08-12 11:47:06  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:47:06  DEBUG id_token claims = Array
(
)


08-12 11:47:06  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:47:06  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:47:06  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:47:08  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3961852
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3961852
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439372826
    [ops] => 2feb6bb3d21972c424e949d600beb786
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:47:08  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3961852
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372826
)
 scopes = profile openid email

08-12 11:47:08  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:47:08  DEBUG id_token claims = Array
(
)


08-12 11:47:08  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:47:08  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:47:08  DEBUG ss = sha256(spardecohttps://localhost2feb6bb3d21972c424e949d600beb7864849932f948a4be4c545fabbe1f9636f).4849932f948a4be4c545fabbe1f9636f

==============================================================================
08-12 11:47:08  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => bi6y5jw-Vqfk-JvAX8eULyVaZUWadvsTfUttCeE4Wio
    [state] => 3961852
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=bi6y5jw-Vqfk-JvAX8eULyVaZUWadvsTfUttCeE4Wio&state=3961852&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:47:08  DEBUG spardeco
client_secret_post

08-12 11:47:08  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:47:09  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:47:09  DEBUG requested idtoken claims = Array
(
)


08-12 11:47:09  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:47:09  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439373129
    [iat] => 1439372829
    [at_hash] => AAr56m4XfmzYIY2WU2fhUQ
)


08-12 11:47:09  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:47:09  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczMTI5LCJpYXQiOjE0MzkzNzI4MjksImF0X2hhc2giOiJBQXI1Nm00WGZtellJWTJXVTJmaFVRIn0.XSHmJLuIkm-mG_JCXkkLbDE4qkDhcKjPAyQQmJ-7qISDoQlyZAhUYgnCWIw8eWTHZvu1YapCbhXveUpHTNTLux2nEDsyCWjMRioLxkghLW47rtonTk9YUELH3KhRvJCWZB73DXmcD8-PN6pWcjVVgROzsoq7IKydtpD7CPovma9Q6gGFIdC9pyMRDMUYz2mi92CyCmrjVVBeCFQD5sxKlB3hYA41sTQlIv46AH7BVRrfcdRjFmGjHnAlXLI8_VYUgRoTVWQUQz3LkROZXq_cq7X0cqlrC35dHopcVqzCY005zb-ccRfxfcFTkHj_9kxn_wXEbuwj2BPe7yUh15t51A

08-12 11:47:09  DEBUG token response = Array
(
    [access_token] => Lp6ihEgbpT2g6r4Sxk-SrS_GfT8p1lDosiDyca86wY8
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczMTI5LCJpYXQiOjE0MzkzNzI4MjksImF0X2hhc2giOiJBQXI1Nm00WGZtellJWTJXVTJmaFVRIn0.XSHmJLuIkm-mG_JCXkkLbDE4qkDhcKjPAyQQmJ-7qISDoQlyZAhUYgnCWIw8eWTHZvu1YapCbhXveUpHTNTLux2nEDsyCWjMRioLxkghLW47rtonTk9YUELH3KhRvJCWZB73DXmcD8-PN6pWcjVVgROzsoq7IKydtpD7CPovma9Q6gGFIdC9pyMRDMUYz2mi92CyCmrjVVBeCFQD5sxKlB3hYA41sTQlIv46AH7BVRrfcdRjFmGjHnAlXLI8_VYUgRoTVWQUQz3LkROZXq_cq7X0cqlrC35dHopcVqzCY005zb-ccRfxfcFTkHj_9kxn_wXEbuwj2BPe7yUh15t51A
)


==============================================================================
08-12 11:47:09  DEBUG Request: Array
(
    [access_token] => Lp6ihEgbpT2g6r4Sxk-SrS_GfT8p1lDosiDyca86wY8
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=Lp6ihEgbpT2g6r4Sxk-SrS_GfT8p1lDosiDyca86wY8","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:47:09  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:47:09  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:47:09  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:47:09  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3961852
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372826
)
 scopes = profile openid email

08-12 11:47:09  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:47:09  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:47:09  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:47:09  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:47:09  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:47:34  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3961852
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3961852","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:47:34  DEBUG prompt = 

08-12 11:47:34  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:47:35  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3961852
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3961852
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3961852"} []
----------------------------------------------------------

08-12 11:47:35  DEBUG Auth_time = 1439372855

08-12 11:47:35  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:47:35  DEBUG prompt = 

08-12 11:47:35  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3961852
)
 scopes = profile openid email

08-12 11:47:35  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:47:35  DEBUG id_token claims = Array
(
)


08-12 11:47:35  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:47:35  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:47:35  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:47:36  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3961852
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3961852
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439372855
    [ops] => f91de1e457865a5e2a8420cc21d5aebf
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:47:36  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3961852
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372855
)
 scopes = profile openid email

08-12 11:47:36  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:47:36  DEBUG id_token claims = Array
(
)


08-12 11:47:36  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:47:36  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:47:36  DEBUG ss = sha256(spardecohttps://localhostf91de1e457865a5e2a8420cc21d5aebf3de546f693b058b5a5266b937cb220a8).3de546f693b058b5a5266b937cb220a8

==============================================================================
08-12 11:47:37  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 0ZVLHqjkh9vIfr9v1YLxv93CwphRx0PlKO3WTwqACBE
    [state] => 3961852
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=0ZVLHqjkh9vIfr9v1YLxv93CwphRx0PlKO3WTwqACBE&state=3961852&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:47:37  DEBUG spardeco
client_secret_post

08-12 11:47:37  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:47:37  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:47:37  DEBUG requested idtoken claims = Array
(
)


08-12 11:47:37  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:47:37  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439373157
    [iat] => 1439372857
    [at_hash] => -Xo-JsObLbZt29z284fl7Q
)


08-12 11:47:37  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:47:37  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczMTU3LCJpYXQiOjE0MzkzNzI4NTcsImF0X2hhc2giOiItWG8tSnNPYkxiWnQyOXoyODRmbDdRIn0.tC8PI3LCBmxDn2lii1f3DyU0AA2IdGOSKHpJFlntw8EsH83wS3EJ7gvgM_XhbgHkpBrV_uA38MJich8Pu2LtOJfkPR22kmtGyYLEU1FYnqYwpv5lM-LmjKpSaxchW6Lq42oLDJCx5W151a0zVd9VutG2cFMFlwSuKD-khv1VVRV2pGqFXMehJSbkmaQ9t2pWGBA9xgUQJC1nd2oBtw72mLqH-7_lq8EUm0t_7FqdpOl35MORR-IfwiWPTD8HRMp6USjStEOFIdvzrW1KfPBTEO8xF84su_AL7JLmvGgv6GbocDM5KTzcqnyCV6VJbE48yD3KHw1YXWjhZ_N-vTq5gg

08-12 11:47:37  DEBUG token response = Array
(
    [access_token] => jJtP8eMGuNKfmZt48wsFULUX5tYqfrFI94qHKqdHCSE
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczMTU3LCJpYXQiOjE0MzkzNzI4NTcsImF0X2hhc2giOiItWG8tSnNPYkxiWnQyOXoyODRmbDdRIn0.tC8PI3LCBmxDn2lii1f3DyU0AA2IdGOSKHpJFlntw8EsH83wS3EJ7gvgM_XhbgHkpBrV_uA38MJich8Pu2LtOJfkPR22kmtGyYLEU1FYnqYwpv5lM-LmjKpSaxchW6Lq42oLDJCx5W151a0zVd9VutG2cFMFlwSuKD-khv1VVRV2pGqFXMehJSbkmaQ9t2pWGBA9xgUQJC1nd2oBtw72mLqH-7_lq8EUm0t_7FqdpOl35MORR-IfwiWPTD8HRMp6USjStEOFIdvzrW1KfPBTEO8xF84su_AL7JLmvGgv6GbocDM5KTzcqnyCV6VJbE48yD3KHw1YXWjhZ_N-vTq5gg
)


==============================================================================
08-12 11:47:37  DEBUG Request: Array
(
    [access_token] => jJtP8eMGuNKfmZt48wsFULUX5tYqfrFI94qHKqdHCSE
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=jJtP8eMGuNKfmZt48wsFULUX5tYqfrFI94qHKqdHCSE","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:47:37  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:47:37  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:47:37  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:47:37  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3961852
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439372855
)
 scopes = profile openid email

08-12 11:47:37  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:47:37  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:47:37  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:47:37  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:47:37  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:51:21  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3917973
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3917973","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:51:21  DEBUG prompt = 

08-12 11:51:21  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:51:22  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3917973
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3917973
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3917973"} []
----------------------------------------------------------

08-12 11:51:22  DEBUG Auth_time = 1439373082

08-12 11:51:22  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:51:22  DEBUG prompt = 

08-12 11:51:22  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3917973
)
 scopes = profile openid email

08-12 11:51:22  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:51:22  DEBUG id_token claims = Array
(
)


08-12 11:51:22  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:51:22  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:51:22  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:51:24  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3917973
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3917973
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439373082
    [ops] => 1e5de6fe67854c8035c3ff544efbfec4
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:51:24  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3917973
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373082
)
 scopes = profile openid email

08-12 11:51:24  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:51:24  DEBUG id_token claims = Array
(
)


08-12 11:51:24  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:51:24  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:51:24  DEBUG ss = sha256(spardecohttps://localhost1e5de6fe67854c8035c3ff544efbfec4438ed3c697df028eb73e16497377bf3d).438ed3c697df028eb73e16497377bf3d

==============================================================================
08-12 11:51:24  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => GIfjOIut-yEXdFsarAYF7s_KgWsV-4bmTIQ2v_Ul9gc
    [state] => 3917973
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=GIfjOIut-yEXdFsarAYF7s_KgWsV-4bmTIQ2v_Ul9gc&state=3917973&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:51:24  DEBUG spardeco
client_secret_post

08-12 11:51:24  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:51:24  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:51:24  DEBUG requested idtoken claims = Array
(
)


08-12 11:51:24  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:51:24  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439373384
    [iat] => 1439373084
    [at_hash] => ysJGYNEeS2KLwx2QDN7nGg
)


08-12 11:51:24  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:51:24  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczMzg0LCJpYXQiOjE0MzkzNzMwODQsImF0X2hhc2giOiJ5c0pHWU5FZVMyS0x3eDJRRE43bkdnIn0.Ay3AAEDScQR-ciA65dGqtNIWDGAb6CSJUu2BRqwLXGz5xxmO_YUsGxDRDcZxL_95fa8JbRbzUmLZpbrT9SBl3W8XoOOF460Zcs0Oq5WwOVBDUSIXzkw3tfQoeiPI_PLsbPD_WQ2YrXIo8ny-iIp1IjxcDiUyJMMQdRNT1O2tKO-t_JndhAeevZFTV5BqoGtTUrPsVCZivmnmNniA_9ALEIsM9GltsHeRU2LyGJ5oAvfvUexO54rpTV_8YWTgjroPJqdJaBQXyDvfPonRukq7zTcl9x3a3zNYojt6bunSIx4vlLl-Crnuvi7TOKwRaMP8fet7-84fT3XgkE5OlJnBLg

08-12 11:51:24  DEBUG token response = Array
(
    [access_token] => I6hVos5hXTYI616Og1hghs6b2W5p9x6Hj6I4v5A9Q9I
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczMzg0LCJpYXQiOjE0MzkzNzMwODQsImF0X2hhc2giOiJ5c0pHWU5FZVMyS0x3eDJRRE43bkdnIn0.Ay3AAEDScQR-ciA65dGqtNIWDGAb6CSJUu2BRqwLXGz5xxmO_YUsGxDRDcZxL_95fa8JbRbzUmLZpbrT9SBl3W8XoOOF460Zcs0Oq5WwOVBDUSIXzkw3tfQoeiPI_PLsbPD_WQ2YrXIo8ny-iIp1IjxcDiUyJMMQdRNT1O2tKO-t_JndhAeevZFTV5BqoGtTUrPsVCZivmnmNniA_9ALEIsM9GltsHeRU2LyGJ5oAvfvUexO54rpTV_8YWTgjroPJqdJaBQXyDvfPonRukq7zTcl9x3a3zNYojt6bunSIx4vlLl-Crnuvi7TOKwRaMP8fet7-84fT3XgkE5OlJnBLg
)


==============================================================================
08-12 11:51:24  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:51:25  DEBUG get_userinfo_claims Array
(
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 
)
 scopes = 

08-12 11:51:25  DEBUG userinfo claims = Array
(
)


08-12 11:51:25  DEBUG id_token claims = Array
(
)


08-12 11:51:25  DEBUG unique keys = Array
(
)


08-12 11:51:25  DEBUG requested_claims = Array
(
)


08-12 11:51:25  DEBUG ss = sha256(://5190d4a4cbb9e781904e2e401ccc48d3).5190d4a4cbb9e781904e2e401ccc48d3

==============================================================================
08-12 11:51:25  DEBUG Request: Array
(
    [access_token] => I6hVos5hXTYI616Og1hghs6b2W5p9x6Hj6I4v5A9Q9I
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=I6hVos5hXTYI616Og1hghs6b2W5p9x6Hj6I4v5A9Q9I","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-12 11:51:25  DEBUG Request: Array
(
    [session_state] => f87022cfb899ecc2c922c08962bf1f67c8f9eda253982deca4bc3e1f15002178.5190d4a4cbb9e781904e2e401ccc48d3
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo?session_state=f87022cfb899ecc2c922c08962bf1f67c8f9eda253982deca4bc3e1f15002178.5190d4a4cbb9e781904e2e401ccc48d3","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:51:25  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:51:25  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:51:25  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:51:25  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3917973
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373082
)
 scopes = profile openid email

08-12 11:51:25  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:51:25  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:51:25  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:51:25  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:51:25  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

08-12 11:51:25  ERROR handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(1497): send_response(NULL, false)
#1 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(83): handle_confirm_userinfo()
#2 {main}

08-12 11:51:25  ERROR url:https://localhost/phpOp/index.php error:access_denied desc:User denied access uri: state: code:400

==============================================================================
08-12 11:51:32  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3917973
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3917973","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:51:32  DEBUG prompt = 

08-12 11:51:32  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:51:33  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3917973
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3917973
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3917973"} []
----------------------------------------------------------

08-12 11:51:33  DEBUG Auth_time = 1439373093

08-12 11:51:33  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:51:33  DEBUG prompt = 

08-12 11:51:33  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3917973
)
 scopes = profile openid email

08-12 11:51:33  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:51:33  DEBUG id_token claims = Array
(
)


08-12 11:51:33  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:51:33  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:51:33  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:51:34  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3917973
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3917973
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439373093
    [ops] => 19869f117eed01c0fed37966b5cdf6cb
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:51:35  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3917973
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373093
)
 scopes = profile openid email

08-12 11:51:35  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:51:35  DEBUG id_token claims = Array
(
)


08-12 11:51:35  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:51:35  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:51:35  DEBUG ss = sha256(spardecohttps://localhost19869f117eed01c0fed37966b5cdf6cb535ec0caf5a5c82d7903336962a042d8).535ec0caf5a5c82d7903336962a042d8

==============================================================================
08-12 11:51:35  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => Fb_pvwGvAuoUVqMH6wLcLxDWnL_yAZ78s8j2yUMeh_g
    [state] => 3917973
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=Fb_pvwGvAuoUVqMH6wLcLxDWnL_yAZ78s8j2yUMeh_g&state=3917973&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:51:35  DEBUG spardeco
client_secret_post

08-12 11:51:35  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:51:35  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:51:35  DEBUG requested idtoken claims = Array
(
)


08-12 11:51:35  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:51:35  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439373395
    [iat] => 1439373095
    [at_hash] => jAn8I9ckEKRbGBuYyuQS7Q
)


08-12 11:51:35  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:51:35  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczMzk1LCJpYXQiOjE0MzkzNzMwOTUsImF0X2hhc2giOiJqQW44STlja0VLUmJHQnVZeXVRUzdRIn0.N6-o0CaxXwp3cqPTuLAX48_wSSXR4cDaRbOng9RMfWvF3z4iLAC0-aLvpI66LnB5izw6u2xCqbeFoXuwSjZLM73ML0jizJgcLzFuA_FjWIowcXraW95FsdkL8lKKYSuE3zJzjU0xU0jYqqzQOWlwQGVQZSkLDoD8qV0Ua2zRDgcf4gOg6IbzXl1mcPd8pgxpQPeTqp5MnvwhIlBX5jZOZIreWONjiFjojA_qHBTcW56HWfQsA8-QbU9MRnQJ-yCCnjoNPQe2rtghacA7ouojhL0xPN3CL4XNS-3UxtDx2iQ6_ADhdR8fL9f7u4u8DFeQQOtFqMzS74n4FsGxp7aqKg

08-12 11:51:35  DEBUG token response = Array
(
    [access_token] => yZTrihu5OETnXPN7QeL3LCwN1EoYt8zDUa7h5NZZDQ8
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczMzk1LCJpYXQiOjE0MzkzNzMwOTUsImF0X2hhc2giOiJqQW44STlja0VLUmJHQnVZeXVRUzdRIn0.N6-o0CaxXwp3cqPTuLAX48_wSSXR4cDaRbOng9RMfWvF3z4iLAC0-aLvpI66LnB5izw6u2xCqbeFoXuwSjZLM73ML0jizJgcLzFuA_FjWIowcXraW95FsdkL8lKKYSuE3zJzjU0xU0jYqqzQOWlwQGVQZSkLDoD8qV0Ua2zRDgcf4gOg6IbzXl1mcPd8pgxpQPeTqp5MnvwhIlBX5jZOZIreWONjiFjojA_qHBTcW56HWfQsA8-QbU9MRnQJ-yCCnjoNPQe2rtghacA7ouojhL0xPN3CL4XNS-3UxtDx2iQ6_ADhdR8fL9f7u4u8DFeQQOtFqMzS74n4FsGxp7aqKg
)


==============================================================================
08-12 11:51:35  DEBUG Request: Array
(
    [access_token] => yZTrihu5OETnXPN7QeL3LCwN1EoYt8zDUa7h5NZZDQ8
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=yZTrihu5OETnXPN7QeL3LCwN1EoYt8zDUa7h5NZZDQ8","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:51:36  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:51:36  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:51:36  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:51:36  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3917973
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373093
)
 scopes = profile openid email

08-12 11:51:36  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:51:36  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:51:36  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:51:36  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:51:36  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:54:00  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3917973
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3917973","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:54:00  DEBUG prompt = 

08-12 11:54:00  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:54:02  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3917973
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3917973
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3917973"} []
----------------------------------------------------------

08-12 11:54:02  DEBUG Auth_time = 1439373242

08-12 11:54:02  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:54:02  DEBUG prompt = 

08-12 11:54:02  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3917973
)
 scopes = profile openid email

08-12 11:54:02  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:54:02  DEBUG id_token claims = Array
(
)


08-12 11:54:02  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:54:02  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:54:02  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:54:04  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3917973
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3917973
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439373242
    [ops] => ec42bf762fbd127650639c243ad351a6
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:54:04  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3917973
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373242
)
 scopes = profile openid email

08-12 11:54:04  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:54:04  DEBUG id_token claims = Array
(
)


08-12 11:54:04  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:54:04  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:54:04  DEBUG ss = sha256(spardecohttps://localhostec42bf762fbd127650639c243ad351a6356ef0511548e60f574bb7df2a714a37).356ef0511548e60f574bb7df2a714a37

==============================================================================
08-12 11:54:04  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => d9qzW9oDVXEArVSbIcObKAPL5X7wyILgn8KYvTKmPh0
    [state] => 3917973
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=d9qzW9oDVXEArVSbIcObKAPL5X7wyILgn8KYvTKmPh0&state=3917973&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:54:04  DEBUG spardeco
client_secret_post

08-12 11:54:04  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:54:04  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:54:04  DEBUG requested idtoken claims = Array
(
)


08-12 11:54:04  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:54:04  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439373544
    [iat] => 1439373244
    [at_hash] => Supj5V-NKi3NT_g_lPOWeA
)


08-12 11:54:04  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:54:04  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczNTQ0LCJpYXQiOjE0MzkzNzMyNDQsImF0X2hhc2giOiJTdXBqNVYtTktpM05UX2dfbFBPV2VBIn0.sNmEEwpGcKNESEzjDZW2qdhe5kd_23OB-iTJEikTXZDmMj6Azl3XUin3MMNWgDnpYUfCxAqZHW7m_tcd2l5eXxseYLFqHCfKbWLiDlfYwFso88eN_zxoKBkZlbBxZjK8RpykuvVcF5IzOMGWLNL37LZYSJcrM9Jt811AU2-GISGWN9nkrjzleVti2VCluD2hWinX4k5nvEoy5QybngYTRgD9V6MWOQYGPi2_9G_b4kBjgEcng4fNF8tZcdajWFNpBtS6-gLlo6hn9gzMt8Lx-AnjfJXowJjRjfFVwGIt_xJWLLmTOddyMTyePUvHZ00pxrdJJM95UgwnBY2DEZPLRQ

08-12 11:54:04  DEBUG token response = Array
(
    [access_token] => 1o3i0SZ1br0OI6MfDIFGs8FCs2WQBZeINAdf7DIT2RQ
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczNTQ0LCJpYXQiOjE0MzkzNzMyNDQsImF0X2hhc2giOiJTdXBqNVYtTktpM05UX2dfbFBPV2VBIn0.sNmEEwpGcKNESEzjDZW2qdhe5kd_23OB-iTJEikTXZDmMj6Azl3XUin3MMNWgDnpYUfCxAqZHW7m_tcd2l5eXxseYLFqHCfKbWLiDlfYwFso88eN_zxoKBkZlbBxZjK8RpykuvVcF5IzOMGWLNL37LZYSJcrM9Jt811AU2-GISGWN9nkrjzleVti2VCluD2hWinX4k5nvEoy5QybngYTRgD9V6MWOQYGPi2_9G_b4kBjgEcng4fNF8tZcdajWFNpBtS6-gLlo6hn9gzMt8Lx-AnjfJXowJjRjfFVwGIt_xJWLLmTOddyMTyePUvHZ00pxrdJJM95UgwnBY2DEZPLRQ
)


==============================================================================
08-12 11:54:05  DEBUG Request: Array
(
    [access_token] => 1o3i0SZ1br0OI6MfDIFGs8FCs2WQBZeINAdf7DIT2RQ
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=1o3i0SZ1br0OI6MfDIFGs8FCs2WQBZeINAdf7DIT2RQ","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:54:05  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:54:05  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:54:05  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:54:05  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3917973
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373242
)
 scopes = profile openid email

08-12 11:54:05  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:54:05  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:54:05  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:54:05  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:54:05  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:55:09  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4487278
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4487278","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:55:09  DEBUG prompt = 

08-12 11:55:09  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:55:11  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4487278
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4487278
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4487278"} []
----------------------------------------------------------

08-12 11:55:11  DEBUG Auth_time = 1439373311

08-12 11:55:11  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:55:11  DEBUG prompt = 

08-12 11:55:11  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4487278
)
 scopes = profile openid email

08-12 11:55:11  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:55:11  DEBUG id_token claims = Array
(
)


08-12 11:55:11  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:55:11  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:55:11  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:55:12  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4487278
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4487278
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439373311
    [ops] => d79473a12aeec24e3422e7c987394d7e
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:55:12  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4487278
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373311
)
 scopes = profile openid email

08-12 11:55:12  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:55:12  DEBUG id_token claims = Array
(
)


08-12 11:55:12  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:55:12  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:55:12  DEBUG ss = sha256(spardecohttps://localhostd79473a12aeec24e3422e7c987394d7e7314fad063cb0676fc365aa808d7d8a1).7314fad063cb0676fc365aa808d7d8a1

==============================================================================
08-12 11:55:13  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => I3tt0Qn3a-6pPWgCLEMLC4MEFQg7pwdfxpJzpDpEqvQ
    [state] => 4487278
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=I3tt0Qn3a-6pPWgCLEMLC4MEFQg7pwdfxpJzpDpEqvQ&state=4487278&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:55:13  DEBUG spardeco
client_secret_post

08-12 11:55:13  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:55:13  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:55:13  DEBUG requested idtoken claims = Array
(
)


08-12 11:55:13  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:55:13  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439373613
    [iat] => 1439373313
    [at_hash] => BNpVfZ85le9xohB6B6nVAQ
)


08-12 11:55:13  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:55:13  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczNjEzLCJpYXQiOjE0MzkzNzMzMTMsImF0X2hhc2giOiJCTnBWZlo4NWxlOXhvaEI2QjZuVkFRIn0.kIBKPuJgLT0ipKC6HoP6QGMOWuvXhpMAQ0E3dGkH4zSB-j1pXEJfPPawSkeytPHjNmMHBgih3DOAdyTF3nXyNB5afKGv-BcW7GVdxiMyq5oyhatnIH8kTGt_qbjppybyIn-MjDa5FPK8PbNk5kK6rWfKt4VWRgMhEDAgNrEV5WHMLdiEh_w1oCPNBbyoue6TcoC7MPw8xGIcqOo7wh4DXv-x8ZD6hAiwN5S8cq0ItDPgFZkxUfcp7uk2qgsyAZFtmWjKb_pe0b2qkPYGSjedg0ve53JkcIHMwndWreYX6EVED5h5SwsFnameBA8xd52JE0p8BsJLSf64jYkfi_1TYw

08-12 11:55:13  DEBUG token response = Array
(
    [access_token] => fwQV5kiQbG0tPVCq2RUf-HQpzXLrrMh5d4i_dvynCHw
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczNjEzLCJpYXQiOjE0MzkzNzMzMTMsImF0X2hhc2giOiJCTnBWZlo4NWxlOXhvaEI2QjZuVkFRIn0.kIBKPuJgLT0ipKC6HoP6QGMOWuvXhpMAQ0E3dGkH4zSB-j1pXEJfPPawSkeytPHjNmMHBgih3DOAdyTF3nXyNB5afKGv-BcW7GVdxiMyq5oyhatnIH8kTGt_qbjppybyIn-MjDa5FPK8PbNk5kK6rWfKt4VWRgMhEDAgNrEV5WHMLdiEh_w1oCPNBbyoue6TcoC7MPw8xGIcqOo7wh4DXv-x8ZD6hAiwN5S8cq0ItDPgFZkxUfcp7uk2qgsyAZFtmWjKb_pe0b2qkPYGSjedg0ve53JkcIHMwndWreYX6EVED5h5SwsFnameBA8xd52JE0p8BsJLSf64jYkfi_1TYw
)


==============================================================================
08-12 11:55:13  DEBUG Request: Array
(
    [access_token] => fwQV5kiQbG0tPVCq2RUf-HQpzXLrrMh5d4i_dvynCHw
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=fwQV5kiQbG0tPVCq2RUf-HQpzXLrrMh5d4i_dvynCHw","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:55:13  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 11:55:13  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 11:55:13  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 11:55:13  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4487278
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373311
)
 scopes = profile openid email

08-12 11:55:13  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:55:13  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:55:13  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:55:13  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 11:55:13  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 11:56:07  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4487278
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4487278","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 11:56:07  DEBUG prompt = 

08-12 11:56:07  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 11:56:14  DEBUG Request: Array
(
    [username] => simon
    [password] => toto
)

Input: username=simon&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4487278
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4487278
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4487278"} []
----------------------------------------------------------

08-12 11:56:14  DEBUG Auth_time = 1439373374

08-12 11:56:14  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 11:56:14  DEBUG prompt = 

08-12 11:56:14  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4487278
)
 scopes = profile openid email

08-12 11:56:14  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:56:14  DEBUG id_token claims = Array
(
)


08-12 11:56:14  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:56:14  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:56:14  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 11:56:17  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4487278
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4487278
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439373374
    [ops] => 4a688d19766d82b49f4f5e3a31d57be0
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 11:56:17  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4487278
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373374
)
 scopes = profile openid email

08-12 11:56:17  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:56:17  DEBUG id_token claims = Array
(
)


08-12 11:56:17  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 11:56:17  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:56:17  DEBUG ss = sha256(spardecohttps://localhost4a688d19766d82b49f4f5e3a31d57be0a920e90fa85d936a085c408cdd68b128).a920e90fa85d936a085c408cdd68b128

==============================================================================
08-12 11:56:17  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => JNx2SCOz1vEIccwRZeG4vbm_iA7JkBIBlOGw9bk1-8Y
    [state] => 4487278
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=JNx2SCOz1vEIccwRZeG4vbm_iA7JkBIBlOGw9bk1-8Y&state=4487278&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:56:17  DEBUG spardeco
client_secret_post

08-12 11:56:17  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 11:56:17  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 11:56:17  DEBUG requested idtoken claims = Array
(
)


08-12 11:56:17  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-12 11:56:17  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439373677
    [iat] => 1439373377
    [at_hash] => MOnshFC-06Zw0RYJ1aWthQ
)


08-12 11:56:17  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 11:56:17  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczNjc3LCJpYXQiOjE0MzkzNzMzNzcsImF0X2hhc2giOiJNT25zaEZDLTA2WncwUllKMWFXdGhRIn0.nL2A4Ccxmy7DKkaGXZFdI2w6A-eeZl_f5hZh1cvxP5Vi0njG8WS-NeE4A0XYIcCNcafgPtlgWvpcINWgAJeRaequYuRxp_eX-DQ62eaUAI6RvayY0USA_y2zy46ki09zoMmePnZJpb6GxJLUIHDjq465zEAfOB-kq95w33is_f2qjjCHZiPPiHype4hR_wyerZLYcMIm01OiILPFXemgujq4ZsoArj2gaQs6tPJC9JgA73yU7Qg1XNwv8yxci57MNH0HAkjTmnXSar_vqCjBRZXnj077au-CWePUoB_tCgiC5C4tJwBLV5o2c85KEIDy7X0FuKwXB97V2qTnRP4TTA

08-12 11:56:17  DEBUG token response = Array
(
    [access_token] => FpiVOJwu-v_ppqbF1-eaRZQ0btTCZGufjIbh0m_SDRc
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzczNjc3LCJpYXQiOjE0MzkzNzMzNzcsImF0X2hhc2giOiJNT25zaEZDLTA2WncwUllKMWFXdGhRIn0.nL2A4Ccxmy7DKkaGXZFdI2w6A-eeZl_f5hZh1cvxP5Vi0njG8WS-NeE4A0XYIcCNcafgPtlgWvpcINWgAJeRaequYuRxp_eX-DQ62eaUAI6RvayY0USA_y2zy46ki09zoMmePnZJpb6GxJLUIHDjq465zEAfOB-kq95w33is_f2qjjCHZiPPiHype4hR_wyerZLYcMIm01OiILPFXemgujq4ZsoArj2gaQs6tPJC9JgA73yU7Qg1XNwv8yxci57MNH0HAkjTmnXSar_vqCjBRZXnj077au-CWePUoB_tCgiC5C4tJwBLV5o2c85KEIDy7X0FuKwXB97V2qTnRP4TTA
)


==============================================================================
08-12 11:56:18  DEBUG Request: Array
(
    [access_token] => FpiVOJwu-v_ppqbF1-eaRZQ0btTCZGufjIbh0m_SDRc
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=FpiVOJwu-v_ppqbF1-eaRZQ0btTCZGufjIbh0m_SDRc","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 11:56:18  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-12 11:56:18  DEBUG wrapped |wFF#9yFk6Ca unwrapped = 1:simon

08-12 11:56:18  DEBUG userid = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8  unwrapped = simon

08-12 11:56:18  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4487278
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373374
)
 scopes = profile openid email

08-12 11:56:18  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:56:18  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 11:56:18  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 11:56:18  DEBUG returning = Array
(
    [birthdate] => 1898
    [email] => simon.becot@orange.com
    [email_verified] => 1
    [family_name] => Becot
    [gender] => male
    [given_name] => Simon
    [locale] => fr
    [middle_name] => 
    [name] => Simon Becot
    [nickname] => 
    [picture] => https://localhost/phpOp/profiles/pic.jpg
    [preferred_username] => 
    [profile] => http://profile/simon
    [updated_at] => 
    [website] => http://website
    [zoneinfo] => 
)


08-12 11:56:18  DEBUG userinfo response = {"sub":"c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8","birthdate":"1898","email":"simon.becot@orange.com","email_verified":true,"family_name":"Becot","gender":"male","given_name":"Simon","locale":"fr","middle_name":null,"name":"Simon Becot","nickname":null,"picture":"https:\/\/localhost\/phpOp\/profiles\/pic.jpg","preferred_username":null,"profile":"http:\/\/profile\/simon","updated_at":null,"website":"http:\/\/website","zoneinfo":null}

==============================================================================
08-12 12:03:38  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4487278
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4487278","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 12:03:39  DEBUG prompt = 

08-12 12:03:39  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 12:03:41  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5749261
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4487278
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4487278
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5749261","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 12:03:41  DEBUG prompt = 

08-12 12:03:41  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 12:03:48  DEBUG Request: Array
(
    [username] => simon
    [password] => toto
)

Input: username=simon&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5749261
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5749261
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5749261"} []
----------------------------------------------------------

08-12 12:03:48  DEBUG Auth_time = 1439373828

08-12 12:03:48  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 12:03:48  DEBUG prompt = 

08-12 12:03:48  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5749261
)
 scopes = profile openid email

08-12 12:03:48  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:03:48  DEBUG id_token claims = Array
(
)


08-12 12:03:48  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 12:03:48  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:03:48  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 12:03:50  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5749261
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5749261
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439373828
    [ops] => a4ae02a4c985070e26fef7fa0c493983
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 12:03:50  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5749261
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373828
)
 scopes = profile openid email

08-12 12:03:50  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:03:50  DEBUG id_token claims = Array
(
)


08-12 12:03:50  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 12:03:50  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:03:50  DEBUG ss = sha256(spardecohttps://localhosta4ae02a4c985070e26fef7fa0c493983e7e363fd1fe0304355f57e373b029c1e).e7e363fd1fe0304355f57e373b029c1e

==============================================================================
08-12 12:03:50  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => YqKpNFKhgTC8vjQtkrqnnQNFV-XQ2HuPahT4Bl8Yyf0
    [state] => 5749261
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=YqKpNFKhgTC8vjQtkrqnnQNFV-XQ2HuPahT4Bl8Yyf0&state=5749261&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 12:03:50  DEBUG spardeco
client_secret_post

08-12 12:03:50  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 12:03:50  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 12:03:50  DEBUG requested idtoken claims = Array
(
)


08-12 12:03:50  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-12 12:03:50  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439374130
    [iat] => 1439373830
    [at_hash] => 1Dqk4ZInFG6FddHXhiU7bg
)


08-12 12:03:50  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 12:03:50  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc0MTMwLCJpYXQiOjE0MzkzNzM4MzAsImF0X2hhc2giOiIxRHFrNFpJbkZHNkZkZEhYaGlVN2JnIn0.TnVBXq0EPFta0AxPOV6NtNnsq0_AfuYRKbt85pr76ymYf58Pmm_Ld9Zuw-H-LskGUiketGrEATyc-j96MJGPaW4NffmB6XnxY0Uo5JmwPfWMOuAXIEBo6FFTFjU1m9QaspFhwUjGT8ttBLjHpOwDAJjyTfN92cmBSRCH-ZpBMw1yTMMDFyPx1G4gzMO4mEQqkFYKAfPqOXeF0HgU7vIzDZ0bLvwLc51e7ATCaJ-YFcRR46BXEZjxSNFTdVK1pGXsttNmWd2DCdimSaJLL1LxGZOInKtrU3DmojSFJS3rKhDcMvWqN4D63jIJz3NQj-IvNt4efzu8-kh4bfUdrsoQUQ

08-12 12:03:50  DEBUG token response = Array
(
    [access_token] => BOhs29I9iZH3D3pF1DQsGX_ND8lhZ8ki-Rah1-fav68
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc0MTMwLCJpYXQiOjE0MzkzNzM4MzAsImF0X2hhc2giOiIxRHFrNFpJbkZHNkZkZEhYaGlVN2JnIn0.TnVBXq0EPFta0AxPOV6NtNnsq0_AfuYRKbt85pr76ymYf58Pmm_Ld9Zuw-H-LskGUiketGrEATyc-j96MJGPaW4NffmB6XnxY0Uo5JmwPfWMOuAXIEBo6FFTFjU1m9QaspFhwUjGT8ttBLjHpOwDAJjyTfN92cmBSRCH-ZpBMw1yTMMDFyPx1G4gzMO4mEQqkFYKAfPqOXeF0HgU7vIzDZ0bLvwLc51e7ATCaJ-YFcRR46BXEZjxSNFTdVK1pGXsttNmWd2DCdimSaJLL1LxGZOInKtrU3DmojSFJS3rKhDcMvWqN4D63jIJz3NQj-IvNt4efzu8-kh4bfUdrsoQUQ
)


==============================================================================
08-12 12:03:50  DEBUG Request: Array
(
    [access_token] => BOhs29I9iZH3D3pF1DQsGX_ND8lhZ8ki-Rah1-fav68
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=BOhs29I9iZH3D3pF1DQsGX_ND8lhZ8ki-Rah1-fav68","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 12:03:50  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-12 12:03:50  DEBUG wrapped |wFF#9yFk6Ca unwrapped = 1:simon

08-12 12:03:50  DEBUG userid = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8  unwrapped = simon

08-12 12:03:50  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5749261
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373828
)
 scopes = profile openid email

08-12 12:03:50  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:03:50  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:03:50  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:03:50  DEBUG returning = Array
(
    [birthdate] => 1898
    [email] => simon.becot@orange.com
    [email_verified] => 1
    [family_name] => Becot
    [gender] => male
    [given_name] => Simon
    [locale] => fr
    [middle_name] => 
    [name] => Simon Becot
    [nickname] => 
    [picture] => https://localhost/phpOp/profiles/pic.jpg
    [preferred_username] => 
    [profile] => http://profile/simon
    [updated_at] => 
    [website] => http://website
    [zoneinfo] => 
)


08-12 12:03:50  DEBUG userinfo response = {"sub":"c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8","birthdate":"1898","email":"simon.becot@orange.com","email_verified":true,"family_name":"Becot","gender":"male","given_name":"Simon","locale":"fr","middle_name":null,"name":"Simon Becot","nickname":null,"picture":"https:\/\/localhost\/phpOp\/profiles\/pic.jpg","preferred_username":null,"profile":"http:\/\/profile\/simon","updated_at":null,"website":"http:\/\/website","zoneinfo":null}

==============================================================================
08-12 12:04:04  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5749261
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5749261","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 12:04:04  DEBUG prompt = 

08-12 12:04:04  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 12:04:13  DEBUG Request: Array
(
    [username] => bob
    [password] => underland
)

Input: username=bob&password=underland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5749261
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5749261
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5749261"} []
----------------------------------------------------------

08-12 12:04:13  DEBUG Auth_time = 1439373853

08-12 12:04:13  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 12:04:13  DEBUG prompt = 

08-12 12:04:13  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5749261
)
 scopes = profile openid email

08-12 12:04:13  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:04:13  DEBUG id_token claims = Array
(
)


08-12 12:04:13  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 12:04:13  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:04:13  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 12:04:15  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5749261
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5749261
        )

    [login] => 1
    [username] => bob
    [persist] => 
    [auth_time] => 1439373853
    [ops] => fdcefee00e5737cbcf2f88528f22178b
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 12:04:15  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5749261
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373853
)
 scopes = profile openid email

08-12 12:04:15  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:04:15  DEBUG id_token claims = Array
(
)


08-12 12:04:15  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 12:04:15  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:04:15  DEBUG ss = sha256(spardecohttps://localhostfdcefee00e5737cbcf2f88528f22178b458c5d91344c53c728d83c8c255bdb38).458c5d91344c53c728d83c8c255bdb38

==============================================================================
08-12 12:04:15  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 2Kqbx_EW7BexxLP08QdKJlm6h9dnYn9IGBkKZDk4Vsk
    [state] => 5749261
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=2Kqbx_EW7BexxLP08QdKJlm6h9dnYn9IGBkKZDk4Vsk&state=5749261&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 12:04:15  DEBUG spardeco
client_secret_post

08-12 12:04:15  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 12:04:15  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 12:04:15  DEBUG requested idtoken claims = Array
(
)


08-12 12:04:15  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 12:04:15  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439374155
    [iat] => 1439373855
    [at_hash] => u0YD-qtPfEJfcNPni4khMQ
)


08-12 12:04:15  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 12:04:16  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc0MTU1LCJpYXQiOjE0MzkzNzM4NTUsImF0X2hhc2giOiJ1MFlELXF0UGZFSmZjTlBuaTRraE1RIn0.jmjglSqVOJC9OPVfa7Rc5Bwong9aD7b6EhafJT-up3xMTkS8u0CDmldqCUfJKgbK2UH-YihWCig_40SEjE91-fIE4CGBaqJigGkQAqQ5Yyv0gSIuYgsBkvWwMFUjhiV3Bf4lx2dtvjtfuaZpEUeF06h9FpV3qZyool6xjpX0X2mjbI3iznHJgn3K6UmTSC-LV7rkx0o8w7Mv8kAP3XtzwTrNXdyNGtnfKjeEjzqG1tKe8J6paxeetaPc-TQlejE22_EWc6Khv3BKYGtwI17UIqCcXaHmSNs7Irra__dC9lUW0kV1ukYqBPIJ6FV5MWkChUUTFhzZJ2_S1DOrBlxFew

08-12 12:04:16  DEBUG token response = Array
(
    [access_token] => suZTyq54RK1O-xWwt51Tgt4gD7eHvN7IqNj4g3hLcXA
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc0MTU1LCJpYXQiOjE0MzkzNzM4NTUsImF0X2hhc2giOiJ1MFlELXF0UGZFSmZjTlBuaTRraE1RIn0.jmjglSqVOJC9OPVfa7Rc5Bwong9aD7b6EhafJT-up3xMTkS8u0CDmldqCUfJKgbK2UH-YihWCig_40SEjE91-fIE4CGBaqJigGkQAqQ5Yyv0gSIuYgsBkvWwMFUjhiV3Bf4lx2dtvjtfuaZpEUeF06h9FpV3qZyool6xjpX0X2mjbI3iznHJgn3K6UmTSC-LV7rkx0o8w7Mv8kAP3XtzwTrNXdyNGtnfKjeEjzqG1tKe8J6paxeetaPc-TQlejE22_EWc6Khv3BKYGtwI17UIqCcXaHmSNs7Irra__dC9lUW0kV1ukYqBPIJ6FV5MWkChUUTFhzZJ2_S1DOrBlxFew
)


==============================================================================
08-12 12:04:16  DEBUG Request: Array
(
    [access_token] => suZTyq54RK1O-xWwt51Tgt4gD7eHvN7IqNj4g3hLcXA
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=suZTyq54RK1O-xWwt51Tgt4gD7eHvN7IqNj4g3hLcXA","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 12:04:16  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 12:04:16  DEBUG wrapped &1vv'
CC unwrapped = 1:bob

08-12 12:04:16  DEBUG userid = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143  unwrapped = bob

08-12 12:04:16  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5749261
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373853
)
 scopes = profile openid email

08-12 12:04:16  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:04:16  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:04:16  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:04:16  DEBUG returning = Array
(
    [birthdate] => 2111-11-11
    [email] => bob@underland.com
    [email_verified] => 1
    [family_name] => Ikeda
    [gender] => male
    [given_name] => Bob
    [locale] => fr
    [middle_name] => 
    [name] => Bob Ikeda
    [nickname] => BobNick
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => BobPreferred
    [profile] => http://www.underland.com/bob
    [updated_at] => 2147483647
    [website] => http://www.underland.com
    [zoneinfo] => France/Paris
)


08-12 12:04:16  DEBUG userinfo response = {"sub":"2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143","birthdate":"2111-11-11","email":"bob@underland.com","email_verified":true,"family_name":"Ikeda","gender":"male","given_name":"Bob","locale":"fr","middle_name":null,"name":"Bob Ikeda","nickname":"BobNick","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"BobPreferred","profile":"http:\/\/www.underland.com\/bob","updated_at":"2147483647","website":"http:\/\/www.underland.com","zoneinfo":"France\/Paris"}

==============================================================================
08-12 12:04:56  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1059877
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1059877","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 12:04:56  DEBUG prompt = 

08-12 12:04:56  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 12:05:03  DEBUG Request: Array
(
    [username] => simon
    [password] => toto
)

Input: username=simon&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1059877
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1059877
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1059877"} []
----------------------------------------------------------

08-12 12:05:03  DEBUG Auth_time = 1439373903

08-12 12:05:03  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 12:05:03  DEBUG prompt = 

08-12 12:05:03  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1059877
)
 scopes = profile openid email

08-12 12:05:03  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:05:03  DEBUG id_token claims = Array
(
)


08-12 12:05:03  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 12:05:03  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:05:03  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 12:05:05  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1059877
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1059877
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439373903
    [ops] => 8164410d33f832ecb6c899ad6ac400e6
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 12:05:05  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1059877
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373903
)
 scopes = profile openid email

08-12 12:05:05  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:05:05  DEBUG id_token claims = Array
(
)


08-12 12:05:05  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 12:05:05  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:05:05  DEBUG ss = sha256(spardecohttps://localhost8164410d33f832ecb6c899ad6ac400e6d8ff754a61faacce251a09a7df37c8b5).d8ff754a61faacce251a09a7df37c8b5

==============================================================================
08-12 12:05:05  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => zoMybJiDHvDF5wOum62gqRj0OqY-BxNUL06UbOQgY_Y
    [state] => 1059877
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=zoMybJiDHvDF5wOum62gqRj0OqY-BxNUL06UbOQgY_Y&state=1059877&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 12:05:05  DEBUG spardeco
client_secret_post

08-12 12:05:05  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 12:05:05  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 12:05:05  DEBUG requested idtoken claims = Array
(
)


08-12 12:05:05  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-12 12:05:05  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439374205
    [iat] => 1439373905
    [at_hash] => jVakOn9yQnla12HJ46rfKA
)


08-12 12:05:05  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 12:05:05  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc0MjA1LCJpYXQiOjE0MzkzNzM5MDUsImF0X2hhc2giOiJqVmFrT245eVFubGExMkhKNDZyZktBIn0.vxk2Wnm38NpXxHdx0_s1zfZQkNjxmViizIjg2WQISUz9isqbDbR5ktnY7ZYawkmGSDRMjefCNq5xV67LGR8YJOYarGEocTI0wA7hlprEDPZIu3pKvAYnWDx_vrFgs6pkHUHZDcb_VRRF4GqNlF6ZO4c8O1VS2Fs5RZqXipLY9Pru2Js9qdEc4I5UTF5xz5uRVUpJZNBm7NYST7YRbAOg48yHsawrXN6Ef3jWwo6ERCzZjP7uY4n8DhQ91H8Lx7YZ8fzJOvu4L8ch3PuyMQ4wdCwKnuWq8Pn_R_6enRZ1taoQ5mc8-pIF4sqcs0fI5I1xFTetuTrbWj2LlhKtLw3VOg

08-12 12:05:05  DEBUG token response = Array
(
    [access_token] => VBc3PGZ-OCTu5hTRjTdUSGLD1YGVVXQ2kpqWtnBd7pc
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc0MjA1LCJpYXQiOjE0MzkzNzM5MDUsImF0X2hhc2giOiJqVmFrT245eVFubGExMkhKNDZyZktBIn0.vxk2Wnm38NpXxHdx0_s1zfZQkNjxmViizIjg2WQISUz9isqbDbR5ktnY7ZYawkmGSDRMjefCNq5xV67LGR8YJOYarGEocTI0wA7hlprEDPZIu3pKvAYnWDx_vrFgs6pkHUHZDcb_VRRF4GqNlF6ZO4c8O1VS2Fs5RZqXipLY9Pru2Js9qdEc4I5UTF5xz5uRVUpJZNBm7NYST7YRbAOg48yHsawrXN6Ef3jWwo6ERCzZjP7uY4n8DhQ91H8Lx7YZ8fzJOvu4L8ch3PuyMQ4wdCwKnuWq8Pn_R_6enRZ1taoQ5mc8-pIF4sqcs0fI5I1xFTetuTrbWj2LlhKtLw3VOg
)


==============================================================================
08-12 12:05:06  DEBUG Request: Array
(
    [access_token] => VBc3PGZ-OCTu5hTRjTdUSGLD1YGVVXQ2kpqWtnBd7pc
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=VBc3PGZ-OCTu5hTRjTdUSGLD1YGVVXQ2kpqWtnBd7pc","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 12:05:06  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-12 12:05:06  DEBUG wrapped |wFF#9yFk6Ca unwrapped = 1:simon

08-12 12:05:06  DEBUG userid = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8  unwrapped = simon

08-12 12:05:06  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1059877
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439373903
)
 scopes = profile openid email

08-12 12:05:06  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:05:06  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:05:06  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:05:06  DEBUG returning = Array
(
    [birthdate] => 1898
    [email] => simon.becot@orange.com
    [email_verified] => 1
    [family_name] => Becot
    [gender] => male
    [given_name] => Simon
    [locale] => fr
    [middle_name] => 
    [name] => Simon Becot
    [nickname] => 
    [picture] => https://localhost/phpOp/profiles/pic.jpg
    [preferred_username] => 
    [profile] => http://profile/simon
    [updated_at] => 
    [website] => http://website
    [zoneinfo] => 
)


08-12 12:05:06  DEBUG userinfo response = {"sub":"c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8","birthdate":"1898","email":"simon.becot@orange.com","email_verified":true,"family_name":"Becot","gender":"male","given_name":"Simon","locale":"fr","middle_name":null,"name":"Simon Becot","nickname":null,"picture":"https:\/\/localhost\/phpOp\/profiles\/pic.jpg","preferred_username":null,"profile":"http:\/\/profile\/simon","updated_at":null,"website":"http:\/\/website","zoneinfo":null}

==============================================================================
08-12 12:06:30  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9875882
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9875882","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 12:06:30  DEBUG prompt = 

08-12 12:06:30  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 12:06:41  DEBUG Request: Array
(
    [username] => simon
    [password] => toto
)

Input: username=simon&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9875882
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9875882
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9875882"} []
----------------------------------------------------------

08-12 12:06:41  DEBUG Auth_time = 1439374001

08-12 12:06:41  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 12:06:41  DEBUG prompt = 

08-12 12:06:41  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9875882
)
 scopes = profile openid email

08-12 12:06:41  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:06:41  DEBUG id_token claims = Array
(
)


08-12 12:06:41  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 12:06:41  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:06:41  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 12:06:43  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9875882
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9875882
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439374001
    [ops] => 2a6e1a0de952d2c1006a76c60b4ea340
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 12:06:43  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9875882
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439374001
)
 scopes = profile openid email

08-12 12:06:43  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:06:43  DEBUG id_token claims = Array
(
)


08-12 12:06:43  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 12:06:43  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:06:43  DEBUG ss = sha256(spardecohttps://localhost2a6e1a0de952d2c1006a76c60b4ea34001579292c283c4af6514f91593d4ffc4).01579292c283c4af6514f91593d4ffc4

==============================================================================
08-12 12:06:43  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => Jy50XrIeI7uT6qUIPSx0Tf5rbG3WtXvPNKqinlnkEvY
    [state] => 9875882
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=Jy50XrIeI7uT6qUIPSx0Tf5rbG3WtXvPNKqinlnkEvY&state=9875882&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 12:06:43  DEBUG spardeco
client_secret_post

08-12 12:06:43  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 12:06:44  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 12:06:44  DEBUG requested idtoken claims = Array
(
)


08-12 12:06:44  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-12 12:06:44  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439374304
    [iat] => 1439374004
    [at_hash] => qZce4UhgT___AcR571Kvvw
)


08-12 12:06:44  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 12:06:44  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc0MzA0LCJpYXQiOjE0MzkzNzQwMDQsImF0X2hhc2giOiJxWmNlNFVoZ1RfX19BY1I1NzFLdnZ3In0.bL7n3sYT_4v8cxYUsWsatQdsR-3nhGLlkD7kWXwRE1B9XqSQpbslZrkWmCeRcaDPZr9Ax5sFpeQJ9WIpb6ibLnOxVF6vDX42KDN0I70qDGcRxPMsnJ4sMGz27sVjFbATMZn9Ts3xRupaJtWYVDyGipBptslkmKgOjMdNFOsYjtoezrAiAxuUTkb9SEPP5wSExa92cSnj1MrFt1C1ppWjWC9IFNCvyWiZV2d99Hdy2sDN7c7sQAvoFdnfHYZ5fnB_sb-2H2NfArdLproNpMe2jfFSx8u0ff2wYv80t6_WHRjW4QY8wibf0ieXkbnGD96B5uvW3bYfcTrwdEuWghhz_Q

08-12 12:06:44  DEBUG token response = Array
(
    [access_token] => FzYkldymBJ6ymN-qDmWeCNFHxjrlSqmW5CQj4aX9Rqk
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc0MzA0LCJpYXQiOjE0MzkzNzQwMDQsImF0X2hhc2giOiJxWmNlNFVoZ1RfX19BY1I1NzFLdnZ3In0.bL7n3sYT_4v8cxYUsWsatQdsR-3nhGLlkD7kWXwRE1B9XqSQpbslZrkWmCeRcaDPZr9Ax5sFpeQJ9WIpb6ibLnOxVF6vDX42KDN0I70qDGcRxPMsnJ4sMGz27sVjFbATMZn9Ts3xRupaJtWYVDyGipBptslkmKgOjMdNFOsYjtoezrAiAxuUTkb9SEPP5wSExa92cSnj1MrFt1C1ppWjWC9IFNCvyWiZV2d99Hdy2sDN7c7sQAvoFdnfHYZ5fnB_sb-2H2NfArdLproNpMe2jfFSx8u0ff2wYv80t6_WHRjW4QY8wibf0ieXkbnGD96B5uvW3bYfcTrwdEuWghhz_Q
)


==============================================================================
08-12 12:06:44  DEBUG Request: Array
(
    [access_token] => FzYkldymBJ6ymN-qDmWeCNFHxjrlSqmW5CQj4aX9Rqk
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=FzYkldymBJ6ymN-qDmWeCNFHxjrlSqmW5CQj4aX9Rqk","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 12:06:44  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-12 12:06:44  DEBUG wrapped |wFF#9yFk6Ca unwrapped = 1:simon

08-12 12:06:44  DEBUG userid = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8  unwrapped = simon

08-12 12:06:44  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9875882
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439374001
)
 scopes = profile openid email

08-12 12:06:44  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:06:44  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:06:44  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:06:44  DEBUG returning = Array
(
    [birthdate] => 1898
    [email] => simon.becot@orange.com
    [email_verified] => 1
    [family_name] => Becot
    [gender] => male
    [given_name] => Simon
    [locale] => fr
    [middle_name] => 
    [name] => Simon Becot
    [nickname] => 
    [picture] => https://localhost/phpOp/profiles/pic.jpg
    [preferred_username] => 
    [profile] => http://profile/simon
    [updated_at] => 
    [website] => http://website
    [zoneinfo] => 
)


08-12 12:06:44  DEBUG userinfo response = {"sub":"c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8","birthdate":"1898","email":"simon.becot@orange.com","email_verified":true,"family_name":"Becot","gender":"male","given_name":"Simon","locale":"fr","middle_name":null,"name":"Simon Becot","nickname":null,"picture":"https:\/\/localhost\/phpOp\/profiles\/pic.jpg","preferred_username":null,"profile":"http:\/\/profile\/simon","updated_at":null,"website":"http:\/\/website","zoneinfo":null}

==============================================================================
08-12 12:07:16  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8197690
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8197690","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 12:07:16  DEBUG prompt = 

08-12 12:07:16  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 12:07:24  DEBUG Request: Array
(
    [username] => simon
    [password] => toto
)

Input: username=simon&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8197690
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8197690
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8197690"} []
----------------------------------------------------------

08-12 12:07:24  DEBUG Auth_time = 1439374044

08-12 12:07:24  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 12:07:24  DEBUG prompt = 

08-12 12:07:24  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8197690
)
 scopes = profile openid email

08-12 12:07:24  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:07:24  DEBUG id_token claims = Array
(
)


08-12 12:07:24  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 12:07:24  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:07:24  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 12:07:26  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8197690
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8197690
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439374044
    [ops] => a7b1578bf0dc755f20f7ebd20af41e3e
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 12:07:26  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8197690
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439374044
)
 scopes = profile openid email

08-12 12:07:26  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:07:26  DEBUG id_token claims = Array
(
)


08-12 12:07:26  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 12:07:26  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:07:26  DEBUG ss = sha256(spardecohttps://localhosta7b1578bf0dc755f20f7ebd20af41e3e8cf918007ea59715834cedb5db1c0b32).8cf918007ea59715834cedb5db1c0b32

==============================================================================
08-12 12:07:27  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 8be-tw3Rwua-OMIh12vjcOaCL0BvI10DAY6dVAnQfTk
    [state] => 8197690
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=8be-tw3Rwua-OMIh12vjcOaCL0BvI10DAY6dVAnQfTk&state=8197690&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 12:07:27  DEBUG spardeco
client_secret_post

08-12 12:07:27  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 12:07:27  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 12:07:27  DEBUG requested idtoken claims = Array
(
)


08-12 12:07:27  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-12 12:07:27  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439374347
    [iat] => 1439374047
    [at_hash] => 9e0ivcOWbeN7wyDgND9cfw
)


08-12 12:07:27  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 12:07:27  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc0MzQ3LCJpYXQiOjE0MzkzNzQwNDcsImF0X2hhc2giOiI5ZTBpdmNPV2JlTjd3eURnTkQ5Y2Z3In0.jf4WQih9IXSPNdYHD6PbLM_EoCM2B6b5mGaq4lotgD8fUzt36MTjXUd8cBbBop-wpWyCpjPJa5mwcmpHyzN-c00nfr7Geu4HN9gTfu6N5lmyC1cphp6XohwkwzUlPov_4FkrDuy9oiE1by-q96fEL28ajZg9aX2jcMa0l5iRd2lcX11a-0bshJwEBvQZW8TEsk-4rBG4vDlZ15EvW7vpscoF3J29SbWzmSZdL1LdIVi4gqS4KKC1n8BQvg0wmbPVbnrhsv_1xuaxfCxhjM8pSnuMmVCoUPG9shXpVk1eid7FPp9yhGjOhor_v4_kynkwXZIcmyst0yHQTcbgS25bGw

08-12 12:07:27  DEBUG token response = Array
(
    [access_token] => mJ4WKdfSTOT80PRZ5vgsOIGBlVyeqsFzkmGA-rorfnc
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc0MzQ3LCJpYXQiOjE0MzkzNzQwNDcsImF0X2hhc2giOiI5ZTBpdmNPV2JlTjd3eURnTkQ5Y2Z3In0.jf4WQih9IXSPNdYHD6PbLM_EoCM2B6b5mGaq4lotgD8fUzt36MTjXUd8cBbBop-wpWyCpjPJa5mwcmpHyzN-c00nfr7Geu4HN9gTfu6N5lmyC1cphp6XohwkwzUlPov_4FkrDuy9oiE1by-q96fEL28ajZg9aX2jcMa0l5iRd2lcX11a-0bshJwEBvQZW8TEsk-4rBG4vDlZ15EvW7vpscoF3J29SbWzmSZdL1LdIVi4gqS4KKC1n8BQvg0wmbPVbnrhsv_1xuaxfCxhjM8pSnuMmVCoUPG9shXpVk1eid7FPp9yhGjOhor_v4_kynkwXZIcmyst0yHQTcbgS25bGw
)


==============================================================================
08-12 12:07:27  DEBUG Request: Array
(
    [access_token] => mJ4WKdfSTOT80PRZ5vgsOIGBlVyeqsFzkmGA-rorfnc
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=mJ4WKdfSTOT80PRZ5vgsOIGBlVyeqsFzkmGA-rorfnc","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 12:07:27  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-12 12:07:27  DEBUG wrapped |wFF#9yFk6Ca unwrapped = 1:simon

08-12 12:07:27  DEBUG userid = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8  unwrapped = simon

08-12 12:07:27  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8197690
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439374044
)
 scopes = profile openid email

08-12 12:07:27  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:07:27  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:07:27  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:07:27  DEBUG returning = Array
(
    [birthdate] => 1898
    [email] => simon.becot@orange.com
    [email_verified] => 1
    [family_name] => Becot
    [gender] => male
    [given_name] => Simon
    [locale] => fr
    [middle_name] => 
    [name] => Simon Becot
    [nickname] => 
    [picture] => https://localhost/phpOp/profiles/pic.jpg
    [preferred_username] => 
    [profile] => http://profile/simon
    [updated_at] => 
    [website] => http://website
    [zoneinfo] => 
)


08-12 12:07:27  DEBUG userinfo response = {"sub":"c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8","birthdate":"1898","email":"simon.becot@orange.com","email_verified":true,"family_name":"Becot","gender":"male","given_name":"Simon","locale":"fr","middle_name":null,"name":"Simon Becot","nickname":null,"picture":"https:\/\/localhost\/phpOp\/profiles\/pic.jpg","preferred_username":null,"profile":"http:\/\/profile\/simon","updated_at":null,"website":"http:\/\/website","zoneinfo":null}

==============================================================================
08-12 12:10:59  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8197690
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8197690","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 12:10:59  DEBUG prompt = 

08-12 12:10:59  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 12:11:18  DEBUG Request: Array
(
    [username] => simon
    [password] => toto
)

Input: username=simon&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8197690
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8197690
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8197690"} []
----------------------------------------------------------

08-12 12:11:18  DEBUG Auth_time = 1439374278

08-12 12:11:18  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 12:11:18  DEBUG prompt = 

08-12 12:11:18  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8197690
)
 scopes = profile openid email

08-12 12:11:18  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:11:18  DEBUG id_token claims = Array
(
)


08-12 12:11:18  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 12:11:18  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:11:18  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 12:11:19  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8197690
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8197690
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439374278
    [ops] => e6ee90784549511cf19c37c34d2f055d
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 12:11:20  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8197690
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439374278
)
 scopes = profile openid email

08-12 12:11:20  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:11:20  DEBUG id_token claims = Array
(
)


08-12 12:11:20  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 12:11:20  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:11:20  DEBUG ss = sha256(spardecohttps://localhoste6ee90784549511cf19c37c34d2f055dc5e336f7859d9cee840574e214edb4bf).c5e336f7859d9cee840574e214edb4bf

==============================================================================
08-12 12:11:20  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 2TNKddSEMbLAieMXxyr404nmgvrKq7NLinzgcIPhK1Q
    [state] => 8197690
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=2TNKddSEMbLAieMXxyr404nmgvrKq7NLinzgcIPhK1Q&state=8197690&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 12:11:20  DEBUG spardeco
client_secret_post

08-12 12:11:20  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 12:11:20  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 12:11:20  DEBUG requested idtoken claims = Array
(
)


08-12 12:11:20  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-12 12:11:20  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439374580
    [iat] => 1439374280
    [at_hash] => 1psoUbYJpEP6ZW0sApN8gQ
)


08-12 12:11:20  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 12:11:20  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc0NTgwLCJpYXQiOjE0MzkzNzQyODAsImF0X2hhc2giOiIxcHNvVWJZSnBFUDZaVzBzQXBOOGdRIn0.Tu5VKkDyk08FWAIUPkO5eCfGJm8clq2DLCAuM7CtCo2or9ENNyf_msQqrTWqyFiPqxLt2Ka-lSmDCodDzDQ-I-HtcDdSVDjk3F0k-7a50Np1Ugg3sHc6UDAi9M1ZmYQNh959MrjJSTbsN3AiAkBrzOE3IzhsHnCH4TgU4uOX0gTwB5VD3Ox6TAW0LpCtZ-IkzgZTa0Gpdb5UCFuANDtNp5YN7XObi_Vmxn1mOedth_NACKK9KCt3BYYBaz6aXlai6uHmCX02Vxa4vwiUdaJsFvHsoFD6TTEHjZs9dGtdVV9XvxsGdU266OQJy1QhgY--2AcCpBdetVeX_zpG8BJMDw

08-12 12:11:20  DEBUG token response = Array
(
    [access_token] => Wp0R9EfjmkxKhEXaTxZJDR7Zid65CcTCPnLVzURaihU
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc0NTgwLCJpYXQiOjE0MzkzNzQyODAsImF0X2hhc2giOiIxcHNvVWJZSnBFUDZaVzBzQXBOOGdRIn0.Tu5VKkDyk08FWAIUPkO5eCfGJm8clq2DLCAuM7CtCo2or9ENNyf_msQqrTWqyFiPqxLt2Ka-lSmDCodDzDQ-I-HtcDdSVDjk3F0k-7a50Np1Ugg3sHc6UDAi9M1ZmYQNh959MrjJSTbsN3AiAkBrzOE3IzhsHnCH4TgU4uOX0gTwB5VD3Ox6TAW0LpCtZ-IkzgZTa0Gpdb5UCFuANDtNp5YN7XObi_Vmxn1mOedth_NACKK9KCt3BYYBaz6aXlai6uHmCX02Vxa4vwiUdaJsFvHsoFD6TTEHjZs9dGtdVV9XvxsGdU266OQJy1QhgY--2AcCpBdetVeX_zpG8BJMDw
)


==============================================================================
08-12 12:11:20  DEBUG Request: Array
(
    [access_token] => Wp0R9EfjmkxKhEXaTxZJDR7Zid65CcTCPnLVzURaihU
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=Wp0R9EfjmkxKhEXaTxZJDR7Zid65CcTCPnLVzURaihU","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 12:11:20  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-12 12:11:20  DEBUG wrapped |wFF#9yFk6Ca unwrapped = 1:simon

08-12 12:11:20  DEBUG userid = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8  unwrapped = simon

08-12 12:11:20  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8197690
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439374278
)
 scopes = profile openid email

08-12 12:11:20  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:11:20  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 12:11:20  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 12:11:20  DEBUG returning = Array
(
    [birthdate] => 1898
    [email] => simon.becot@orange.com
    [email_verified] => 1
    [family_name] => Becot
    [gender] => male
    [given_name] => Simon
    [locale] => fr
    [middle_name] => 
    [name] => Simon Becot
    [nickname] => 
    [picture] => https://localhost/phpOp/profiles/pic.jpg
    [preferred_username] => 
    [profile] => http://profile/simon
    [updated_at] => 
    [website] => http://website
    [zoneinfo] => 
)


08-12 12:11:20  DEBUG userinfo response = {"sub":"c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8","birthdate":"1898","email":"simon.becot@orange.com","email_verified":true,"family_name":"Becot","gender":"male","given_name":"Simon","locale":"fr","middle_name":null,"name":"Simon Becot","nickname":null,"picture":"https:\/\/localhost\/phpOp\/profiles\/pic.jpg","preferred_username":null,"profile":"http:\/\/profile\/simon","updated_at":null,"website":"http:\/\/website","zoneinfo":null}

==============================================================================
08-12 13:40:20  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1187197
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1187197","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 13:40:20  DEBUG prompt = 

08-12 13:40:20  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 13:40:22  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1187197
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1187197
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1187197"} []
----------------------------------------------------------

08-12 13:40:22  DEBUG Auth_time = 1439379622

08-12 13:40:22  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 13:40:22  DEBUG prompt = 

08-12 13:40:22  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1187197
)
 scopes = profile openid email

08-12 13:40:22  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:40:22  DEBUG id_token claims = Array
(
)


08-12 13:40:22  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:40:22  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:40:22  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 13:40:23  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1187197
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1187197
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439379622
    [ops] => 367977c001814f85266eb2d25e0ac4f5
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 13:40:23  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1187197
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439379622
)
 scopes = profile openid email

08-12 13:40:23  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:40:23  DEBUG id_token claims = Array
(
)


08-12 13:40:23  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:40:23  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:40:23  DEBUG ss = sha256(spardecohttps://localhost367977c001814f85266eb2d25e0ac4f500a83927e7bc8c347665d82cdea44f4c).00a83927e7bc8c347665d82cdea44f4c

==============================================================================
08-12 13:40:24  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => t4BGlrehNmRtQNeYTGhSbmQjFXDS6W0crCqC_K6hdPE
    [state] => 1187197
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=t4BGlrehNmRtQNeYTGhSbmQjFXDS6W0crCqC_K6hdPE&state=1187197&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:40:24  DEBUG spardeco
client_secret_post

08-12 13:40:24  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 13:40:24  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 13:40:24  DEBUG requested idtoken claims = Array
(
)


08-12 13:40:24  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 13:40:24  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439379924
    [iat] => 1439379624
    [at_hash] => l0YxCvE6CyfH8ktNv9kNGQ
)


08-12 13:40:24  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 13:40:24  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc5OTI0LCJpYXQiOjE0MzkzNzk2MjQsImF0X2hhc2giOiJsMFl4Q3ZFNkN5Zkg4a3ROdjlrTkdRIn0.VgzawAuFMYtdcSShq16jvw3n54o4l8B073BuP-hJblFf4EJzd-2P9akvGbViTEApKSKwhRy50gr6fusDY-c-isH0nZPWzQDVfZTUaVqB723L8zCITNwUzfP3HGzmoCXvErYl28CA2RkoxKo186IS_etNhFjVcqtrD9OMI9tQHPgF5qcfnzdEftr-mnEESK-jeqET9chyRfREFb9fD1R0-jyTd9QI0Cssti8fkislT1odTKEpUbD6YEsEustXePrssNsAGTsyruduAg2RGFcuzYqMzZheh_zwGblshX9LPpfBHx9WZHKGUuLddjTjkbZ2OVRhd41r0zzA9iT5aSm4Jg

08-12 13:40:24  DEBUG token response = Array
(
    [access_token] => 8AKL-pHP3F3qqLbrF_tNL5bfl9L4RLPipnh1EM7FFVg
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzc5OTI0LCJpYXQiOjE0MzkzNzk2MjQsImF0X2hhc2giOiJsMFl4Q3ZFNkN5Zkg4a3ROdjlrTkdRIn0.VgzawAuFMYtdcSShq16jvw3n54o4l8B073BuP-hJblFf4EJzd-2P9akvGbViTEApKSKwhRy50gr6fusDY-c-isH0nZPWzQDVfZTUaVqB723L8zCITNwUzfP3HGzmoCXvErYl28CA2RkoxKo186IS_etNhFjVcqtrD9OMI9tQHPgF5qcfnzdEftr-mnEESK-jeqET9chyRfREFb9fD1R0-jyTd9QI0Cssti8fkislT1odTKEpUbD6YEsEustXePrssNsAGTsyruduAg2RGFcuzYqMzZheh_zwGblshX9LPpfBHx9WZHKGUuLddjTjkbZ2OVRhd41r0zzA9iT5aSm4Jg
)


==============================================================================
08-12 13:40:24  DEBUG Request: Array
(
    [access_token] => 8AKL-pHP3F3qqLbrF_tNL5bfl9L4RLPipnh1EM7FFVg
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=8AKL-pHP3F3qqLbrF_tNL5bfl9L4RLPipnh1EM7FFVg","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:40:24  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 13:40:24  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 13:40:24  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 13:40:24  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1187197
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439379622
)
 scopes = profile openid email

08-12 13:40:24  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:40:24  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:40:24  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:40:24  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 13:40:24  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 13:43:05  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5144869
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5144869","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 13:43:05  DEBUG prompt = 

08-12 13:43:05  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 13:43:06  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5144869
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5144869
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5144869"} []
----------------------------------------------------------

08-12 13:43:06  DEBUG Auth_time = 1439379786

08-12 13:43:06  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 13:43:06  DEBUG prompt = 

08-12 13:43:06  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5144869
)
 scopes = profile openid email

08-12 13:43:06  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:43:06  DEBUG id_token claims = Array
(
)


08-12 13:43:06  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:43:06  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:43:06  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 13:43:08  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5144869
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5144869
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439379786
    [ops] => 291041cb373e7df8407ff9987c81bd51
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 13:43:08  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5144869
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439379786
)
 scopes = profile openid email

08-12 13:43:08  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:43:08  DEBUG id_token claims = Array
(
)


08-12 13:43:08  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:43:08  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:43:08  DEBUG ss = sha256(spardecohttps://localhost291041cb373e7df8407ff9987c81bd5177454cab5a9c6f981d79390c32db95ee).77454cab5a9c6f981d79390c32db95ee

==============================================================================
08-12 13:43:08  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => dknQR0YO-3kD9G1orTPewyK3vVm_9flJJQ8A35Tsj9c
    [state] => 5144869
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=dknQR0YO-3kD9G1orTPewyK3vVm_9flJJQ8A35Tsj9c&state=5144869&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:43:08  DEBUG spardeco
client_secret_post

08-12 13:43:08  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 13:43:08  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 13:43:08  DEBUG requested idtoken claims = Array
(
)


08-12 13:43:08  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 13:43:08  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439380088
    [iat] => 1439379788
    [at_hash] => rfuMei6FnzktlcWIZ_2WGw
)


08-12 13:43:08  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 13:43:08  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwMDg4LCJpYXQiOjE0MzkzNzk3ODgsImF0X2hhc2giOiJyZnVNZWk2Rm56a3RsY1dJWl8yV0d3In0.JZig6T0RevDArPeZu2fmSJvOBYesHS0EM6yszFkyi6T9oEoq1677UNd775xS37mLaK7kl78epF6paQeIuST0C1nhhAVWHnkzc-H5g4RaagtZxzo7thtb25V1EBvXvNw3O__kd_4mTmJQIcL1HxYBr_W4vUBFCwn5M7gqUu1mUy9WBZuCWbJ9PYAbem4NdHo5LE6pgEW2FGG365c3A_tInx27XbssryzPmCJMa5ke8FamleykJAn1dvqpmeSifnInM5uCmH2lgN3vfuuuaGVE5uw57BIlcBNKDN3QU6ikbaOBrysQprFPtNrfBv5dNfLs1qqdJvV0jJhTDBBH1xZgxQ

08-12 13:43:08  DEBUG token response = Array
(
    [access_token] => dq9gXdMxvGb6-5e8jwXI9E0AvC4Q3FsPHsF1gfpbCnE
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwMDg4LCJpYXQiOjE0MzkzNzk3ODgsImF0X2hhc2giOiJyZnVNZWk2Rm56a3RsY1dJWl8yV0d3In0.JZig6T0RevDArPeZu2fmSJvOBYesHS0EM6yszFkyi6T9oEoq1677UNd775xS37mLaK7kl78epF6paQeIuST0C1nhhAVWHnkzc-H5g4RaagtZxzo7thtb25V1EBvXvNw3O__kd_4mTmJQIcL1HxYBr_W4vUBFCwn5M7gqUu1mUy9WBZuCWbJ9PYAbem4NdHo5LE6pgEW2FGG365c3A_tInx27XbssryzPmCJMa5ke8FamleykJAn1dvqpmeSifnInM5uCmH2lgN3vfuuuaGVE5uw57BIlcBNKDN3QU6ikbaOBrysQprFPtNrfBv5dNfLs1qqdJvV0jJhTDBBH1xZgxQ
)


==============================================================================
08-12 13:43:09  DEBUG Request: Array
(
    [access_token] => dq9gXdMxvGb6-5e8jwXI9E0AvC4Q3FsPHsF1gfpbCnE
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=dq9gXdMxvGb6-5e8jwXI9E0AvC4Q3FsPHsF1gfpbCnE","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:43:09  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 13:43:09  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 13:43:09  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 13:43:09  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5144869
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439379786
)
 scopes = profile openid email

08-12 13:43:09  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:43:09  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:43:09  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:43:09  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 13:43:09  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 13:44:05  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5144869
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5144869","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 13:44:05  DEBUG prompt = 

08-12 13:44:05  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 13:44:07  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1218819
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5144869
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5144869
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1218819","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 13:44:07  DEBUG prompt = 

08-12 13:44:07  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 13:44:08  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1218819
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1218819
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1218819"} []
----------------------------------------------------------

08-12 13:44:08  DEBUG Auth_time = 1439379848

08-12 13:44:08  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 13:44:08  DEBUG prompt = 

08-12 13:44:08  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1218819
)
 scopes = profile openid email

08-12 13:44:08  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:44:08  DEBUG id_token claims = Array
(
)


08-12 13:44:08  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:44:08  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:44:08  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 13:44:09  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1218819
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1218819
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439379848
    [ops] => 4088d7e6313b893ee1ffec6baee62c16
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 13:44:10  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1218819
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439379848
)
 scopes = profile openid email

08-12 13:44:10  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:44:10  DEBUG id_token claims = Array
(
)


08-12 13:44:10  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:44:10  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:44:10  DEBUG ss = sha256(spardecohttps://localhost4088d7e6313b893ee1ffec6baee62c16f506fd2c5cfbdc97eecd418e5c76de20).f506fd2c5cfbdc97eecd418e5c76de20

==============================================================================
08-12 13:44:10  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => JHtRgKNYWgK78i7McrI6PcVimqSUN6XJF7r9uiV0efU
    [state] => 1218819
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=JHtRgKNYWgK78i7McrI6PcVimqSUN6XJF7r9uiV0efU&state=1218819&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:44:10  DEBUG spardeco
client_secret_post

08-12 13:44:10  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 13:44:10  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 13:44:10  DEBUG requested idtoken claims = Array
(
)


08-12 13:44:10  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 13:44:10  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439380150
    [iat] => 1439379850
    [at_hash] => uH14wk4jSsNb-ELEaPgYBg
)


08-12 13:44:10  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 13:44:10  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwMTUwLCJpYXQiOjE0MzkzNzk4NTAsImF0X2hhc2giOiJ1SDE0d2s0alNzTmItRUxFYVBnWUJnIn0.gZrnMFc2YweKwDlE3Wj7hkEGEG8dhNFmA2YjTw-LwYSQ015LMdmmEHiuLDtP5bR9nHp4JT8evRcY0TrKPTTS9Sa4Kgx0C32-PJMVkqlFKTncv5vNUhjmRD85G6teooAUaNFEwVKfqCubryhfiEvz3YLqnRDPiH3XJ7f4GlTzPIJTiLlpyofmji34QCB7i89Sc8RX-_C7yRQub289undwCUBiSLveJ2vvl2UV5sA6vXc_aiqZ4_Nnk_fCWdxLbrgA4-7JGHsaJlLOW6iSakha60zcykxBYSyGOaW5x8YJn3XiFRYQfvpL5UQH2uHeWEW-fFHb-_uaSzUV2_fN3etTgA

08-12 13:44:10  DEBUG token response = Array
(
    [access_token] => yqCjsUfT0I7scGLk5vf3tHKO_EXq7VfEZqTfDiACUUU
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwMTUwLCJpYXQiOjE0MzkzNzk4NTAsImF0X2hhc2giOiJ1SDE0d2s0alNzTmItRUxFYVBnWUJnIn0.gZrnMFc2YweKwDlE3Wj7hkEGEG8dhNFmA2YjTw-LwYSQ015LMdmmEHiuLDtP5bR9nHp4JT8evRcY0TrKPTTS9Sa4Kgx0C32-PJMVkqlFKTncv5vNUhjmRD85G6teooAUaNFEwVKfqCubryhfiEvz3YLqnRDPiH3XJ7f4GlTzPIJTiLlpyofmji34QCB7i89Sc8RX-_C7yRQub289undwCUBiSLveJ2vvl2UV5sA6vXc_aiqZ4_Nnk_fCWdxLbrgA4-7JGHsaJlLOW6iSakha60zcykxBYSyGOaW5x8YJn3XiFRYQfvpL5UQH2uHeWEW-fFHb-_uaSzUV2_fN3etTgA
)


==============================================================================
08-12 13:44:10  DEBUG Request: Array
(
    [access_token] => yqCjsUfT0I7scGLk5vf3tHKO_EXq7VfEZqTfDiACUUU
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=yqCjsUfT0I7scGLk5vf3tHKO_EXq7VfEZqTfDiACUUU","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:44:10  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 13:44:10  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 13:44:10  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 13:44:10  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1218819
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439379848
)
 scopes = profile openid email

08-12 13:44:10  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:44:10  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:44:10  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:44:10  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 13:44:10  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 13:44:21  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1218819
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1218819","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 13:44:21  DEBUG prompt = 

08-12 13:44:21  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 13:44:23  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1108324
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1218819
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1218819
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1108324","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 13:44:23  DEBUG prompt = 

08-12 13:44:23  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 13:44:32  DEBUG Request: Array
(
    [username] => bob
    [password] => underland
)

Input: username=bob&password=underland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1108324
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1108324
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1108324"} []
----------------------------------------------------------

08-12 13:44:32  DEBUG Auth_time = 1439379872

08-12 13:44:32  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 13:44:32  DEBUG prompt = 

08-12 13:44:32  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1108324
)
 scopes = profile openid email

08-12 13:44:32  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:44:32  DEBUG id_token claims = Array
(
)


08-12 13:44:32  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:44:32  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:44:32  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 13:44:33  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1108324
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1108324
        )

    [login] => 1
    [username] => bob
    [persist] => 
    [auth_time] => 1439379872
    [ops] => 37292e8aaaf1a990bbaebae59895fa58
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 13:44:34  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1108324
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439379872
)
 scopes = profile openid email

08-12 13:44:34  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:44:34  DEBUG id_token claims = Array
(
)


08-12 13:44:34  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:44:34  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:44:34  DEBUG ss = sha256(spardecohttps://localhost37292e8aaaf1a990bbaebae59895fa58eda6d30df74e41fb359635cbca11617c).eda6d30df74e41fb359635cbca11617c

==============================================================================
08-12 13:44:34  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 6OV5N6-KM9WKYxKlccuxMyF2XdwMbb3r81ukWmHMMns
    [state] => 1108324
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=6OV5N6-KM9WKYxKlccuxMyF2XdwMbb3r81ukWmHMMns&state=1108324&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:44:34  DEBUG spardeco
client_secret_post

08-12 13:44:34  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 13:44:34  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 13:44:34  DEBUG requested idtoken claims = Array
(
)


08-12 13:44:34  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 13:44:34  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439380174
    [iat] => 1439379874
    [at_hash] => ow_6AmoCs_MInX74Ag0kgA
)


08-12 13:44:34  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 13:44:34  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwMTc0LCJpYXQiOjE0MzkzNzk4NzQsImF0X2hhc2giOiJvd182QW1vQ3NfTUluWDc0QWcwa2dBIn0.pgvrVxKBGeLnA1weY1QXR_ye6NouLpCaV7GGNY5WOPXomzSBPsEITLto2bdtuYSkDj9RgOqe5d00V_kAqM5nXND-lm1L7-xh_LoPfECBkXDvZSuSYGX60NQNvo-JV7b0HsH0ykbIeuGNaTjiT6r8tyloe8rKAFAcJvUKZ9RcV3xdohIgo6cOEje6kCHf9EK1fSPDS73oIuu60h9M81J6W0knDq04M2yEOj0f1WLf0stSIHiCby84jWiTiuPce-49i_p1MkyeJT-MKHXhB8tcknb3PDYBCXI1Vg0HngOO3ebGtPWvKtExuntt55jP4wb8It39TKcIq10Eq1HPsH6boA

08-12 13:44:34  DEBUG token response = Array
(
    [access_token] => B9hNGqbfjFuZjZZN8RsJEutuhrIzSJlvxgsls98BYYE
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwMTc0LCJpYXQiOjE0MzkzNzk4NzQsImF0X2hhc2giOiJvd182QW1vQ3NfTUluWDc0QWcwa2dBIn0.pgvrVxKBGeLnA1weY1QXR_ye6NouLpCaV7GGNY5WOPXomzSBPsEITLto2bdtuYSkDj9RgOqe5d00V_kAqM5nXND-lm1L7-xh_LoPfECBkXDvZSuSYGX60NQNvo-JV7b0HsH0ykbIeuGNaTjiT6r8tyloe8rKAFAcJvUKZ9RcV3xdohIgo6cOEje6kCHf9EK1fSPDS73oIuu60h9M81J6W0knDq04M2yEOj0f1WLf0stSIHiCby84jWiTiuPce-49i_p1MkyeJT-MKHXhB8tcknb3PDYBCXI1Vg0HngOO3ebGtPWvKtExuntt55jP4wb8It39TKcIq10Eq1HPsH6boA
)


==============================================================================
08-12 13:44:34  DEBUG Request: Array
(
    [access_token] => B9hNGqbfjFuZjZZN8RsJEutuhrIzSJlvxgsls98BYYE
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=B9hNGqbfjFuZjZZN8RsJEutuhrIzSJlvxgsls98BYYE","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:44:34  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 13:44:34  DEBUG wrapped &1vv'
CC unwrapped = 1:bob

08-12 13:44:34  DEBUG userid = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143  unwrapped = bob

08-12 13:44:34  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1108324
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439379872
)
 scopes = profile openid email

08-12 13:44:34  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:44:34  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:44:34  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:44:34  DEBUG returning = Array
(
    [birthdate] => 2111-11-11
    [email] => bob@underland.com
    [email_verified] => 1
    [family_name] => Ikeda
    [gender] => male
    [given_name] => Bob
    [locale] => fr
    [middle_name] => 
    [name] => Bob Ikeda
    [nickname] => BobNick
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => BobPreferred
    [profile] => http://www.underland.com/bob
    [updated_at] => 2147483647
    [website] => http://www.underland.com
    [zoneinfo] => France/Paris
)


08-12 13:44:34  DEBUG userinfo response = {"sub":"2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143","birthdate":"2111-11-11","email":"bob@underland.com","email_verified":true,"family_name":"Ikeda","gender":"male","given_name":"Bob","locale":"fr","middle_name":null,"name":"Bob Ikeda","nickname":"BobNick","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"BobPreferred","profile":"http:\/\/www.underland.com\/bob","updated_at":"2147483647","website":"http:\/\/www.underland.com","zoneinfo":"France\/Paris"}

==============================================================================
08-12 13:45:22  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5981039
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5981039","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 13:45:23  DEBUG prompt = 

08-12 13:45:23  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 13:45:31  DEBUG Request: Array
(
    [username] => bob
    [password] => underland
)

Input: username=bob&password=underland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5981039
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5981039
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5981039"} []
----------------------------------------------------------

08-12 13:45:31  DEBUG Auth_time = 1439379931

08-12 13:45:31  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 13:45:31  DEBUG prompt = 

08-12 13:45:31  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5981039
)
 scopes = profile openid email

08-12 13:45:31  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:45:31  DEBUG id_token claims = Array
(
)


08-12 13:45:31  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:45:31  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:45:31  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 13:45:32  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5981039
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5981039
        )

    [login] => 1
    [username] => bob
    [persist] => 
    [auth_time] => 1439379931
    [ops] => 0dee49031cf0cf5b3ffc1073f3a9ab77
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 13:45:32  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5981039
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439379931
)
 scopes = profile openid email

08-12 13:45:32  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:45:32  DEBUG id_token claims = Array
(
)


08-12 13:45:32  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:45:32  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:45:32  DEBUG ss = sha256(spardecohttps://localhost0dee49031cf0cf5b3ffc1073f3a9ab77e56b127f3cd6df7c9d9379eb627e3d15).e56b127f3cd6df7c9d9379eb627e3d15

==============================================================================
08-12 13:45:32  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 1FXAZ-wwg6fQvvMJkeJirVLi7iVZagbklgHsgf4Tw1w
    [state] => 5981039
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=1FXAZ-wwg6fQvvMJkeJirVLi7iVZagbklgHsgf4Tw1w&state=5981039&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:45:33  DEBUG spardeco
client_secret_post

08-12 13:45:33  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 13:45:33  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 13:45:33  DEBUG requested idtoken claims = Array
(
)


08-12 13:45:33  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 13:45:33  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439380233
    [iat] => 1439379933
    [at_hash] => b01adL9r4k0rFjULR4UVXQ
)


08-12 13:45:33  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 13:45:33  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwMjMzLCJpYXQiOjE0MzkzNzk5MzMsImF0X2hhc2giOiJiMDFhZEw5cjRrMHJGalVMUjRVVlhRIn0.NDSD_Fhy8DTonDsu4P6D-80HzLcdUckLeEcFIR6ftOlbPj6bDtALSxUkViSFZtcgz71YDn-GNvP0r0Ff7KyLVNDCAlXmbF1XYM8LhnrdV-Ymd4et4mGgS-vTFpyhWBN0qEgSZS22hRiWTBR5CwvhvY0UEh_f-pZVj9GJ3dkO8cSvf3bjmn201NN4H1tnxzsI8d6X2Vs-YW_pHCBKkhQ3id9W-6YRjuoxFgetvqBPcJzzf-T8q2WzNHLW_5NpeGwkQ2hjDm4vc5rmrUC2NDWtxuSKd1Pe9U0tK-VOdUs5g7aZRMlZDqDY3OH6VNtyQuYyf-00efGYLchlx5JMwmnobw

08-12 13:45:33  DEBUG token response = Array
(
    [access_token] => NA3_kg7juF2TUR80FIjvf0zkMAvyanHTSZ-0bhAmxe0
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwMjMzLCJpYXQiOjE0MzkzNzk5MzMsImF0X2hhc2giOiJiMDFhZEw5cjRrMHJGalVMUjRVVlhRIn0.NDSD_Fhy8DTonDsu4P6D-80HzLcdUckLeEcFIR6ftOlbPj6bDtALSxUkViSFZtcgz71YDn-GNvP0r0Ff7KyLVNDCAlXmbF1XYM8LhnrdV-Ymd4et4mGgS-vTFpyhWBN0qEgSZS22hRiWTBR5CwvhvY0UEh_f-pZVj9GJ3dkO8cSvf3bjmn201NN4H1tnxzsI8d6X2Vs-YW_pHCBKkhQ3id9W-6YRjuoxFgetvqBPcJzzf-T8q2WzNHLW_5NpeGwkQ2hjDm4vc5rmrUC2NDWtxuSKd1Pe9U0tK-VOdUs5g7aZRMlZDqDY3OH6VNtyQuYyf-00efGYLchlx5JMwmnobw
)


==============================================================================
08-12 13:45:33  DEBUG Request: Array
(
    [access_token] => NA3_kg7juF2TUR80FIjvf0zkMAvyanHTSZ-0bhAmxe0
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=NA3_kg7juF2TUR80FIjvf0zkMAvyanHTSZ-0bhAmxe0","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:45:33  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 13:45:33  DEBUG wrapped &1vv'
CC unwrapped = 1:bob

08-12 13:45:33  DEBUG userid = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143  unwrapped = bob

08-12 13:45:33  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5981039
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439379931
)
 scopes = profile openid email

08-12 13:45:33  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:45:33  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:45:33  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:45:33  DEBUG returning = Array
(
    [birthdate] => 2111-11-11
    [email] => bob@underland.com
    [email_verified] => 1
    [family_name] => Ikeda
    [gender] => male
    [given_name] => Bob
    [locale] => fr
    [middle_name] => 
    [name] => Bob Ikeda
    [nickname] => BobNick
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => BobPreferred
    [profile] => http://www.underland.com/bob
    [updated_at] => 2147483647
    [website] => http://www.underland.com
    [zoneinfo] => France/Paris
)


08-12 13:45:33  DEBUG userinfo response = {"sub":"2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143","birthdate":"2111-11-11","email":"bob@underland.com","email_verified":true,"family_name":"Ikeda","gender":"male","given_name":"Bob","locale":"fr","middle_name":null,"name":"Bob Ikeda","nickname":"BobNick","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"BobPreferred","profile":"http:\/\/www.underland.com\/bob","updated_at":"2147483647","website":"http:\/\/www.underland.com","zoneinfo":"France\/Paris"}

==============================================================================
08-12 13:46:03  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5981039
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5981039","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 13:46:03  DEBUG prompt = 

08-12 13:46:03  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 13:46:11  DEBUG Request: Array
(
    [username] => bob
    [password] => underland
)

Input: username=bob&password=underland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5981039
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5981039
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5981039"} []
----------------------------------------------------------

08-12 13:46:11  DEBUG Auth_time = 1439379971

08-12 13:46:11  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 13:46:11  DEBUG prompt = 

08-12 13:46:11  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5981039
)
 scopes = profile openid email

08-12 13:46:11  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:46:11  DEBUG id_token claims = Array
(
)


08-12 13:46:11  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:46:11  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:46:11  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 13:46:15  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5981039
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5981039
        )

    [login] => 1
    [username] => bob
    [persist] => 
    [auth_time] => 1439379971
    [ops] => dcda4a79a7af53758b04bb63b95c83a9
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 13:46:15  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5981039
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439379971
)
 scopes = profile openid email

08-12 13:46:15  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:46:15  DEBUG id_token claims = Array
(
)


08-12 13:46:15  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:46:15  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:46:15  DEBUG ss = sha256(spardecohttps://localhostdcda4a79a7af53758b04bb63b95c83a9836a1a9dd39c335d0dba55b2d57784a4).836a1a9dd39c335d0dba55b2d57784a4

==============================================================================
08-12 13:46:15  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => WWmBJSPdSZu9ivNX4T1NKK3GuA4_QSraMv_lrZBTWCY
    [state] => 5981039
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=WWmBJSPdSZu9ivNX4T1NKK3GuA4_QSraMv_lrZBTWCY&state=5981039&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:46:15  DEBUG spardeco
client_secret_post

08-12 13:46:15  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 13:46:15  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 13:46:15  DEBUG requested idtoken claims = Array
(
)


08-12 13:46:15  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 13:46:15  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439380275
    [iat] => 1439379975
    [at_hash] => o76tWON4xCdUI0wweTWxwg
)


08-12 13:46:15  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 13:46:15  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwMjc1LCJpYXQiOjE0MzkzNzk5NzUsImF0X2hhc2giOiJvNzZ0V09ONHhDZFVJMHd3ZVRXeHdnIn0.HOvvOLi_O44O2jB4_I6IB7N6NjYLyCdb9iZlr_YJp9YZf-peFvpR2LFfLSI-XbrC0XzuHE_4WIhCCnV7-SRsTvnR1IJk5K4627gkU5NBqYz5guBKjpaAQWlr1N-8eGJ07hYeXZt1oJ2wX3tPlC3BEhU57x7N5gQn44pAzMACpe_VcYHs6_rDxuf4s8nDelhdKOaNKf5ZZMzFa91iuAwqT-KApUPchO_JU0I5f3tojUepEFmI8k7eFpqlsZabrtjiHTlwvjdcDHypBT6zMxvmXD2jAllIj_mAwrLcMeoRZBxY78tsmd8-B4pUjnrmjJK3REorCGFtzRUbnv6HwIW00g

08-12 13:46:15  DEBUG token response = Array
(
    [access_token] => bo8NA6ttUvnIzvWFHOULFQGXXMLVkt0biWkqTs8VkpU
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwMjc1LCJpYXQiOjE0MzkzNzk5NzUsImF0X2hhc2giOiJvNzZ0V09ONHhDZFVJMHd3ZVRXeHdnIn0.HOvvOLi_O44O2jB4_I6IB7N6NjYLyCdb9iZlr_YJp9YZf-peFvpR2LFfLSI-XbrC0XzuHE_4WIhCCnV7-SRsTvnR1IJk5K4627gkU5NBqYz5guBKjpaAQWlr1N-8eGJ07hYeXZt1oJ2wX3tPlC3BEhU57x7N5gQn44pAzMACpe_VcYHs6_rDxuf4s8nDelhdKOaNKf5ZZMzFa91iuAwqT-KApUPchO_JU0I5f3tojUepEFmI8k7eFpqlsZabrtjiHTlwvjdcDHypBT6zMxvmXD2jAllIj_mAwrLcMeoRZBxY78tsmd8-B4pUjnrmjJK3REorCGFtzRUbnv6HwIW00g
)


==============================================================================
08-12 13:46:16  DEBUG Request: Array
(
    [access_token] => bo8NA6ttUvnIzvWFHOULFQGXXMLVkt0biWkqTs8VkpU
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=bo8NA6ttUvnIzvWFHOULFQGXXMLVkt0biWkqTs8VkpU","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:46:16  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 13:46:16  DEBUG wrapped &1vv'
CC unwrapped = 1:bob

08-12 13:46:16  DEBUG userid = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143  unwrapped = bob

08-12 13:46:16  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5981039
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439379971
)
 scopes = profile openid email

08-12 13:46:16  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:46:16  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:46:16  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:46:16  DEBUG returning = Array
(
    [birthdate] => 2111-11-11
    [email] => bob@underland.com
    [email_verified] => 1
    [family_name] => Ikeda
    [gender] => male
    [given_name] => Bob
    [locale] => fr
    [middle_name] => 
    [name] => Bob Ikeda
    [nickname] => BobNick
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => BobPreferred
    [profile] => http://www.underland.com/bob
    [updated_at] => 2147483647
    [website] => http://www.underland.com
    [zoneinfo] => France/Paris
)


08-12 13:46:16  DEBUG userinfo response = {"sub":"2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143","birthdate":"2111-11-11","email":"bob@underland.com","email_verified":true,"family_name":"Ikeda","gender":"male","given_name":"Bob","locale":"fr","middle_name":null,"name":"Bob Ikeda","nickname":"BobNick","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"BobPreferred","profile":"http:\/\/www.underland.com\/bob","updated_at":"2147483647","website":"http:\/\/www.underland.com","zoneinfo":"France\/Paris"}

==============================================================================
08-12 13:47:06  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5981039
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5981039","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 13:47:06  DEBUG prompt = 

08-12 13:47:06  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 13:47:11  DEBUG Request: Array
(
    [username] => bob
    [password] => underland
)

Input: username=bob&password=underland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5981039
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5981039
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5981039"} []
----------------------------------------------------------

08-12 13:47:11  DEBUG Auth_time = 1439380031

08-12 13:47:11  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 13:47:11  DEBUG prompt = 

08-12 13:47:11  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5981039
)
 scopes = profile openid email

08-12 13:47:11  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:47:11  DEBUG id_token claims = Array
(
)


08-12 13:47:11  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:47:11  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:47:11  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 13:47:12  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5981039
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5981039
        )

    [login] => 1
    [username] => bob
    [persist] => 
    [auth_time] => 1439380031
    [ops] => 1e6163b2798fe8cf3a107ab558bb4fbb
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 13:47:13  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5981039
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439380031
)
 scopes = profile openid email

08-12 13:47:13  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:47:13  DEBUG id_token claims = Array
(
)


08-12 13:47:13  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:47:13  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:47:13  DEBUG ss = sha256(spardecohttps://localhost1e6163b2798fe8cf3a107ab558bb4fbbf159ca6a69af27c511b1e35627aae818).f159ca6a69af27c511b1e35627aae818

==============================================================================
08-12 13:47:13  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => tEFVaYUzeWcfzAFjqnkcvTEC6F6TEYaLDVxVvvVTZ0E
    [state] => 5981039
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=tEFVaYUzeWcfzAFjqnkcvTEC6F6TEYaLDVxVvvVTZ0E&state=5981039&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:47:13  DEBUG spardeco
client_secret_post

08-12 13:47:13  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 13:47:13  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 13:47:13  DEBUG requested idtoken claims = Array
(
)


08-12 13:47:13  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 13:47:13  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439380333
    [iat] => 1439380033
    [at_hash] => QjRWhC-UBLitsP0UdRUruQ
)


08-12 13:47:13  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 13:47:13  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwMzMzLCJpYXQiOjE0MzkzODAwMzMsImF0X2hhc2giOiJRalJXaEMtVUJMaXRzUDBVZFJVcnVRIn0.Cj6lnxb8oyqbj1X0OO42prtKTPY6iiNqEoxZDMT_VFvHxYS3zmbsvMm4skGI6mIkstTAllefzg-E7kSRKVvrq1P1M0Y04Oxaq2mpu84JLrqpZJecv4URaznTu1wspan1X62kKCJxAy9DF7mOW1_pHGTs6E2tG5meqsv0SY_Tp6inB7KZm1cjkWRfS4aWl7YaWayCpP_Dwous6niKIkj4O2L5PrPwHtGH8lT-APfGusFjAC68Kv_H2pOPTgT0_q_kfi9o34nEcnWwawZujdAzqDJjF-z8nzmfjnYpyP4u94c5ZRCBZ646x-AeZ3MUv87upG1YYCPmjhA4x_DmP-DcuA

08-12 13:47:13  DEBUG token response = Array
(
    [access_token] => 9BcouX0KCEmYZwNw-_swQNX_enqJvBfgiCZMXE7zi1c
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwMzMzLCJpYXQiOjE0MzkzODAwMzMsImF0X2hhc2giOiJRalJXaEMtVUJMaXRzUDBVZFJVcnVRIn0.Cj6lnxb8oyqbj1X0OO42prtKTPY6iiNqEoxZDMT_VFvHxYS3zmbsvMm4skGI6mIkstTAllefzg-E7kSRKVvrq1P1M0Y04Oxaq2mpu84JLrqpZJecv4URaznTu1wspan1X62kKCJxAy9DF7mOW1_pHGTs6E2tG5meqsv0SY_Tp6inB7KZm1cjkWRfS4aWl7YaWayCpP_Dwous6niKIkj4O2L5PrPwHtGH8lT-APfGusFjAC68Kv_H2pOPTgT0_q_kfi9o34nEcnWwawZujdAzqDJjF-z8nzmfjnYpyP4u94c5ZRCBZ646x-AeZ3MUv87upG1YYCPmjhA4x_DmP-DcuA
)


==============================================================================
08-12 13:47:13  DEBUG Request: Array
(
    [access_token] => 9BcouX0KCEmYZwNw-_swQNX_enqJvBfgiCZMXE7zi1c
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=9BcouX0KCEmYZwNw-_swQNX_enqJvBfgiCZMXE7zi1c","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:47:13  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 13:47:13  DEBUG wrapped &1vv'
CC unwrapped = 1:bob

08-12 13:47:13  DEBUG userid = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143  unwrapped = bob

08-12 13:47:13  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5981039
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439380031
)
 scopes = profile openid email

08-12 13:47:13  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:47:13  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:47:13  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:47:13  DEBUG returning = Array
(
    [birthdate] => 2111-11-11
    [email] => bob@underland.com
    [email_verified] => 1
    [family_name] => Ikeda
    [gender] => male
    [given_name] => Bob
    [locale] => fr
    [middle_name] => 
    [name] => Bob Ikeda
    [nickname] => BobNick
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => BobPreferred
    [profile] => http://www.underland.com/bob
    [updated_at] => 2147483647
    [website] => http://www.underland.com
    [zoneinfo] => France/Paris
)


08-12 13:47:13  DEBUG userinfo response = {"sub":"2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143","birthdate":"2111-11-11","email":"bob@underland.com","email_verified":true,"family_name":"Ikeda","gender":"male","given_name":"Bob","locale":"fr","middle_name":null,"name":"Bob Ikeda","nickname":"BobNick","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"BobPreferred","profile":"http:\/\/www.underland.com\/bob","updated_at":"2147483647","website":"http:\/\/www.underland.com","zoneinfo":"France\/Paris"}

==============================================================================
08-12 13:48:27  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1239193
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1239193","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 13:48:27  DEBUG prompt = 

08-12 13:48:27  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 13:48:31  DEBUG Request: Array
(
    [username] => bob
    [password] => underland
)

Input: username=bob&password=underland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1239193
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1239193
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1239193"} []
----------------------------------------------------------

08-12 13:48:31  DEBUG Auth_time = 1439380111

08-12 13:48:31  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 13:48:31  DEBUG prompt = 

08-12 13:48:31  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1239193
)
 scopes = profile openid email

08-12 13:48:31  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:48:31  DEBUG id_token claims = Array
(
)


08-12 13:48:31  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:48:31  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:48:31  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 13:48:32  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1239193
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1239193
        )

    [login] => 1
    [username] => bob
    [persist] => 
    [auth_time] => 1439380111
    [ops] => 70b01e6478254bbd91f13b31a3310e6c
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 13:48:32  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1239193
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439380111
)
 scopes = profile openid email

08-12 13:48:32  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:48:32  DEBUG id_token claims = Array
(
)


08-12 13:48:32  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:48:32  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:48:32  DEBUG ss = sha256(spardecohttps://localhost70b01e6478254bbd91f13b31a3310e6caa70a7fccbcd49568c3c88e015d30ffe).aa70a7fccbcd49568c3c88e015d30ffe

==============================================================================
08-12 13:48:32  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => UrKHbItgwIYxE9eHfZVuV4JokZUk0UmLBKIwnnEw6zY
    [state] => 1239193
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=UrKHbItgwIYxE9eHfZVuV4JokZUk0UmLBKIwnnEw6zY&state=1239193&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:48:32  DEBUG spardeco
client_secret_post

08-12 13:48:32  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 13:48:32  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 13:48:32  DEBUG requested idtoken claims = Array
(
)


08-12 13:48:32  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 13:48:32  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439380412
    [iat] => 1439380112
    [at_hash] => 7kAPceo9Wu6KaRsW5JPobA
)


08-12 13:48:32  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 13:48:32  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwNDEyLCJpYXQiOjE0MzkzODAxMTIsImF0X2hhc2giOiI3a0FQY2VvOVd1NkthUnNXNUpQb2JBIn0.iXKJw7M8O4YQSjWVRax718IMh2GuuN85IGlKYl8MnrYxsChl0UxD3xCK83VF3hZbRcuD2VE0DrAI_oRjkIr09nJRmqPvtkkyKjzCguRsuFo-xCzmEwlDyzPQEQ2_b85tZfL83CIjO3vPuiV5BOxVdU4G0goc_qLITl9WwvpngParSUx6lWcOjM52FkNsm25GEJ4Myr3gCAnfTKf7VY0ET-orVvn4UZ_G_soIV0UALRK1ztcuFbEsCdskCIAL3U0nADWZ0_RK3wKwrDsvK1IhAJRQj-OqCayBLGls7dqEVEHClx_i4GUHgxRixmjlsp1FQeHkNmTpVC8ffyS1dmEVWA

08-12 13:48:32  DEBUG token response = Array
(
    [access_token] => 8OG3Nb0ozWhHwYWwAaMW2Ap_Cz-V5arFyjTl1thpwTo
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwNDEyLCJpYXQiOjE0MzkzODAxMTIsImF0X2hhc2giOiI3a0FQY2VvOVd1NkthUnNXNUpQb2JBIn0.iXKJw7M8O4YQSjWVRax718IMh2GuuN85IGlKYl8MnrYxsChl0UxD3xCK83VF3hZbRcuD2VE0DrAI_oRjkIr09nJRmqPvtkkyKjzCguRsuFo-xCzmEwlDyzPQEQ2_b85tZfL83CIjO3vPuiV5BOxVdU4G0goc_qLITl9WwvpngParSUx6lWcOjM52FkNsm25GEJ4Myr3gCAnfTKf7VY0ET-orVvn4UZ_G_soIV0UALRK1ztcuFbEsCdskCIAL3U0nADWZ0_RK3wKwrDsvK1IhAJRQj-OqCayBLGls7dqEVEHClx_i4GUHgxRixmjlsp1FQeHkNmTpVC8ffyS1dmEVWA
)


==============================================================================
08-12 13:48:33  DEBUG Request: Array
(
    [access_token] => 8OG3Nb0ozWhHwYWwAaMW2Ap_Cz-V5arFyjTl1thpwTo
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=8OG3Nb0ozWhHwYWwAaMW2Ap_Cz-V5arFyjTl1thpwTo","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:48:33  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 13:48:33  DEBUG wrapped &1vv'
CC unwrapped = 1:bob

08-12 13:48:33  DEBUG userid = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143  unwrapped = bob

08-12 13:48:33  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1239193
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439380111
)
 scopes = profile openid email

08-12 13:48:33  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:48:33  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:48:33  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:48:33  DEBUG returning = Array
(
    [birthdate] => 2111-11-11
    [email] => bob@underland.com
    [email_verified] => 1
    [family_name] => Ikeda
    [gender] => male
    [given_name] => Bob
    [locale] => fr
    [middle_name] => 
    [name] => Bob Ikeda
    [nickname] => BobNick
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => BobPreferred
    [profile] => http://www.underland.com/bob
    [updated_at] => 2147483647
    [website] => http://www.underland.com
    [zoneinfo] => France/Paris
)


08-12 13:48:33  DEBUG userinfo response = {"sub":"2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143","birthdate":"2111-11-11","email":"bob@underland.com","email_verified":true,"family_name":"Ikeda","gender":"male","given_name":"Bob","locale":"fr","middle_name":null,"name":"Bob Ikeda","nickname":"BobNick","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"BobPreferred","profile":"http:\/\/www.underland.com\/bob","updated_at":"2147483647","website":"http:\/\/www.underland.com","zoneinfo":"France\/Paris"}

==============================================================================
08-12 13:48:54  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3764661
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3764661","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 13:48:54  DEBUG prompt = 

08-12 13:48:54  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 13:48:58  DEBUG Request: Array
(
    [username] => bob
    [password] => underland
)

Input: username=bob&password=underland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3764661
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3764661
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3764661"} []
----------------------------------------------------------

08-12 13:48:58  DEBUG Auth_time = 1439380138

08-12 13:48:58  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 13:48:58  DEBUG prompt = 

08-12 13:48:58  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3764661
)
 scopes = profile openid email

08-12 13:48:58  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:48:58  DEBUG id_token claims = Array
(
)


08-12 13:48:58  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:48:58  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:48:58  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 13:49:00  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3764661
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3764661
        )

    [login] => 1
    [username] => bob
    [persist] => 
    [auth_time] => 1439380138
    [ops] => 1033c22044a2432e9cf4cb97c38b6ffb
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 13:49:00  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3764661
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439380138
)
 scopes = profile openid email

08-12 13:49:00  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:49:00  DEBUG id_token claims = Array
(
)


08-12 13:49:00  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:49:00  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:49:00  DEBUG ss = sha256(spardecohttps://localhost1033c22044a2432e9cf4cb97c38b6ffb4b60d303383aa1575a14c56f62ef7b97).4b60d303383aa1575a14c56f62ef7b97

==============================================================================
08-12 13:49:00  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => zTr_LM2c8LL1CvQj3-A8s3tRekcqhxu0tvV14dzaNM0
    [state] => 3764661
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=zTr_LM2c8LL1CvQj3-A8s3tRekcqhxu0tvV14dzaNM0&state=3764661&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:49:00  DEBUG spardeco
client_secret_post

08-12 13:49:00  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 13:49:01  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 13:49:01  DEBUG requested idtoken claims = Array
(
)


08-12 13:49:01  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 13:49:01  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439380441
    [iat] => 1439380141
    [at_hash] => sl-7HJlS1_iaTKMhDT-bEg
)


08-12 13:49:01  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 13:49:01  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwNDQxLCJpYXQiOjE0MzkzODAxNDEsImF0X2hhc2giOiJzbC03SEpsUzFfaWFUS01oRFQtYkVnIn0.Do8Y25uJebIttrIfsFxKBf9GhdwGRjhY4vx5QO2pfo3Yli5cfGg1NEF1xDS_X91G3q_cXrUHGia9IZH_w2d0bzF1HsQ_vZGV7aupdbd2YRxnZlz9FI_ca0swg2LSSkX29pNAhB8hscCJyEAQzLpW4Hl657gcHblcLdixUKGvkGxhnPDz9MAWxILXC4s-gVTD8lOdHgreZ0YWV2mup3S-inlm20sg2HYClfI7wQ3fG5A_JJpf2XHXoKpDp2LKJ4CkWPzOMNReargY6G7qiA5yCvcTx5gFhZwRMkRdvvA9Kx7mard5Z4cmAkr93YphfHwU00wdNoyinZGMpjVjEn07OA

08-12 13:49:01  DEBUG token response = Array
(
    [access_token] => Zqe12igGvsN9ofRXWJohz6L_HZ9FLYlyt1fUAAwH54o
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6IjI2MDVhYmYxOGUzMTFlNzZkZTBiODdiYWM0YWQxNmRjNzYyNzlhMGExYzAyNDMwMWUzOTlmNTBiOGFjM2QxNDMiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwNDQxLCJpYXQiOjE0MzkzODAxNDEsImF0X2hhc2giOiJzbC03SEpsUzFfaWFUS01oRFQtYkVnIn0.Do8Y25uJebIttrIfsFxKBf9GhdwGRjhY4vx5QO2pfo3Yli5cfGg1NEF1xDS_X91G3q_cXrUHGia9IZH_w2d0bzF1HsQ_vZGV7aupdbd2YRxnZlz9FI_ca0swg2LSSkX29pNAhB8hscCJyEAQzLpW4Hl657gcHblcLdixUKGvkGxhnPDz9MAWxILXC4s-gVTD8lOdHgreZ0YWV2mup3S-inlm20sg2HYClfI7wQ3fG5A_JJpf2XHXoKpDp2LKJ4CkWPzOMNReargY6G7qiA5yCvcTx5gFhZwRMkRdvvA9Kx7mard5Z4cmAkr93YphfHwU00wdNoyinZGMpjVjEn07OA
)


==============================================================================
08-12 13:49:01  DEBUG Request: Array
(
    [access_token] => Zqe12igGvsN9ofRXWJohz6L_HZ9FLYlyt1fUAAwH54o
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=Zqe12igGvsN9ofRXWJohz6L_HZ9FLYlyt1fUAAwH54o","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:49:01  DEBUG user id bob wrapped = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143

08-12 13:49:01  DEBUG wrapped &1vv'
CC unwrapped = 1:bob

08-12 13:49:01  DEBUG userid = 2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143  unwrapped = bob

08-12 13:49:01  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3764661
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439380138
)
 scopes = profile openid email

08-12 13:49:01  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:49:01  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:49:01  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:49:01  DEBUG returning = Array
(
    [birthdate] => 2111-11-11
    [email] => bob@underland.com
    [email_verified] => 1
    [family_name] => Ikeda
    [gender] => male
    [given_name] => Bob
    [locale] => fr
    [middle_name] => 
    [name] => Bob Ikeda
    [nickname] => BobNick
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => BobPreferred
    [profile] => http://www.underland.com/bob
    [updated_at] => 2147483647
    [website] => http://www.underland.com
    [zoneinfo] => France/Paris
)


08-12 13:49:01  DEBUG userinfo response = {"sub":"2605abf18e311e76de0b87bac4ad16dc76279a0a1c024301e399f50b8ac3d143","birthdate":"2111-11-11","email":"bob@underland.com","email_verified":true,"family_name":"Ikeda","gender":"male","given_name":"Bob","locale":"fr","middle_name":null,"name":"Bob Ikeda","nickname":"BobNick","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"BobPreferred","profile":"http:\/\/www.underland.com\/bob","updated_at":"2147483647","website":"http:\/\/www.underland.com","zoneinfo":"France\/Paris"}

==============================================================================
08-12 13:49:52  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2151264
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2151264","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 13:49:52  DEBUG prompt = 

08-12 13:49:52  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 13:49:54  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2151264
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2151264
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2151264"} []
----------------------------------------------------------

08-12 13:49:54  DEBUG Auth_time = 1439380194

08-12 13:49:54  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 13:49:54  DEBUG prompt = 

08-12 13:49:54  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2151264
)
 scopes = profile openid email

08-12 13:49:54  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:49:54  DEBUG id_token claims = Array
(
)


08-12 13:49:54  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:49:54  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:49:54  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 13:49:55  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2151264
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2151264
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439380194
    [ops] => 7215aed68fdd631051d892e6e557fee6
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 13:49:55  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2151264
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439380194
)
 scopes = profile openid email

08-12 13:49:55  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:49:55  DEBUG id_token claims = Array
(
)


08-12 13:49:55  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 13:49:55  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:49:55  DEBUG ss = sha256(spardecohttps://localhost7215aed68fdd631051d892e6e557fee6850bf0a41ae49479737c81b917f39a4a).850bf0a41ae49479737c81b917f39a4a

==============================================================================
08-12 13:49:56  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => lUDo9MU6ifqXLE7amDz2C7ahFmGjCqRBCQl1JCe4ZHY
    [state] => 2151264
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=lUDo9MU6ifqXLE7amDz2C7ahFmGjCqRBCQl1JCe4ZHY&state=2151264&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:49:56  DEBUG spardeco
client_secret_post

08-12 13:49:56  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 13:49:56  DEBUG no ops in sessionid kor8rvciua265b7fk7pspehpu1

08-12 13:49:56  DEBUG requested idtoken claims = Array
(
)


08-12 13:49:56  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 13:49:56  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439380496
    [iat] => 1439380196
    [at_hash] => l0h7WoNxstSHaeFHpOIe5g
)


08-12 13:49:56  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 13:49:56  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwNDk2LCJpYXQiOjE0MzkzODAxOTYsImF0X2hhc2giOiJsMGg3V29OeHN0U0hhZUZIcE9JZTVnIn0.IadJHC2WDQ0b-kSZOnihkQ8P1FaZ3Kj18uCht1BqUP2SGRYK_4uRiYA5AfrfCzZ-r-QJ5J9-N-_bRJlbDMkLrz_MbgoO6di9T7jk9ZD6ja6h9W1UYpUXF_BRRZwKNSiN9rUxAMlsHIqaN0AVKAjzT4y44670mMPnmWjpG6LH3VjrrhGtbk_AJ1GJjvs5y-DwRioYJfYr_3bYpmeB4KDP08keIt53DrMUnQu3QIIRxxo7WPp9Qokk3sjx1JGsnFxKL9Wf8QAft46cCflfVFWeyDYkCIlVhbXBqZa8E2_jIKJ7dcXJbZAIiW6pS7L-3w4VZmIv65TNv4p_HLxg2HAjDA

08-12 13:49:56  DEBUG token response = Array
(
    [access_token] => Cskp7OYd7QmEakonoJhvpu1sGYnX9SjtysSeOZyBBWs
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzgwNDk2LCJpYXQiOjE0MzkzODAxOTYsImF0X2hhc2giOiJsMGg3V29OeHN0U0hhZUZIcE9JZTVnIn0.IadJHC2WDQ0b-kSZOnihkQ8P1FaZ3Kj18uCht1BqUP2SGRYK_4uRiYA5AfrfCzZ-r-QJ5J9-N-_bRJlbDMkLrz_MbgoO6di9T7jk9ZD6ja6h9W1UYpUXF_BRRZwKNSiN9rUxAMlsHIqaN0AVKAjzT4y44670mMPnmWjpG6LH3VjrrhGtbk_AJ1GJjvs5y-DwRioYJfYr_3bYpmeB4KDP08keIt53DrMUnQu3QIIRxxo7WPp9Qokk3sjx1JGsnFxKL9Wf8QAft46cCflfVFWeyDYkCIlVhbXBqZa8E2_jIKJ7dcXJbZAIiW6pS7L-3w4VZmIv65TNv4p_HLxg2HAjDA
)


==============================================================================
08-12 13:49:56  DEBUG Request: Array
(
    [access_token] => Cskp7OYd7QmEakonoJhvpu1sGYnX9SjtysSeOZyBBWs
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=Cskp7OYd7QmEakonoJhvpu1sGYnX9SjtysSeOZyBBWs","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 13:49:56  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 13:49:56  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 13:49:56  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 13:49:56  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2151264
    [session_id] => kor8rvciua265b7fk7pspehpu1
    [auth_time] => 1439380194
)
 scopes = profile openid email

08-12 13:49:56  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:49:56  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 13:49:56  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 13:49:56  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 13:49:56  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 14:54:14  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => 
    [state] => 9768388
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=&state=9768388","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 14:54:14  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 14:54:14  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_scope desc:no openid scope uri: state:9768388 code:400

==============================================================================
08-12 14:55:51  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1345396
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1345396","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 14:55:51  DEBUG prompt = 

08-12 14:55:51  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 14:57:47  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 14:57:47  DEBUG prompt = 

08-12 14:57:47  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 14:59:25  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 14:59:25  DEBUG Auth_time = 1439384365

08-12 14:59:25  DEBUG session id = d4c0n7fn2nvj4cnupgsr28os41

08-12 14:59:25  DEBUG prompt = 

08-12 14:59:25  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
)
 scopes = profile openid email

08-12 14:59:25  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 14:59:25  DEBUG id_token claims = Array
(
)


08-12 14:59:25  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 14:59:25  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 14:59:25  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:00:08  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1345396
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1345396
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1345396"} []
----------------------------------------------------------

08-12 15:00:08  DEBUG Auth_time = 1439384408

08-12 15:00:08  DEBUG session id = kor8rvciua265b7fk7pspehpu1

08-12 15:00:08  DEBUG prompt = 

08-12 15:00:08  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1345396
)
 scopes = profile openid email

08-12 15:00:08  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:00:08  DEBUG id_token claims = Array
(
)


08-12 15:00:08  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:00:08  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:00:08  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:01:05  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1345396
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1345396
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1345396
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384408
    [ops] => f3a6c9c07ae4a1e07f9ffe0552c3f390
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1345396","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:01:05  DEBUG prompt = 

08-12 15:01:05  DEBUG num prompt = 0 Array
(
)


08-12 15:01:05  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1345396
)
 scopes = profile openid email

08-12 15:01:05  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:01:05  DEBUG id_token claims = Array
(
)


08-12 15:01:05  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:01:05  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:01:05  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:01:37  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384365
    [ops] => 45898c9c493c16a9896476c22013ba57
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:01:37  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 15:01:37  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_request desc:no nonce uri: state: code:400

==============================================================================
08-12 15:03:47  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => id_token
    [state] => 8067340
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1345396
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1345396
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384408
    [ops] => f3a6c9c07ae4a1e07f9ffe0552c3f390
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=id_token&state=8067340","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:03:48  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 15:03:48  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_scope desc:no openid scope uri: state:8067340 code:400

==============================================================================
08-12 15:04:18  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1982612
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1345396
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1345396
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384408
    [ops] => f3a6c9c07ae4a1e07f9ffe0552c3f390
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=1982612","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:04:18  DEBUG prompt = 

08-12 15:04:18  DEBUG num prompt = 0 Array
(
)


08-12 15:04:18  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1982612
)
 scopes = openid id_token

08-12 15:04:18  DEBUG userinfo claims = Array
(
)


08-12 15:04:18  DEBUG id_token claims = Array
(
)


08-12 15:04:18  DEBUG unique keys = Array
(
)


08-12 15:04:18  DEBUG requested_claims = Array
(
)


08-12 15:04:18  INFO requested claims = Array
(
)


==============================================================================
08-12 15:04:39  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 5465336
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=5465336","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:04:39  DEBUG prompt = 

08-12 15:04:39  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:04:42  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 5465336
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 5465336
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=5465336"} []
----------------------------------------------------------

08-12 15:04:42  DEBUG Auth_time = 1439384682

08-12 15:04:42  DEBUG session id = 1v2ushnu7vd1b4airf3c8nape6

08-12 15:04:42  DEBUG prompt = 

08-12 15:04:42  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 5465336
)
 scopes = openid id_token

08-12 15:04:42  DEBUG userinfo claims = Array
(
)


08-12 15:04:42  DEBUG id_token claims = Array
(
)


08-12 15:04:42  DEBUG unique keys = Array
(
)


08-12 15:04:42  DEBUG requested_claims = Array
(
)


08-12 15:04:42  INFO requested claims = Array
(
)


==============================================================================
08-12 15:04:55  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 5465336
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 5465336
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384682
    [ops] => 72e6e38eaf1833beafd1ed26bbdeb542
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:04:55  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 5465336
    [session_id] => 1v2ushnu7vd1b4airf3c8nape6
    [auth_time] => 1439384682
)
 scopes = openid id_token

08-12 15:04:55  DEBUG userinfo claims = Array
(
)


08-12 15:04:55  DEBUG id_token claims = Array
(
)


08-12 15:04:55  DEBUG unique keys = Array
(
)


08-12 15:04:55  DEBUG requested_claims = Array
(
)


08-12 15:04:55  DEBUG ss = sha256(spardecohttps://localhost72e6e38eaf1833beafd1ed26bbdeb5422c5259b68252982c078b3c9233b1677c).2c5259b68252982c078b3c9233b1677c

==============================================================================
08-12 15:04:56  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => HToISOEd1SxCurMpRwK6yu8w26gp4RwKASycdUvE3ic
    [state] => 5465336
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=HToISOEd1SxCurMpRwK6yu8w26gp4RwKASycdUvE3ic&state=5465336&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:04:56  DEBUG spardeco
client_secret_post

08-12 15:04:56  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 15:04:56  DEBUG no ops in sessionid 1v2ushnu7vd1b4airf3c8nape6

08-12 15:04:56  DEBUG requested idtoken claims = Array
(
)


08-12 15:04:56  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:04:56  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439384996
    [iat] => 1439384696
    [at_hash] => QcnE_dCPVPp6oGYkek2jXw
)


08-12 15:04:56  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:04:56  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg0OTk2LCJpYXQiOjE0MzkzODQ2OTYsImF0X2hhc2giOiJRY25FX2RDUFZQcDZvR1lrZWsyalh3In0.ngX86QDsTV3lSJow_l8Qf4vmxGYP6V9z27tgDm4GIzw5P4uUcf9Ts_tsBgNwoJ-SdAlQM_3nBoPI_6ueNb20krRfPmEyt3EPz16Fbs803-Fam1HYk3RR0IINOKWk5j0U-3M831kGkZ9sua_vI4Pkcw_7SxfSnSfFaiDJz9I04xIlMSUs5zuu974H7_kv3XfjUKceLzaOdisupCmBjwHm09LxuRMhjHfByfgtmPDrzNifKWDfnfYfJTe2anMLy80lTtbL4ATNemhB5VWCIHEbnmHVql5fw10E9BtoJPnfKQ1kbgfpnTLdef3Xi4ES_uL-iMsHV8KIwN0LikQj92EaVw

08-12 15:04:56  DEBUG token response = Array
(
    [access_token] => fibhE47Z5QoBv-vz6gSOMfXxTbTGPY3-h5x5HBywGOM
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg0OTk2LCJpYXQiOjE0MzkzODQ2OTYsImF0X2hhc2giOiJRY25FX2RDUFZQcDZvR1lrZWsyalh3In0.ngX86QDsTV3lSJow_l8Qf4vmxGYP6V9z27tgDm4GIzw5P4uUcf9Ts_tsBgNwoJ-SdAlQM_3nBoPI_6ueNb20krRfPmEyt3EPz16Fbs803-Fam1HYk3RR0IINOKWk5j0U-3M831kGkZ9sua_vI4Pkcw_7SxfSnSfFaiDJz9I04xIlMSUs5zuu974H7_kv3XfjUKceLzaOdisupCmBjwHm09LxuRMhjHfByfgtmPDrzNifKWDfnfYfJTe2anMLy80lTtbL4ATNemhB5VWCIHEbnmHVql5fw10E9BtoJPnfKQ1kbgfpnTLdef3Xi4ES_uL-iMsHV8KIwN0LikQj92EaVw
)


==============================================================================
08-12 15:04:56  DEBUG Request: Array
(
    [access_token] => fibhE47Z5QoBv-vz6gSOMfXxTbTGPY3-h5x5HBywGOM
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=fibhE47Z5QoBv-vz6gSOMfXxTbTGPY3-h5x5HBywGOM","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:04:56  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:04:56  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 15:04:56  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 15:04:56  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 5465336
    [session_id] => 1v2ushnu7vd1b4airf3c8nape6
    [auth_time] => 1439384682
)
 scopes = openid id_token

08-12 15:04:56  DEBUG ALLOWED CLAIMS = Array
(
)


08-12 15:04:56  DEBUG REQUESTED_USER_INFO = Array
(
)


08-12 15:04:56  DEBUG account requested claims = Array
(
)


08-12 15:04:56  DEBUG returning = Array
(
)


08-12 15:04:56  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6"}

==============================================================================
08-12 15:05:01  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 5465336
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=5465336","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:05:01  DEBUG prompt = 

08-12 15:05:01  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:05:04  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 5465336
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 5465336
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=5465336"} []
----------------------------------------------------------

08-12 15:05:04  DEBUG Auth_time = 1439384704

08-12 15:05:04  DEBUG session id = 1v2ushnu7vd1b4airf3c8nape6

08-12 15:05:04  DEBUG prompt = 

08-12 15:05:04  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 5465336
)
 scopes = openid id_token

08-12 15:05:04  DEBUG userinfo claims = Array
(
)


08-12 15:05:04  DEBUG id_token claims = Array
(
)


08-12 15:05:04  DEBUG unique keys = Array
(
)


08-12 15:05:04  DEBUG requested_claims = Array
(
)


08-12 15:05:04  INFO requested claims = Array
(
)


==============================================================================
08-12 15:05:14  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 5465336
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 5465336
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 5465336
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384704
    [ops] => 0a413dd933147222324d591cf469f316
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=5465336","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:05:14  DEBUG prompt = 

08-12 15:05:14  DEBUG num prompt = 0 Array
(
)


08-12 15:05:14  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 5465336
)
 scopes = openid id_token

08-12 15:05:14  DEBUG userinfo claims = Array
(
)


08-12 15:05:14  DEBUG id_token claims = Array
(
)


08-12 15:05:14  DEBUG unique keys = Array
(
)


08-12 15:05:14  DEBUG requested_claims = Array
(
)


08-12 15:05:14  INFO requested claims = Array
(
)


==============================================================================
08-12 15:05:22  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6847683
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 5465336
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 5465336
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384704
    [ops] => 0a413dd933147222324d591cf469f316
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=6847683","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:05:22  DEBUG prompt = 

08-12 15:05:22  DEBUG num prompt = 0 Array
(
)


08-12 15:05:22  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6847683
)
 scopes = openid

08-12 15:05:22  DEBUG userinfo claims = Array
(
)


08-12 15:05:22  DEBUG id_token claims = Array
(
)


08-12 15:05:22  DEBUG unique keys = Array
(
)


08-12 15:05:22  DEBUG requested_claims = Array
(
)


08-12 15:05:22  INFO requested claims = Array
(
)


==============================================================================
08-12 15:05:38  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 4542639
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6847683
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6847683
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384704
    [ops] => 0a413dd933147222324d591cf469f316
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=4542639","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:05:38  DEBUG prompt = 

08-12 15:05:38  DEBUG num prompt = 0 Array
(
)


08-12 15:05:38  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 4542639
)
 scopes = openid

08-12 15:05:38  DEBUG userinfo claims = Array
(
)


08-12 15:05:38  DEBUG id_token claims = Array
(
)


08-12 15:05:38  DEBUG unique keys = Array
(
)


08-12 15:05:38  DEBUG requested_claims = Array
(
)


08-12 15:05:38  INFO requested claims = Array
(
)


==============================================================================
08-12 15:08:30  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1982612
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1982612
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1982612
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384408
    [ops] => f3a6c9c07ae4a1e07f9ffe0552c3f390
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=1982612","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:08:31  DEBUG prompt = 

08-12 15:08:31  DEBUG num prompt = 0 Array
(
)


08-12 15:08:31  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1982612
)
 scopes = openid id_token

08-12 15:08:31  DEBUG userinfo claims = Array
(
)


08-12 15:08:31  DEBUG id_token claims = Array
(
)


08-12 15:08:31  DEBUG unique keys = Array
(
)


08-12 15:08:31  DEBUG requested_claims = Array
(
)


08-12 15:08:31  INFO requested claims = Array
(
)


==============================================================================
08-12 15:08:42  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1982612
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1982612
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1982612
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384408
    [ops] => f3a6c9c07ae4a1e07f9ffe0552c3f390
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=1982612","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:08:42  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 15:08:42  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_request desc:no nonce uri: state:1982612 code:400

==============================================================================
08-12 15:08:54  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1982612
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1982612
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1982612
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384408
    [ops] => f3a6c9c07ae4a1e07f9ffe0552c3f390
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=1982612","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:08:54  DEBUG prompt = 

08-12 15:08:54  DEBUG num prompt = 0 Array
(
)


08-12 15:08:54  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1982612
)
 scopes = openid id_token

08-12 15:08:54  DEBUG userinfo claims = Array
(
)


08-12 15:08:54  DEBUG id_token claims = Array
(
)


08-12 15:08:54  DEBUG unique keys = Array
(
)


08-12 15:08:54  DEBUG requested_claims = Array
(
)


08-12 15:08:54  INFO requested claims = Array
(
)


==============================================================================
08-12 15:09:03  DEBUG Request: req[ ]
Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1982612
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1982612
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384408
    [ops] => f3a6c9c07ae4a1e07f9ffe0552c3f390
)
 
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-12 15:09:03  DEBUG Request: [ ]
Input:  
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-12 15:11:02  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2512492
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 4542639
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 4542639
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384704
    [ops] => 0a413dd933147222324d591cf469f316
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2512492","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:11:02  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 15:11:02  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_request desc:no nonce uri: state:2512492 code:400

==============================================================================
08-12 15:11:14  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9271939
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9271939","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:11:14  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 15:11:14  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_request desc:no nonce uri: state:9271939 code:400

==============================================================================
08-12 15:11:45  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384365
    [ops] => 45898c9c493c16a9896476c22013ba57
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:11:45  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 15:11:45  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_request desc:no nonce uri: state: code:400

==============================================================================
08-12 15:12:09  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => id_token
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384365
    [ops] => 45898c9c493c16a9896476c22013ba57
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=id_token","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:12:09  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 15:12:09  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_scope desc:no openid scope uri: state: code:400

==============================================================================
08-12 15:12:30  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => id_token openid
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384365
    [ops] => 45898c9c493c16a9896476c22013ba57
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=id_token%20openid","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:12:30  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 15:12:30  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_request desc:no nonce uri: state: code:400

==============================================================================
08-12 15:13:02  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1982612
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1982612
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1982612
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384408
    [ops] => f3a6c9c07ae4a1e07f9ffe0552c3f390
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=1982612","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:13:02  DEBUG prompt = 

08-12 15:13:02  DEBUG num prompt = 0 Array
(
)


08-12 15:13:02  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1982612
)
 scopes = openid id_token

08-12 15:13:02  DEBUG userinfo claims = Array
(
)


08-12 15:13:02  DEBUG id_token claims = Array
(
)


08-12 15:13:02  DEBUG unique keys = Array
(
)


08-12 15:13:02  DEBUG requested_claims = Array
(
)


08-12 15:13:02  INFO requested claims = Array
(
)


==============================================================================
08-12 15:13:04  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2151264
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1982612
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1982612
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384408
    [ops] => f3a6c9c07ae4a1e07f9ffe0552c3f390
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2151264","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:13:04  DEBUG prompt = 

08-12 15:13:04  DEBUG num prompt = 0 Array
(
)


08-12 15:13:04  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2151264
)
 scopes = profile openid email

08-12 15:13:04  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:13:04  DEBUG id_token claims = Array
(
)


08-12 15:13:04  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:13:04  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:13:04  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:13:53  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => id_token openid
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439384365
    [ops] => 45898c9c493c16a9896476c22013ba57
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=id_token%20openid&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:13:53  DEBUG prompt = 

08-12 15:13:53  DEBUG num prompt = 0 Array
(
)


08-12 15:13:53  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => id_token openid
    [nonce] => spardeco
)
 scopes = id_token openid

08-12 15:13:53  DEBUG userinfo claims = Array
(
)


08-12 15:13:53  DEBUG id_token claims = Array
(
)


08-12 15:13:53  DEBUG unique keys = Array
(
)


08-12 15:13:53  DEBUG requested_claims = Array
(
)


08-12 15:13:53  INFO requested claims = Array
(
)


==============================================================================
08-12 15:14:11  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9137859
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9137859","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:14:11  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 15:14:11  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_request desc:no nonce uri: state:9137859 code:400

==============================================================================
08-12 15:14:43  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1923473
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1923473&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:14:43  DEBUG prompt = 

08-12 15:14:43  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:14:51  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1923473
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1923473
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1923473&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:14:51  DEBUG Auth_time = 1439385291

08-12 15:14:51  DEBUG session id = 2ot36se1neombsmru8jv7m00m6

08-12 15:14:51  DEBUG prompt = 

08-12 15:14:51  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1923473
    [nonce] => spardeco
)
 scopes = profile openid email

08-12 15:14:51  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:14:51  DEBUG id_token claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [name_ja_kana_jp] => 0
    [name_ja_hani_jp] => 0
    [given_name] => 0
    [given_name_ja_kana_jp] => 0
    [given_name_ja_hani_jp] => 0
    [family_name] => 0
    [family_name_ja_kana_jp] => 0
    [family_name_ja_hani_jp] => 0
    [middle_name] => 0
    [middle_name_ja_kana_jp] => 0
    [middle_name_ja_hani_jp] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:14:51  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => family_name_ja_hani_jp
    [5] => family_name_ja_kana_jp
    [6] => gender
    [7] => given_name
    [8] => given_name_ja_hani_jp
    [9] => given_name_ja_kana_jp
    [10] => locale
    [11] => middle_name
    [12] => middle_name_ja_hani_jp
    [13] => middle_name_ja_kana_jp
    [14] => name
    [15] => name_ja_hani_jp
    [16] => name_ja_kana_jp
    [17] => nickname
    [18] => picture
    [19] => preferred_username
    [20] => profile
    [21] => updated_at
    [22] => website
    [23] => zoneinfo
)


08-12 15:14:51  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [family_name_ja_hani_jp] => 
    [family_name_ja_kana_jp] => 
    [gender] => 0
    [given_name] => 0
    [given_name_ja_hani_jp] => 
    [given_name_ja_kana_jp] => 
    [locale] => 0
    [middle_name] => 0
    [middle_name_ja_hani_jp] => 
    [middle_name_ja_kana_jp] => 
    [name] => 0
    [name_ja_hani_jp] => 
    [name_ja_kana_jp] => 
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:14:51  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [family_name_ja_hani_jp] => 
    [family_name_ja_kana_jp] => 
    [gender] => 0
    [given_name] => 0
    [given_name_ja_hani_jp] => 
    [given_name_ja_kana_jp] => 
    [locale] => 0
    [middle_name] => 0
    [middle_name_ja_hani_jp] => 
    [middle_name_ja_kana_jp] => 
    [name] => 0
    [name_ja_hani_jp] => 
    [name_ja_kana_jp] => 
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:14:54  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1923473
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1923473
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1923473
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385291
    [ops] => 9aa5ff290ef2165a70ab4304bb6f5497
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=1923473&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:14:54  DEBUG prompt = 

08-12 15:14:54  DEBUG num prompt = 0 Array
(
)


08-12 15:14:54  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 1923473
    [nonce] => spardeco
)
 scopes = profile openid email

08-12 15:14:54  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:14:54  DEBUG id_token claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [name_ja_kana_jp] => 0
    [name_ja_hani_jp] => 0
    [given_name] => 0
    [given_name_ja_kana_jp] => 0
    [given_name_ja_hani_jp] => 0
    [family_name] => 0
    [family_name_ja_kana_jp] => 0
    [family_name_ja_hani_jp] => 0
    [middle_name] => 0
    [middle_name_ja_kana_jp] => 0
    [middle_name_ja_hani_jp] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:14:54  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => family_name_ja_hani_jp
    [5] => family_name_ja_kana_jp
    [6] => gender
    [7] => given_name
    [8] => given_name_ja_hani_jp
    [9] => given_name_ja_kana_jp
    [10] => locale
    [11] => middle_name
    [12] => middle_name_ja_hani_jp
    [13] => middle_name_ja_kana_jp
    [14] => name
    [15] => name_ja_hani_jp
    [16] => name_ja_kana_jp
    [17] => nickname
    [18] => picture
    [19] => preferred_username
    [20] => profile
    [21] => updated_at
    [22] => website
    [23] => zoneinfo
)


08-12 15:14:54  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [family_name_ja_hani_jp] => 
    [family_name_ja_kana_jp] => 
    [gender] => 0
    [given_name] => 0
    [given_name_ja_hani_jp] => 
    [given_name_ja_kana_jp] => 
    [locale] => 0
    [middle_name] => 0
    [middle_name_ja_hani_jp] => 
    [middle_name_ja_kana_jp] => 
    [name] => 0
    [name_ja_hani_jp] => 
    [name_ja_kana_jp] => 
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:14:54  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [family_name_ja_hani_jp] => 
    [family_name_ja_kana_jp] => 
    [gender] => 0
    [given_name] => 0
    [given_name_ja_hani_jp] => 
    [given_name_ja_kana_jp] => 
    [locale] => 0
    [middle_name] => 0
    [middle_name_ja_hani_jp] => 
    [middle_name_ja_kana_jp] => 
    [name] => 0
    [name_ja_hani_jp] => 
    [name_ja_kana_jp] => 
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:15:42  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 4650719
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1923473
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 1923473
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385291
    [ops] => 9aa5ff290ef2165a70ab4304bb6f5497
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=4650719&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:15:42  DEBUG prompt = 

08-12 15:15:42  DEBUG num prompt = 0 Array
(
)


08-12 15:15:42  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 4650719
    [nonce] => spardeco
)
 scopes = openid id_token

08-12 15:15:42  DEBUG userinfo claims = Array
(
)


08-12 15:15:42  DEBUG id_token claims = Array
(
)


08-12 15:15:42  DEBUG unique keys = Array
(
)


08-12 15:15:42  DEBUG requested_claims = Array
(
)


08-12 15:15:42  INFO requested claims = Array
(
)


==============================================================================
08-12 15:15:46  DEBUG Request: Array
(
    [mode] => ax_confirm
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 4650719
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 4650719
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385291
    [ops] => 9aa5ff290ef2165a70ab4304bb6f5497
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=4650719&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:15:47  ERROR handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(1497): send_response('alice', false)
#1 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(83): handle_confirm_userinfo()
#2 {main}

08-12 15:15:47  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:access_denied desc:User denied access uri: state:4650719 code:400

==============================================================================
08-12 15:15:48  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 4650719
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 4650719
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 4650719
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385291
    [ops] => 9aa5ff290ef2165a70ab4304bb6f5497
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=4650719&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:15:48  DEBUG prompt = 

08-12 15:15:48  DEBUG num prompt = 0 Array
(
)


08-12 15:15:48  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 4650719
    [nonce] => spardeco
)
 scopes = openid id_token

08-12 15:15:48  DEBUG userinfo claims = Array
(
)


08-12 15:15:48  DEBUG id_token claims = Array
(
)


08-12 15:15:48  DEBUG unique keys = Array
(
)


08-12 15:15:48  DEBUG requested_claims = Array
(
)


08-12 15:15:48  INFO requested claims = Array
(
)


==============================================================================
08-12 15:15:54  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1555433
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 4650719
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 4650719
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385291
    [ops] => 9aa5ff290ef2165a70ab4304bb6f5497
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=1555433&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:15:54  DEBUG prompt = 

08-12 15:15:54  DEBUG num prompt = 0 Array
(
)


08-12 15:15:54  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1555433
    [nonce] => spardeco
)
 scopes = openid id_token

08-12 15:15:54  DEBUG userinfo claims = Array
(
)


08-12 15:15:54  DEBUG id_token claims = Array
(
)


08-12 15:15:54  DEBUG unique keys = Array
(
)


08-12 15:15:54  DEBUG requested_claims = Array
(
)


08-12 15:15:54  INFO requested claims = Array
(
)


==============================================================================
08-12 15:16:06  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1257436
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=1257436&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:16:06  DEBUG prompt = 

08-12 15:16:06  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:16:26  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1257436
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1257436
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=1257436&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:16:26  DEBUG Auth_time = 1439385386

08-12 15:16:26  DEBUG session id = cvevqjhranpdep58p1gco902n4

08-12 15:16:26  DEBUG prompt = 

08-12 15:16:26  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1257436
    [nonce] => spardeco
)
 scopes = openid id_token

08-12 15:16:26  DEBUG userinfo claims = Array
(
)


08-12 15:16:26  DEBUG id_token claims = Array
(
)


08-12 15:16:26  DEBUG unique keys = Array
(
)


08-12 15:16:26  DEBUG requested_claims = Array
(
)


08-12 15:16:26  INFO requested claims = Array
(
)


==============================================================================
08-12 15:16:51  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1257436
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1257436
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1257436
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385386
    [ops] => 8ad88b979d3d69307e76c58a86f0e4d8
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=1257436&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:16:51  DEBUG prompt = 

08-12 15:16:51  DEBUG num prompt = 0 Array
(
)


08-12 15:16:51  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 1257436
    [nonce] => spardeco
)
 scopes = openid id_token

08-12 15:16:51  DEBUG userinfo claims = Array
(
)


08-12 15:16:51  DEBUG id_token claims = Array
(
)


08-12 15:16:51  DEBUG unique keys = Array
(
)


08-12 15:16:51  DEBUG requested_claims = Array
(
)


08-12 15:16:51  INFO requested claims = Array
(
)


==============================================================================
08-12 15:16:53  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => id_token
    [state] => 5214895
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1257436
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1257436
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385386
    [ops] => 8ad88b979d3d69307e76c58a86f0e4d8
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=id_token&state=5214895&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:16:53  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 15:16:53  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_scope desc:no openid scope uri: state:5214895 code:400

==============================================================================
08-12 15:21:50  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 5916717
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1257436
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 1257436
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385386
    [ops] => 8ad88b979d3d69307e76c58a86f0e4d8
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid%20id_token&state=5916717&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:21:50  DEBUG prompt = 

08-12 15:21:50  DEBUG num prompt = 0 Array
(
)


08-12 15:21:50  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid id_token
    [state] => 5916717
    [nonce] => spardeco
)
 scopes = openid id_token

08-12 15:21:50  DEBUG userinfo claims = Array
(
)


08-12 15:21:50  DEBUG id_token claims = Array
(
)


08-12 15:21:50  DEBUG unique keys = Array
(
)


08-12 15:21:50  DEBUG requested_claims = Array
(
)


08-12 15:21:50  INFO requested claims = Array
(
)


==============================================================================
08-12 15:24:42  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6876789
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 5916717
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid id_token
            [state] => 5916717
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385386
    [ops] => 8ad88b979d3d69307e76c58a86f0e4d8
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=6876789&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:24:42  DEBUG prompt = 

08-12 15:24:42  DEBUG num prompt = 0 Array
(
)


08-12 15:24:42  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6876789
    [nonce] => spardeco
)
 scopes = openid

08-12 15:24:42  DEBUG userinfo claims = Array
(
)


08-12 15:24:42  DEBUG id_token claims = Array
(
)


08-12 15:24:42  DEBUG unique keys = Array
(
)


08-12 15:24:42  DEBUG requested_claims = Array
(
)


08-12 15:24:42  INFO requested claims = Array
(
)


==============================================================================
08-12 15:24:49  DEBUG Request: Array
(
    [mode] => ax_confirm
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6876789
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6876789
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385386
    [ops] => 8ad88b979d3d69307e76c58a86f0e4d8
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=6876789&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:24:49  ERROR handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(1497): send_response('alice', false)
#1 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(83): handle_confirm_userinfo()
#2 {main}

08-12 15:24:49  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:access_denied desc:User denied access uri: state:6876789 code:400

==============================================================================
08-12 15:24:51  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6876789
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6876789
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6876789
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385386
    [ops] => 8ad88b979d3d69307e76c58a86f0e4d8
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=6876789&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:24:51  DEBUG prompt = 

08-12 15:24:51  DEBUG num prompt = 0 Array
(
)


08-12 15:24:51  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6876789
    [nonce] => spardeco
)
 scopes = openid

08-12 15:24:51  DEBUG userinfo claims = Array
(
)


08-12 15:24:51  DEBUG id_token claims = Array
(
)


08-12 15:24:51  DEBUG unique keys = Array
(
)


08-12 15:24:51  DEBUG requested_claims = Array
(
)


08-12 15:24:51  INFO requested claims = Array
(
)


==============================================================================
08-12 15:24:52  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6876789
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6876789
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385386
    [ops] => 8ad88b979d3d69307e76c58a86f0e4d8
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=6876789&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:24:52  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6876789
    [nonce] => spardeco
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439385386
)
 scopes = openid

08-12 15:24:52  DEBUG userinfo claims = Array
(
)


08-12 15:24:52  DEBUG id_token claims = Array
(
)


08-12 15:24:52  DEBUG unique keys = Array
(
)


08-12 15:24:52  DEBUG requested_claims = Array
(
)


08-12 15:24:52  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:24:52  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439386192
    [iat] => 1439385892
    [nonce] => spardeco
)


08-12 15:24:52  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:24:52  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2MTkyLCJpYXQiOjE0MzkzODU4OTIsIm5vbmNlIjoic3BhcmRlY28ifQ.K6v7dxPAqlml2CcPE2DpMantcmhOfuAp0_oQD9bejPHN8JiFOUmmOvm-zxYOSQaUdp1xoWdSbNKyP3Cv-oGUd4IDtIS3vj2LpXU8OnciW3wL3H3zUeU8IxMbMQ9h2-IvcDsbW98LXfBj2Bntb4X7xGe3H_lsfdDHDVCDCFDNVeYMGxTgh_302bD5QDlenSYYcoOAWKvIoVQG9hK20U2FU32V-xn0GEELH-EA0lybrwJ6VMsv4CPlCkMhxMGYtW4f72wvtsoHmZaC9Yp4Fd4q8QrSmvNdgE-93kkBFek0nx234Pd5RXPvNWs4TayEk3ySOkKQKAT842aArAiQerpKgg

08-12 15:24:52  DEBUG ss = sha256(spardecohttps://localhost8ad88b979d3d69307e76c58a86f0e4d8fcd26231aabf6f6fae93f3a9c0e0b736).fcd26231aabf6f6fae93f3a9c0e0b736

==============================================================================
08-12 15:24:54  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6876789
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=6876789&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:24:54  DEBUG prompt = 

08-12 15:24:54  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:24:55  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8135999
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6876789
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6876789
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8135999&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:24:55  DEBUG prompt = 

08-12 15:24:55  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:24:57  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8135999
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8135999
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8135999&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:24:57  DEBUG Auth_time = 1439385897

08-12 15:24:57  DEBUG session id = cvevqjhranpdep58p1gco902n4

08-12 15:24:57  DEBUG prompt = 

08-12 15:24:57  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8135999
    [nonce] => spardeco
)
 scopes = openid

08-12 15:24:57  DEBUG userinfo claims = Array
(
)


08-12 15:24:57  DEBUG id_token claims = Array
(
)


08-12 15:24:57  DEBUG unique keys = Array
(
)


08-12 15:24:57  DEBUG requested_claims = Array
(
)


08-12 15:24:57  INFO requested claims = Array
(
)


==============================================================================
08-12 15:25:16  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8135999
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8135999
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385897
    [ops] => 0b59da146919e3adfa516a141538485b
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:25:16  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8135999
    [nonce] => spardeco
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439385897
)
 scopes = openid

08-12 15:25:16  DEBUG userinfo claims = Array
(
)


08-12 15:25:16  DEBUG id_token claims = Array
(
)


08-12 15:25:16  DEBUG unique keys = Array
(
)


08-12 15:25:16  DEBUG requested_claims = Array
(
)


08-12 15:25:16  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:25:16  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439386216
    [iat] => 1439385916
    [nonce] => spardeco
)


08-12 15:25:16  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:25:16  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2MjE2LCJpYXQiOjE0MzkzODU5MTYsIm5vbmNlIjoic3BhcmRlY28ifQ.YxPRPLD0tF2QYW86EJwIGkULEWm4tsB89V7sZzCmVL2CStBHVDZXm3RKnF8w5vfZ1Bjj2xWYUF6f4B4kPknQsQl3HftMEmbFJ_GA08g94lOxJ_i3HYZD6cOuyPizdwAZIDnbmHyOwJsNpuj10qFl1nZKkIRbKc7cZcjQPOIIe_7PDMxzDNqKGaAUy_NZi3wQJ8GbaW0qwVyVqfn1SBACNO0PiSs2XM6KXBA-jY_yL6DXX2Vs104tVQXwjNVA4cYC3dawj5IQP2JPD46j-gI4x0UVpZ38J2pwKsZr-Xc9LTdZuh2MU-9FfPMQp9pceaqt6h936-jil07VLc0coUQ8NA

08-12 15:25:16  DEBUG ss = sha256(spardecohttps://localhost0b59da146919e3adfa516a141538485b09c23a8611a17a08b9428c17601a8dc7).09c23a8611a17a08b9428c17601a8dc7

==============================================================================
08-12 15:25:57  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8135999
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8135999&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:25:57  DEBUG prompt = 

08-12 15:25:57  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:26:02  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3985596
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8135999
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8135999
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3985596","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:26:02  DEBUG prompt = 

08-12 15:26:02  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:26:04  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3985596
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3985596
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3985596"} []
----------------------------------------------------------

08-12 15:26:04  DEBUG Auth_time = 1439385964

08-12 15:26:04  DEBUG session id = cvevqjhranpdep58p1gco902n4

08-12 15:26:04  DEBUG prompt = 

08-12 15:26:04  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3985596
)
 scopes = profile openid email

08-12 15:26:04  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:26:04  DEBUG id_token claims = Array
(
)


08-12 15:26:04  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:26:04  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:26:04  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:26:06  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3985596
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3985596
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439385964
    [ops] => abc7dd1707bec3110dcefc0a6def0027
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:26:06  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3985596
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439385964
)
 scopes = profile openid email

08-12 15:26:06  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:26:06  DEBUG id_token claims = Array
(
)


08-12 15:26:06  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:26:06  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:26:06  DEBUG ss = sha256(spardecohttps://localhostabc7dd1707bec3110dcefc0a6def00279c78f45c9f5ba3604d2080e70ba12b01).9c78f45c9f5ba3604d2080e70ba12b01

==============================================================================
08-12 15:26:07  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => Ak5fFjifmAT8UV5jpZYmIr3lpXqARQ9G0odOhfQNZZc
    [state] => 3985596
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=Ak5fFjifmAT8UV5jpZYmIr3lpXqARQ9G0odOhfQNZZc&state=3985596&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:26:07  DEBUG spardeco
client_secret_post

08-12 15:26:07  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 15:26:07  DEBUG no ops in sessionid cvevqjhranpdep58p1gco902n4

08-12 15:26:07  DEBUG requested idtoken claims = Array
(
)


08-12 15:26:07  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:26:07  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439386267
    [iat] => 1439385967
    [at_hash] => n6Qx9RTedbYvW4mJQ8pWeQ
)


08-12 15:26:07  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:26:07  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2MjY3LCJpYXQiOjE0MzkzODU5NjcsImF0X2hhc2giOiJuNlF4OVJUZWRiWXZXNG1KUThwV2VRIn0.CyRU1sDqzx5CqBvu9jnE2rH8WejzU-73wIrF5q9ENJGxbiI0Uj4jGHATalbEdsJcci-ee2VU72vlD3F_x9CNyGRaCi9a2EqIL8OfereUi2dAx_fNFOwUMWRy5XEQLkozdggejNfeENITqWFtSORiE6QH7nUB-UYgmWTQtXOfbqIqAzype2eY4Uj81Sx5d2-GS_9LFaLPvvOwmvUtRXhFhfHTSS3Kfm81G-mqZbvR3_B6rCoUFQm2GEbSHVtQUIqdRoJVbqZb9wo3MzC8qGRoComJNWERbkL3Nam6hXCj4z6SdhMp8ydC93y-Tc3RZ5pqZ3x6wfFVUOzOBLXnme9_Ww

08-12 15:26:07  DEBUG token response = Array
(
    [access_token] => oYHL_tPDa-9jbPRZ8QjXIkRLVVknZAqns43-Irnuk9I
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2MjY3LCJpYXQiOjE0MzkzODU5NjcsImF0X2hhc2giOiJuNlF4OVJUZWRiWXZXNG1KUThwV2VRIn0.CyRU1sDqzx5CqBvu9jnE2rH8WejzU-73wIrF5q9ENJGxbiI0Uj4jGHATalbEdsJcci-ee2VU72vlD3F_x9CNyGRaCi9a2EqIL8OfereUi2dAx_fNFOwUMWRy5XEQLkozdggejNfeENITqWFtSORiE6QH7nUB-UYgmWTQtXOfbqIqAzype2eY4Uj81Sx5d2-GS_9LFaLPvvOwmvUtRXhFhfHTSS3Kfm81G-mqZbvR3_B6rCoUFQm2GEbSHVtQUIqdRoJVbqZb9wo3MzC8qGRoComJNWERbkL3Nam6hXCj4z6SdhMp8ydC93y-Tc3RZ5pqZ3x6wfFVUOzOBLXnme9_Ww
)


==============================================================================
08-12 15:26:07  DEBUG Request: Array
(
    [access_token] => oYHL_tPDa-9jbPRZ8QjXIkRLVVknZAqns43-Irnuk9I
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=oYHL_tPDa-9jbPRZ8QjXIkRLVVknZAqns43-Irnuk9I","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:26:07  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:26:07  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 15:26:07  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 15:26:07  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3985596
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439385964
)
 scopes = profile openid email

08-12 15:26:07  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:26:07  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:26:07  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:26:07  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 15:26:07  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 15:26:42  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9012866
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9012866","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:26:43  DEBUG prompt = 

08-12 15:26:43  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:26:45  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9012866
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9012866
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9012866"} []
----------------------------------------------------------

08-12 15:26:45  DEBUG Auth_time = 1439386005

08-12 15:26:45  DEBUG session id = cvevqjhranpdep58p1gco902n4

08-12 15:26:45  DEBUG prompt = 

08-12 15:26:45  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9012866
)
 scopes = profile openid email

08-12 15:26:45  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:26:45  DEBUG id_token claims = Array
(
)


08-12 15:26:45  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:26:45  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:26:45  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:26:47  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9012866
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9012866
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439386005
    [ops] => 90781494bae077fb24985605fc4d9a3b
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:26:47  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9012866
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439386005
)
 scopes = profile openid email

08-12 15:26:47  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:26:47  DEBUG id_token claims = Array
(
)


08-12 15:26:47  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:26:47  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:26:47  DEBUG ss = sha256(spardecohttps://localhost90781494bae077fb24985605fc4d9a3b84efe6d6577eaffdc4e9b5a0f402176b).84efe6d6577eaffdc4e9b5a0f402176b

==============================================================================
08-12 15:26:47  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => wziXng75MSFdUf6YVX9u6Vu_Z3v8rNAYTZFgG3TBddM
    [state] => 9012866
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=wziXng75MSFdUf6YVX9u6Vu_Z3v8rNAYTZFgG3TBddM&state=9012866&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:26:47  DEBUG spardeco
client_secret_post

08-12 15:26:47  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 15:26:48  DEBUG no ops in sessionid cvevqjhranpdep58p1gco902n4

08-12 15:26:48  DEBUG requested idtoken claims = Array
(
)


08-12 15:26:48  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:26:48  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439386308
    [iat] => 1439386008
    [at_hash] => Of62lTeOFBsJRcW347ADzQ
)


08-12 15:26:48  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:26:48  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2MzA4LCJpYXQiOjE0MzkzODYwMDgsImF0X2hhc2giOiJPZjYybFRlT0ZCc0pSY1czNDdBRHpRIn0.u5THDUH34qPrSiN7jOcZG-NtlV6aSAhdgND3sIRj5d-1PJSbJRkwN7n7bSFyWjQfTveldDhaWfcYUyXnq9hcZrrnvJKpoA9EPyGCFUz9jrrDmS47fOoNNvm3UQkC-7jQTLdHLTj9JQhxGUWsXzgLJj1qlWwGgjQ0nmvnGChzr7SLVW2suYPdRhWfzhe_gHESCscUkUC40mn9q0QIQ_hwKCFtEHVTRno52nhufTsoH03A327vJzzVU6C5SMiPk6119OHr_Jj2gfXxmmU0gaAyV4qlnuHZeQ9cb8UrSk3PzlgkmFSr3nb9ius4wk-3-lcxqJt6hAJZMZ6llD2TgoQPzg

08-12 15:26:48  DEBUG token response = Array
(
    [access_token] => 1xUicGOavSJISCg5WRkYCeKPTSILBUpKIEhbWZdtd1E
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2MzA4LCJpYXQiOjE0MzkzODYwMDgsImF0X2hhc2giOiJPZjYybFRlT0ZCc0pSY1czNDdBRHpRIn0.u5THDUH34qPrSiN7jOcZG-NtlV6aSAhdgND3sIRj5d-1PJSbJRkwN7n7bSFyWjQfTveldDhaWfcYUyXnq9hcZrrnvJKpoA9EPyGCFUz9jrrDmS47fOoNNvm3UQkC-7jQTLdHLTj9JQhxGUWsXzgLJj1qlWwGgjQ0nmvnGChzr7SLVW2suYPdRhWfzhe_gHESCscUkUC40mn9q0QIQ_hwKCFtEHVTRno52nhufTsoH03A327vJzzVU6C5SMiPk6119OHr_Jj2gfXxmmU0gaAyV4qlnuHZeQ9cb8UrSk3PzlgkmFSr3nb9ius4wk-3-lcxqJt6hAJZMZ6llD2TgoQPzg
)


==============================================================================
08-12 15:26:48  DEBUG Request: Array
(
    [access_token] => 1xUicGOavSJISCg5WRkYCeKPTSILBUpKIEhbWZdtd1E
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=1xUicGOavSJISCg5WRkYCeKPTSILBUpKIEhbWZdtd1E","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:26:48  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:26:48  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 15:26:48  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 15:26:48  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9012866
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439386005
)
 scopes = profile openid email

08-12 15:26:48  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:26:48  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:26:48  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:26:48  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 15:26:48  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 15:27:14  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9012866
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9012866","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:27:14  DEBUG prompt = 

08-12 15:27:14  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:27:21  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9012866
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9012866
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9012866"} []
----------------------------------------------------------

08-12 15:27:21  DEBUG Auth_time = 1439386041

08-12 15:27:21  DEBUG session id = cvevqjhranpdep58p1gco902n4

08-12 15:27:21  DEBUG prompt = 

08-12 15:27:21  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9012866
)
 scopes = profile openid email

08-12 15:27:21  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:27:21  DEBUG id_token claims = Array
(
)


08-12 15:27:21  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:27:21  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:27:21  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:27:23  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9012866
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9012866
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9012866
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439386041
    [ops] => f50b5d5a0be212622a3f5227d0b20dcb
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9012866","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:27:23  DEBUG prompt = 

08-12 15:27:23  DEBUG num prompt = 0 Array
(
)


08-12 15:27:23  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9012866
)
 scopes = profile openid email

08-12 15:27:23  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:27:23  DEBUG id_token claims = Array
(
)


08-12 15:27:23  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:27:23  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:27:23  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:27:26  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8838161
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9012866
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9012866
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439386041
    [ops] => f50b5d5a0be212622a3f5227d0b20dcb
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8838161&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:27:26  DEBUG prompt = 

08-12 15:27:26  DEBUG num prompt = 0 Array
(
)


08-12 15:27:26  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8838161
    [nonce] => spardeco
)
 scopes = openid

08-12 15:27:26  DEBUG userinfo claims = Array
(
)


08-12 15:27:26  DEBUG id_token claims = Array
(
)


08-12 15:27:26  DEBUG unique keys = Array
(
)


08-12 15:27:26  DEBUG requested_claims = Array
(
)


08-12 15:27:26  INFO requested claims = Array
(
)


==============================================================================
08-12 15:27:44  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8838161
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8838161
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8838161
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439386041
    [ops] => f50b5d5a0be212622a3f5227d0b20dcb
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8838161&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:27:44  DEBUG prompt = 

08-12 15:27:44  DEBUG num prompt = 0 Array
(
)


08-12 15:27:44  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8838161
    [nonce] => spardeco
)
 scopes = openid

08-12 15:27:44  DEBUG userinfo claims = Array
(
)


08-12 15:27:44  DEBUG id_token claims = Array
(
)


08-12 15:27:44  DEBUG unique keys = Array
(
)


08-12 15:27:44  DEBUG requested_claims = Array
(
)


08-12 15:27:44  INFO requested claims = Array
(
)


==============================================================================
08-12 15:27:46  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8838161
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8838161
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439386041
    [ops] => f50b5d5a0be212622a3f5227d0b20dcb
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8838161&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:27:46  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8838161
    [nonce] => spardeco
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439386041
)
 scopes = openid

08-12 15:27:46  DEBUG userinfo claims = Array
(
)


08-12 15:27:46  DEBUG id_token claims = Array
(
)


08-12 15:27:46  DEBUG unique keys = Array
(
)


08-12 15:27:46  DEBUG requested_claims = Array
(
)


08-12 15:27:46  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:27:46  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439386366
    [iat] => 1439386066
    [nonce] => spardeco
)


08-12 15:27:46  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:27:46  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2MzY2LCJpYXQiOjE0MzkzODYwNjYsIm5vbmNlIjoic3BhcmRlY28ifQ.hW6qzLxRjB5hrP6d2g_PmsCPCTXTkBLFs_62_tl-1i8Cf11gH5dkmKEylEJqerMkk7VGz_vmv_nNAQka7YTjemAdiUIAmPrp0YhYX027ShbAZMV8jTQWoh3YMn4gQgY0TvZPM4DFw9h67KSh9sc6N8B1yPIaN5V_8GamrzwGAj9lttL3DNQxG-2686QDgvf6J12pTTpmo8HTq_mezyXJtLSS0792JCwqVl3Cp_yN_jdg-nyompooxfsnHpHVJMEn5-GR7dQN9ExeliYdWJpRw2-X7uXMHfzzC1yyFm-Y_jPd8Z0b-MXntrYgxFB3u-DxnBiLI1hEQyAUsFiFfHXyTA

08-12 15:27:46  DEBUG ss = sha256(spardecohttps://localhostf50b5d5a0be212622a3f5227d0b20dcb84f333b887d847968a124ac8c40758eb).84f333b887d847968a124ac8c40758eb

==============================================================================
08-12 15:27:54  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8838161
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8838161&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:27:54  DEBUG prompt = 

08-12 15:27:54  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:27:59  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8838161
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8838161
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8838161&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:27:59  DEBUG Auth_time = 1439386079

08-12 15:27:59  DEBUG session id = cvevqjhranpdep58p1gco902n4

08-12 15:27:59  DEBUG prompt = 

08-12 15:27:59  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8838161
    [nonce] => spardeco
)
 scopes = openid

08-12 15:27:59  DEBUG userinfo claims = Array
(
)


08-12 15:27:59  DEBUG id_token claims = Array
(
)


08-12 15:27:59  DEBUG unique keys = Array
(
)


08-12 15:27:59  DEBUG requested_claims = Array
(
)


08-12 15:27:59  INFO requested claims = Array
(
)


==============================================================================
08-12 15:28:00  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8838161
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8838161
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439386079
    [ops] => cb25513321516540c7f21c649f9f1a02
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:28:00  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8838161
    [nonce] => spardeco
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439386079
)
 scopes = openid

08-12 15:28:00  DEBUG userinfo claims = Array
(
)


08-12 15:28:00  DEBUG id_token claims = Array
(
)


08-12 15:28:00  DEBUG unique keys = Array
(
)


08-12 15:28:00  DEBUG requested_claims = Array
(
)


08-12 15:28:00  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:28:00  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439386380
    [iat] => 1439386080
    [nonce] => spardeco
)


08-12 15:28:00  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:28:00  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2MzgwLCJpYXQiOjE0MzkzODYwODAsIm5vbmNlIjoic3BhcmRlY28ifQ.Ywxda4q_jX8T1XdLWMLzacCsTxcvFRIt1XvegZfPnBNC8tO6Sp2sBUZaEsYxss0_3cMbyASjDJDR8Qn0hyC9f0ClVp6hIkoBQBorV10Yb9iut7ckQSNyZMpVu92dnlg6WWYPVLULpAYx_guJxtuTZSIACtZ_Xpaf6aH3VMH_xMWKIzrJ8Oq5dXVuOGI6_16uqwW7XpqWF4KDxMZgoFqOKGi2w4LtBuHeg2kKbS8gm4pyuZK757HQkWmeTUCD53eF2ZjxcujdBJHG5MvlilPr0DYQzfBPMoARdCbzsrFzZIoc_U9OnHMtImd8K0SPdyCfTs7pj2GG5GuS2teZmObxDw

08-12 15:28:00  DEBUG ss = sha256(spardecohttps://localhostcb25513321516540c7f21c649f9f1a02c499542366ea5f299ba2966aa1fc93fc).c499542366ea5f299ba2966aa1fc93fc

==============================================================================
08-12 15:35:10  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8838161
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8838161&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:35:10  DEBUG prompt = 

08-12 15:35:10  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:35:14  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 3511638
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8838161
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8838161
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=3511638&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:35:14  DEBUG prompt = 

08-12 15:35:14  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:35:17  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 3511638
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 3511638
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=3511638&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:35:17  DEBUG Auth_time = 1439386517

08-12 15:35:17  DEBUG session id = cvevqjhranpdep58p1gco902n4

08-12 15:35:17  DEBUG prompt = 

08-12 15:35:17  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 3511638
    [nonce] => spardeco
)
 scopes = openid

08-12 15:35:17  DEBUG userinfo claims = Array
(
)


08-12 15:35:17  DEBUG id_token claims = Array
(
)


08-12 15:35:17  DEBUG unique keys = Array
(
)


08-12 15:35:17  DEBUG requested_claims = Array
(
)


08-12 15:35:17  INFO requested claims = Array
(
)


==============================================================================
08-12 15:35:19  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 3511638
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 3511638
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439386517
    [ops] => 1476c628e2950f1ea9aa34758bda8023
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:35:19  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 3511638
    [nonce] => spardeco
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439386517
)
 scopes = openid

08-12 15:35:19  DEBUG userinfo claims = Array
(
)


08-12 15:35:19  DEBUG id_token claims = Array
(
)


08-12 15:35:19  DEBUG unique keys = Array
(
)


08-12 15:35:19  DEBUG requested_claims = Array
(
)


08-12 15:35:19  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:35:19  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439386819
    [iat] => 1439386519
    [nonce] => spardeco
)


08-12 15:35:19  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:35:19  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2ODE5LCJpYXQiOjE0MzkzODY1MTksIm5vbmNlIjoic3BhcmRlY28ifQ.vWhp_TknpQ2aliPt_-aR_fW8HgClKJLGE9ASHse4uR_U9eyWpm3cX2AJnmhC5-JT07wbwZ1lJH6ynF4iKHrEFNILz7q8ilW7VKKgEeuB-UVR6jiNW-Afqd76zREQn_hyI_fIzJpuUZebXDzxPnBONOlhJ_EQ1SgzKBR2fMlLKnayAYCsn2fRF6Fz0FuoparNC3o2GeiInXXHhF2i5jtCvw4p4k6tKsHtKWh5un4g8_1WbJiGPoPrU_o0R3iQMKKWtadC0l_-aqGsyDf4eK-sjuN0D0JTdRNAMcbBO7BvEFTzo6TLGv_w05zrVbXpVd20YaM_CRMTI3JIfOOS7HBnog

08-12 15:35:19  DEBUG ss = sha256(spardecohttps://localhost1476c628e2950f1ea9aa34758bda80235d1bc2648e7033e376d1244f9a6103a3).5d1bc2648e7033e376d1244f9a6103a3

==============================================================================
08-12 15:36:06  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 3511638
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=3511638&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:36:06  DEBUG prompt = 

08-12 15:36:06  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:36:11  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7976252
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 3511638
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 3511638
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7976252","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:36:11  DEBUG prompt = 

08-12 15:36:11  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:36:13  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8262396
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7976252
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7976252
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8262396&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:36:13  DEBUG prompt = 

08-12 15:36:13  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:36:15  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8262396
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8262396
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8262396&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:36:15  DEBUG Auth_time = 1439386575

08-12 15:36:15  DEBUG session id = cvevqjhranpdep58p1gco902n4

08-12 15:36:15  DEBUG prompt = 

08-12 15:36:15  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8262396
    [nonce] => spardeco
)
 scopes = openid

08-12 15:36:15  DEBUG userinfo claims = Array
(
)


08-12 15:36:15  DEBUG id_token claims = Array
(
)


08-12 15:36:15  DEBUG unique keys = Array
(
)


08-12 15:36:15  DEBUG requested_claims = Array
(
)


08-12 15:36:15  INFO requested claims = Array
(
)


==============================================================================
08-12 15:36:17  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8262396
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8262396
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439386575
    [ops] => 50eb738b151443c1d0962ab3b2645e14
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:36:17  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8262396
    [nonce] => spardeco
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439386575
)
 scopes = openid

08-12 15:36:17  DEBUG userinfo claims = Array
(
)


08-12 15:36:17  DEBUG id_token claims = Array
(
)


08-12 15:36:17  DEBUG unique keys = Array
(
)


08-12 15:36:17  DEBUG requested_claims = Array
(
)


08-12 15:36:17  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:36:17  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439386877
    [iat] => 1439386577
    [nonce] => spardeco
)


08-12 15:36:17  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:36:17  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2ODc3LCJpYXQiOjE0MzkzODY1NzcsIm5vbmNlIjoic3BhcmRlY28ifQ.h2gRGP2s5BzzlQFhKmM_r93BeVs96Xm7HETXhnjE1m81kdF_vbW-Wq820lXabu89aJK7rmVcRmfPCt-cgnl7lnVZqLI4T6A4sgAAVxutP73G8b5ZpCa6JngNFFCgq5rnSAVmju_QvumfvK7a0x_40eLp6m1B2eIrObo_ugiOMiizTHndlChSaZgKV8CIyycbbdpuoUgQk3gCaq8nv0Hm_qnWHytf09P31l1kGEu8y9iX5RLdPPRKlecGLTpKrMzqIHJtHlziRAKdJyinv4q7R9Lb_PQl1pij35rv8BJIAeWDDsU9TF0ByaevcANcIEPeW5WvGHluyPFcuYuopaKrsA

08-12 15:36:17  DEBUG ss = sha256(spardecohttps://localhost50eb738b151443c1d0962ab3b2645e14f4ed67222321a557f4767bf1b9f716bf).f4ed67222321a557f4767bf1b9f716bf

==============================================================================
08-12 15:37:10  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8262396
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8262396&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:37:10  DEBUG prompt = 

08-12 15:37:10  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:37:11  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8528564
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8262396
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8262396
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8528564","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:37:12  DEBUG prompt = 

08-12 15:37:12  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:37:15  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8528564
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8528564
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8528564"} []
----------------------------------------------------------

08-12 15:37:15  DEBUG Auth_time = 1439386635

08-12 15:37:15  DEBUG session id = cvevqjhranpdep58p1gco902n4

08-12 15:37:15  DEBUG prompt = 

08-12 15:37:15  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8528564
)
 scopes = profile openid email

08-12 15:37:15  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:37:15  DEBUG id_token claims = Array
(
)


08-12 15:37:15  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:37:15  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:37:15  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:37:17  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8528564
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8528564
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439386635
    [ops] => 724302c964d2b2acff3861b763026824
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:37:17  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8528564
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439386635
)
 scopes = profile openid email

08-12 15:37:17  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:37:17  DEBUG id_token claims = Array
(
)


08-12 15:37:17  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:37:17  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:37:17  DEBUG ss = sha256(spardecohttps://localhost724302c964d2b2acff3861b76302682438c767fa637960a3289f5767173eed5d).38c767fa637960a3289f5767173eed5d

==============================================================================
08-12 15:37:17  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 0_Y_toJaD0U-eU0jUDhCtglqysfiNEs1YuD2yYnJrLY
    [state] => 8528564
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=0_Y_toJaD0U-eU0jUDhCtglqysfiNEs1YuD2yYnJrLY&state=8528564&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:37:17  DEBUG spardeco
client_secret_post

08-12 15:37:17  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 15:37:17  DEBUG no ops in sessionid cvevqjhranpdep58p1gco902n4

08-12 15:37:17  DEBUG requested idtoken claims = Array
(
)


08-12 15:37:17  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:37:17  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439386937
    [iat] => 1439386637
    [at_hash] => nAOPg15B9nLoF13F0M8c5A
)


08-12 15:37:17  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:37:17  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2OTM3LCJpYXQiOjE0MzkzODY2MzcsImF0X2hhc2giOiJuQU9QZzE1QjluTG9GMTNGME04YzVBIn0.CkwFrYd_txPa4aaNVvMPFXCy9HBKFxBUSlLE2CedfVesqV4rvX3TC47Cw1nf5SGrqXPrwA1sOAiZC9rlHZ3IMIyx_UIC6ivrbLAP7JLwVMFCKRt5nHAwgf650xHFFpyWXebvI9270GwDDMnTG9pl4DPv6h1Q0qFa68SHSmrbqfP64I-DNOP1y6EeHrjgwSSfzJ2jHba1yBT1Re3l-2m-bmi3ObBsBIwobHsmuEEx_35oSnY2NEvy1qJbVJysHfaMMJumqgE-rSLX6rNkaWILq8Qz6GTN1UJszgpsYWV2P-s-T5-6W3VzcrAxpcwJifg4V8xt7BE3ZW6kRB5QNeOSvA

08-12 15:37:17  DEBUG token response = Array
(
    [access_token] => UcXsjjIrnUpKfU2EGthTMevy90yzjvpqw9y4-rOwSIA
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2OTM3LCJpYXQiOjE0MzkzODY2MzcsImF0X2hhc2giOiJuQU9QZzE1QjluTG9GMTNGME04YzVBIn0.CkwFrYd_txPa4aaNVvMPFXCy9HBKFxBUSlLE2CedfVesqV4rvX3TC47Cw1nf5SGrqXPrwA1sOAiZC9rlHZ3IMIyx_UIC6ivrbLAP7JLwVMFCKRt5nHAwgf650xHFFpyWXebvI9270GwDDMnTG9pl4DPv6h1Q0qFa68SHSmrbqfP64I-DNOP1y6EeHrjgwSSfzJ2jHba1yBT1Re3l-2m-bmi3ObBsBIwobHsmuEEx_35oSnY2NEvy1qJbVJysHfaMMJumqgE-rSLX6rNkaWILq8Qz6GTN1UJszgpsYWV2P-s-T5-6W3VzcrAxpcwJifg4V8xt7BE3ZW6kRB5QNeOSvA
)


==============================================================================
08-12 15:37:18  DEBUG Request: Array
(
    [access_token] => UcXsjjIrnUpKfU2EGthTMevy90yzjvpqw9y4-rOwSIA
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=UcXsjjIrnUpKfU2EGthTMevy90yzjvpqw9y4-rOwSIA","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:37:18  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:37:18  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 15:37:18  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 15:37:18  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8528564
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439386635
)
 scopes = profile openid email

08-12 15:37:18  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:37:18  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:37:18  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:37:18  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 15:37:18  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 15:37:25  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8528564
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8528564","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:37:25  DEBUG prompt = 

08-12 15:37:25  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:37:29  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 5590299
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8528564
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8528564
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=5590299&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:37:29  DEBUG prompt = 

08-12 15:37:29  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:37:32  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 5590299
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 5590299
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=5590299&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:37:32  DEBUG Auth_time = 1439386652

08-12 15:37:32  DEBUG session id = cvevqjhranpdep58p1gco902n4

08-12 15:37:32  DEBUG prompt = 

08-12 15:37:32  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 5590299
    [nonce] => spardeco
)
 scopes = openid

08-12 15:37:32  DEBUG userinfo claims = Array
(
)


08-12 15:37:32  DEBUG id_token claims = Array
(
)


08-12 15:37:32  DEBUG unique keys = Array
(
)


08-12 15:37:32  DEBUG requested_claims = Array
(
)


08-12 15:37:32  INFO requested claims = Array
(
)


==============================================================================
08-12 15:37:34  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 5590299
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 5590299
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439386652
    [ops] => f401e7891b7bdb1d79c6413e82365d46
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:37:34  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 5590299
    [nonce] => spardeco
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439386652
)
 scopes = openid

08-12 15:37:34  DEBUG userinfo claims = Array
(
)


08-12 15:37:34  DEBUG id_token claims = Array
(
)


08-12 15:37:34  DEBUG unique keys = Array
(
)


08-12 15:37:34  DEBUG requested_claims = Array
(
)


08-12 15:37:34  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:37:34  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439386954
    [iat] => 1439386654
    [nonce] => spardeco
)


08-12 15:37:34  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:37:34  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg2OTU0LCJpYXQiOjE0MzkzODY2NTQsIm5vbmNlIjoic3BhcmRlY28ifQ.IfuCAD2d1tsh-K80XRoAmWYCgf6L9TG_i-pB9Qgug9jWKeofWpWvFqtMElJUwRR3cgFOeY7qbfyvYK4fTrvPxhsOOq075wygSRbwfvxTBDhkyvDc7ykvuO3gjZpjZx3yV_phKrzNNb-AjZZLmCBQxQIPXq8yUmGmxtj988A7Fgh1gd303PGugUUqiwdoaH6dz-xVpLG1yL9cBxE-LH9EOMtEihBNdDWlpvYA7C0AyrPD3sJP_WtwygzoWGu9XZ2qvD4iUoZICQ9eU3PoBn1R61BBvv3l_FGizfx8Yx1NG_5nPEl443ULe_uvyDU3LW2pIrHV6q6R7TuorwiWHnZicQ

08-12 15:37:34  DEBUG ss = sha256(spardecohttps://localhostf401e7891b7bdb1d79c6413e82365d46dbc150f36fe65896fd28016f2f28fb55).dbc150f36fe65896fd28016f2f28fb55

==============================================================================
08-12 15:40:18  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 5590299
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=5590299&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:40:18  DEBUG prompt = 

08-12 15:40:18  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:40:19  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 9388869
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 5590299
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 5590299
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=9388869&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:40:19  DEBUG prompt = 

08-12 15:40:19  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:40:21  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 9388869
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 9388869
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=9388869&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:40:21  DEBUG Auth_time = 1439386821

08-12 15:40:21  DEBUG session id = cvevqjhranpdep58p1gco902n4

08-12 15:40:21  DEBUG prompt = 

08-12 15:40:21  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 9388869
    [nonce] => spardeco
)
 scopes = openid

08-12 15:40:21  DEBUG userinfo claims = Array
(
)


08-12 15:40:21  DEBUG id_token claims = Array
(
)


08-12 15:40:21  DEBUG unique keys = Array
(
)


08-12 15:40:21  DEBUG requested_claims = Array
(
)


08-12 15:40:21  INFO requested claims = Array
(
)


==============================================================================
08-12 15:40:23  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 9388869
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 9388869
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439386821
    [ops] => 5dc5b6923031d10e60061987fe694eaa
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:40:23  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 9388869
    [nonce] => spardeco
    [session_id] => cvevqjhranpdep58p1gco902n4
    [auth_time] => 1439386821
)
 scopes = openid

08-12 15:40:23  DEBUG userinfo claims = Array
(
)


08-12 15:40:23  DEBUG id_token claims = Array
(
)


08-12 15:40:23  DEBUG unique keys = Array
(
)


08-12 15:40:23  DEBUG requested_claims = Array
(
)


08-12 15:40:23  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:40:23  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439387123
    [iat] => 1439386823
    [nonce] => spardeco
)


08-12 15:40:23  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:40:23  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg3MTIzLCJpYXQiOjE0MzkzODY4MjMsIm5vbmNlIjoic3BhcmRlY28ifQ.wMz4InFoya2P_-o93x5mEaTii3E8OJtIuxTudr9lJvPMEBnkbNAV_S_2XOnm2wiNROYFJ7WrpAfvXdqp19QqkrIdmNiMquxACfAitDhyq6r2e9kbF98Tf9bFRfsf5nl3t9L36FVxD9l7T_idAMO4uw2cCSODgZVstCbgCuPzUjGsIe2QTkX3F9T-BWVd-oo18fNTMGseFTyRNjDJcvad7egMDh1Zyc7woXCSiqjiaZ80llKjfk-pwQ9v6DcVl158J0Atx7doerTdPzdh-59FVZV6BV6z7ua02Zx0JMo7_SAZiSmoI16txrqK-vx_EAl9JoXRxvvKfdgY4e619PHXAw

08-12 15:40:23  DEBUG ss = sha256(spardecohttps://localhost5dc5b6923031d10e60061987fe694eaaf1407c42bdf48b9507879d8659da6589).f1407c42bdf48b9507879d8659da6589

==============================================================================
08-12 15:43:22  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 9388869
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=9388869&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:43:22  DEBUG prompt = 

08-12 15:43:22  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:43:32  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 9388869
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 9388869
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=9388869&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:43:32  DEBUG Auth_time = 1439387012

08-12 15:43:32  DEBUG session id = cvevqjhranpdep58p1gco902n4

08-12 15:43:32  DEBUG prompt = 

08-12 15:43:32  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 9388869
    [nonce] => spardeco
)
 scopes = openid

08-12 15:43:32  DEBUG userinfo claims = Array
(
)


08-12 15:43:32  DEBUG id_token claims = Array
(
)


08-12 15:43:32  DEBUG unique keys = Array
(
)


08-12 15:43:32  DEBUG requested_claims = Array
(
)


08-12 15:43:32  INFO requested claims = Array
(
)


==============================================================================
08-12 15:43:39  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 9388869
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 9388869
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 9388869
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439387012
    [ops] => 4a896b612d4a644ee8cc92acf0c9b78f
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=9388869&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:43:39  DEBUG prompt = 

08-12 15:43:39  DEBUG num prompt = 0 Array
(
)


08-12 15:43:39  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 9388869
    [nonce] => spardeco
)
 scopes = openid

08-12 15:43:39  DEBUG userinfo claims = Array
(
)


08-12 15:43:39  DEBUG id_token claims = Array
(
)


08-12 15:43:39  DEBUG unique keys = Array
(
)


08-12 15:43:39  DEBUG requested_claims = Array
(
)


08-12 15:43:39  INFO requested claims = Array
(
)


==============================================================================
08-12 15:43:41  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4588673
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 9388869
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 9388869
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439387012
    [ops] => 4a896b612d4a644ee8cc92acf0c9b78f
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4588673","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:43:41  DEBUG prompt = 

08-12 15:43:41  DEBUG num prompt = 0 Array
(
)


08-12 15:43:41  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4588673
)
 scopes = profile openid email

08-12 15:43:41  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:43:41  DEBUG id_token claims = Array
(
)


08-12 15:43:41  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:43:41  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:43:41  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:43:50  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7242478
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4588673
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4588673
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439387012
    [ops] => 4a896b612d4a644ee8cc92acf0c9b78f
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7242478","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:43:50  DEBUG prompt = 

08-12 15:43:50  DEBUG num prompt = 0 Array
(
)


08-12 15:43:50  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7242478
)
 scopes = profile openid email

08-12 15:43:50  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:43:50  DEBUG id_token claims = Array
(
)


08-12 15:43:50  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:43:50  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:43:50  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:44:02  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5582812
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5582812","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:44:03  DEBUG prompt = 

08-12 15:44:03  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:44:05  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5582812
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5582812
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5582812"} []
----------------------------------------------------------

08-12 15:44:05  DEBUG Auth_time = 1439387045

08-12 15:44:05  DEBUG session id = 2tqsm8evf8khsc86jmv1nmips3

08-12 15:44:05  DEBUG prompt = 

08-12 15:44:05  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5582812
)
 scopes = profile openid email

08-12 15:44:05  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:44:05  DEBUG id_token claims = Array
(
)


08-12 15:44:05  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:44:05  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:44:05  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:48:57  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5582812
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5582812
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439387045
    [ops] => 8eea382944524496cac2442d8ebb91e9
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:48:57  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5582812
    [session_id] => 2tqsm8evf8khsc86jmv1nmips3
    [auth_time] => 1439387045
)
 scopes = profile openid email

08-12 15:48:57  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:48:57  DEBUG id_token claims = Array
(
)


08-12 15:48:57  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:48:57  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:48:57  DEBUG ss = sha256(spardecohttps://localhost8eea382944524496cac2442d8ebb91e9bc005ef38813298103a707c18fcb066d).bc005ef38813298103a707c18fcb066d

==============================================================================
08-12 15:48:57  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => mK9_d0umNCdopg18iORZtAlvgDlqcOJdNy61-jv8Heo
    [state] => 5582812
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=mK9_d0umNCdopg18iORZtAlvgDlqcOJdNy61-jv8Heo&state=5582812&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:48:58  DEBUG spardeco
client_secret_post

08-12 15:48:58  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 15:48:58  DEBUG no ops in sessionid 2tqsm8evf8khsc86jmv1nmips3

08-12 15:48:58  DEBUG requested idtoken claims = Array
(
)


08-12 15:48:58  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:48:58  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439387638
    [iat] => 1439387338
    [at_hash] => 1qtynlWcxmTeu8316OKf8w
)


08-12 15:48:58  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:48:58  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg3NjM4LCJpYXQiOjE0MzkzODczMzgsImF0X2hhc2giOiIxcXR5bmxXY3htVGV1ODMxNk9LZjh3In0.cxIm0cxpINR6kfNRtEFm2YswjEMyRmlNhzn0q72UnvQlgoPWMRW1PDLPCXFa0c2lbwz3m2PJqoN3lXNPOnimC4T1O4RqXMQvil508mguF-l88zQ0MBPuTWbw1us668f4BIU1A33e8Pr4o_aKgqJVsEeDBU3OubB3yr31GV0gs73qIp8OQftG_bnXhQUk19fmLuBwSD89kqP-M1IckgVHkngIXX8hLmq7UcEIPS4q5P6W3oQsEfimE-8BV09QfSujBbMKmaesDvPEl6G66Uvo3K63nHKAW2l71xDkekffR8cGiVLF63y_CuPTiwIkk1flO-l9N5_s6meahMJdWODygQ

08-12 15:48:58  DEBUG token response = Array
(
    [access_token] => ilezMgZqp7vMdNGY6w46IJ8K9VTB-uf3MzsFLzHmOik
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg3NjM4LCJpYXQiOjE0MzkzODczMzgsImF0X2hhc2giOiIxcXR5bmxXY3htVGV1ODMxNk9LZjh3In0.cxIm0cxpINR6kfNRtEFm2YswjEMyRmlNhzn0q72UnvQlgoPWMRW1PDLPCXFa0c2lbwz3m2PJqoN3lXNPOnimC4T1O4RqXMQvil508mguF-l88zQ0MBPuTWbw1us668f4BIU1A33e8Pr4o_aKgqJVsEeDBU3OubB3yr31GV0gs73qIp8OQftG_bnXhQUk19fmLuBwSD89kqP-M1IckgVHkngIXX8hLmq7UcEIPS4q5P6W3oQsEfimE-8BV09QfSujBbMKmaesDvPEl6G66Uvo3K63nHKAW2l71xDkekffR8cGiVLF63y_CuPTiwIkk1flO-l9N5_s6meahMJdWODygQ
)


==============================================================================
08-12 15:48:58  DEBUG Request: Array
(
    [access_token] => ilezMgZqp7vMdNGY6w46IJ8K9VTB-uf3MzsFLzHmOik
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=ilezMgZqp7vMdNGY6w46IJ8K9VTB-uf3MzsFLzHmOik","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:48:58  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:48:58  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 15:48:58  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 15:48:58  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5582812
    [session_id] => 2tqsm8evf8khsc86jmv1nmips3
    [auth_time] => 1439387045
)
 scopes = profile openid email

08-12 15:48:58  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:48:58  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:48:58  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:48:58  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 15:48:58  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 15:55:44  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => mK9_d0umNCdopg18iORZtAlvgDlqcOJdNy61-jv8Heo
    [state] => 5582812
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=mK9_d0umNCdopg18iORZtAlvgDlqcOJdNy61-jv8Heo&state=5582812&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:55:44  ERROR url: error:invalid_grant desc:no such code uri: state: code:400

08-12 15:55:44  ERROR HTTP/1.0 400 Bad Request
{"error":"invalid_grant","error_description":"no such code"}

==============================================================================
08-12 15:59:29  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5582812
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5582812","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:59:29  DEBUG prompt = 

08-12 15:59:29  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:59:32  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5582812
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5582812
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5582812"} []
----------------------------------------------------------

08-12 15:59:32  DEBUG Auth_time = 1439387972

08-12 15:59:32  DEBUG session id = 2tqsm8evf8khsc86jmv1nmips3

08-12 15:59:32  DEBUG prompt = 

08-12 15:59:32  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5582812
)
 scopes = profile openid email

08-12 15:59:32  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:59:32  DEBUG id_token claims = Array
(
)


08-12 15:59:32  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:59:32  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:59:32  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-12 15:59:34  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5582812
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5582812
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439387972
    [ops] => 6016ec3bec30fb322841efcf8c5ba279
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:59:34  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5582812
    [session_id] => 2tqsm8evf8khsc86jmv1nmips3
    [auth_time] => 1439387972
)
 scopes = profile openid email

08-12 15:59:34  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:59:34  DEBUG id_token claims = Array
(
)


08-12 15:59:34  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-12 15:59:34  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:59:34  DEBUG ss = sha256(spardecohttps://localhost6016ec3bec30fb322841efcf8c5ba27961850ec7907900fa18b8c4535b0d6f16).61850ec7907900fa18b8c4535b0d6f16

==============================================================================
08-12 15:59:34  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => ApKQOBBK1ix5IyNTjg6Gb4kawvDf6IO4Kcc0PpouOnM
    [state] => 5582812
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=ApKQOBBK1ix5IyNTjg6Gb4kawvDf6IO4Kcc0PpouOnM&state=5582812&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:59:34  DEBUG spardeco
client_secret_post

08-12 15:59:34  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-12 15:59:34  DEBUG no ops in sessionid 2tqsm8evf8khsc86jmv1nmips3

08-12 15:59:34  DEBUG requested idtoken claims = Array
(
)


08-12 15:59:34  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:59:34  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439388274
    [iat] => 1439387974
    [at_hash] => rHAYqa-v2o6uIH0Rr2ecCw
)


08-12 15:59:34  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:59:34  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg4Mjc0LCJpYXQiOjE0MzkzODc5NzQsImF0X2hhc2giOiJySEFZcWEtdjJvNnVJSDBScjJlY0N3In0.aaJaX6r5lNOhAVNQPAVR5rq87LgO0ZWz9T3tvCTpeZBmux5ngSDFygnnBM9uxG_c__8lLQtYwln6I8B4ogCZswPWqqxyp4kmBdm7JOOijt7NDQ0W6BrwuR-W1Fi5AaHxT_yrhhaZt-VcKIM21PhNYa9SVkcSXOyUjQ6WgM-p3OIhvg05KLm6tUCytetccJvqX48oD3TXzIjidQXwIhvrRNMN3I6GWfslFfEbyEGQKX1AX3Ndd4TXxsv0hA44ovYKDYpdl9IlagJvqdsF41Xx8n4tTN_Z_GtTYCr6RKTVKZy1FC3ZjYc9_9MQKtiJ0yZuhqNqjtDuUDmoHrWqBZRRFA

08-12 15:59:34  DEBUG token response = Array
(
    [access_token] => QqpDCtelwjG1_T7iL6eLr6Kv2u_kaH0fcF9q3Nd2-Eo
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg4Mjc0LCJpYXQiOjE0MzkzODc5NzQsImF0X2hhc2giOiJySEFZcWEtdjJvNnVJSDBScjJlY0N3In0.aaJaX6r5lNOhAVNQPAVR5rq87LgO0ZWz9T3tvCTpeZBmux5ngSDFygnnBM9uxG_c__8lLQtYwln6I8B4ogCZswPWqqxyp4kmBdm7JOOijt7NDQ0W6BrwuR-W1Fi5AaHxT_yrhhaZt-VcKIM21PhNYa9SVkcSXOyUjQ6WgM-p3OIhvg05KLm6tUCytetccJvqX48oD3TXzIjidQXwIhvrRNMN3I6GWfslFfEbyEGQKX1AX3Ndd4TXxsv0hA44ovYKDYpdl9IlagJvqdsF41Xx8n4tTN_Z_GtTYCr6RKTVKZy1FC3ZjYc9_9MQKtiJ0yZuhqNqjtDuUDmoHrWqBZRRFA
)


==============================================================================
08-12 15:59:35  DEBUG Request: Array
(
    [access_token] => QqpDCtelwjG1_T7iL6eLr6Kv2u_kaH0fcF9q3Nd2-Eo
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=QqpDCtelwjG1_T7iL6eLr6Kv2u_kaH0fcF9q3Nd2-Eo","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-12 15:59:35  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:59:35  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-12 15:59:35  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-12 15:59:35  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5582812
    [session_id] => 2tqsm8evf8khsc86jmv1nmips3
    [auth_time] => 1439387972
)
 scopes = profile openid email

08-12 15:59:35  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:59:35  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-12 15:59:35  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-12 15:59:35  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-12 15:59:35  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-12 15:59:39  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5582812
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5582812","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:59:40  DEBUG prompt = 

08-12 15:59:40  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:59:42  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6516844
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5582812
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5582812
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=6516844&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 15:59:42  DEBUG prompt = 

08-12 15:59:42  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 15:59:44  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6516844
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6516844
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=6516844&nonce=spardeco"} []
----------------------------------------------------------

08-12 15:59:44  DEBUG Auth_time = 1439387984

08-12 15:59:44  DEBUG session id = 2tqsm8evf8khsc86jmv1nmips3

08-12 15:59:44  DEBUG prompt = 

08-12 15:59:44  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6516844
    [nonce] => spardeco
)
 scopes = openid

08-12 15:59:44  DEBUG userinfo claims = Array
(
)


08-12 15:59:44  DEBUG id_token claims = Array
(
)


08-12 15:59:44  DEBUG unique keys = Array
(
)


08-12 15:59:44  DEBUG requested_claims = Array
(
)


08-12 15:59:44  INFO requested claims = Array
(
)


==============================================================================
08-12 15:59:45  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6516844
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6516844
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439387984
    [ops] => 5a16d26d6e0d410e93276786d52e1629
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 15:59:45  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6516844
    [nonce] => spardeco
    [session_id] => 2tqsm8evf8khsc86jmv1nmips3
    [auth_time] => 1439387984
)
 scopes = openid

08-12 15:59:45  DEBUG userinfo claims = Array
(
)


08-12 15:59:45  DEBUG id_token claims = Array
(
)


08-12 15:59:45  DEBUG unique keys = Array
(
)


08-12 15:59:45  DEBUG requested_claims = Array
(
)


08-12 15:59:45  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 15:59:45  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439388285
    [iat] => 1439387985
    [nonce] => spardeco
)


08-12 15:59:45  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 15:59:45  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5Mzg4Mjg1LCJpYXQiOjE0MzkzODc5ODUsIm5vbmNlIjoic3BhcmRlY28ifQ.ugs0UNEDdyY4bg4vIkcvlxxgl7PfyrT0OKjwMSkUkrPf9SjpvhwdMM6uk9M9AMJHrL6_hkuUnpmJO-c5cl1n61hgvXnY4wJ_i6xqG7hoVjaclZnpt4ouJyrdSpWv0swCGihViA8ojP9tA98gjnKAbIAdjt0EW0nz7I-UiWQKdN-vSfcmjyaxCwNlNOOzPToeWV3Jyx_-tRX025xcurVD4pewgYe0XzEkTCgwtDuJidGLSkTRK7muYI6b5qWa2KCD-VhivD6_BDbSqb8BwLvilAZy5AzG21W2atEVNFA4jVKYr99aBBv3NkRs3k7nmdPxWYtRYktmhXJ4xTiSZAA8Fw

08-12 15:59:45  DEBUG ss = sha256(spardecohttps://localhost5a16d26d6e0d410e93276786d52e1629786c6ca56c09128f98d5d32acf3a3768).786c6ca56c09128f98d5d32acf3a3768

==============================================================================
08-12 16:02:39  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6516844
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=6516844&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 16:02:39  DEBUG prompt = 

08-12 16:02:39  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 16:02:41  DEBUG Request: Array
(
    [client_id] => spardeco
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 6845919
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6516844
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 6516844
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=6845919&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 16:02:41  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 16:02:41  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_request desc:no response_type uri: state:6845919 code:400

==============================================================================
08-12 16:02:58  DEBUG Request: Array
(
    [client_id] => spardeco
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1740825
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1740825&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 16:02:58  DEBUG handle_auth exception : #0 C:\My Program Files\xampp\htdocs\oidc1\phpOp\index.php(71): handle_auth()
#1 {main}

08-12 16:02:58  ERROR url:https://localhost/oidc1/spardeco/ardecoback.php error:invalid_request desc:no response_type uri: state:1740825 code:400

==============================================================================
08-12 16:30:38  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 5065539
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=5065539&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 16:30:38  DEBUG prompt = 

08-12 16:30:38  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 16:30:42  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 5065539
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 5065539
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=5065539&nonce=spardeco"} []
----------------------------------------------------------

08-12 16:30:42  DEBUG Auth_time = 1439389842

08-12 16:30:42  DEBUG session id = 6g8k7msgc6v2339m93c8g20tp2

08-12 16:30:42  DEBUG prompt = 

08-12 16:30:42  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 5065539
    [nonce] => spardeco
)
 scopes = openid

08-12 16:30:42  DEBUG userinfo claims = Array
(
)


08-12 16:30:42  DEBUG id_token claims = Array
(
)


08-12 16:30:42  DEBUG unique keys = Array
(
)


08-12 16:30:42  DEBUG requested_claims = Array
(
)


08-12 16:30:42  INFO requested claims = Array
(
)


==============================================================================
08-12 16:31:46  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 5065539
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 5065539
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439389842
    [ops] => 047e7a907ba5a241d3af595572cc6e41
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 16:31:47  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 5065539
    [nonce] => spardeco
    [session_id] => 6g8k7msgc6v2339m93c8g20tp2
    [auth_time] => 1439389842
)
 scopes = openid

08-12 16:31:47  DEBUG userinfo claims = Array
(
)


08-12 16:31:47  DEBUG id_token claims = Array
(
)


08-12 16:31:47  DEBUG unique keys = Array
(
)


08-12 16:31:47  DEBUG requested_claims = Array
(
)


08-12 16:31:47  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 16:31:47  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439390207
    [iat] => 1439389907
    [nonce] => spardeco
)


08-12 16:31:47  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 16:31:47  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzkwMjA3LCJpYXQiOjE0MzkzODk5MDcsIm5vbmNlIjoic3BhcmRlY28ifQ.IojwULwg-YoVvv4vHwD8Wa_1GqtLscJ0p8WEiDa1gj1Wnt_N5JvxV79JMdfWxeMOsas00QPs6U8cIRRI34xLUgi2Szk1tTT2NuEMjqazyS5p2W9oz0OPQGqjCQBmxF69DQUDYAo6X0mrZDldZ4HaO_GQ68xFyTLocUVTpb-qZMLoxCOiFctM8oc4SDAMTVX7eB7B3AVdsKVy_NwYKElMaA0awiB2Zk3JTUm72_jhiLx0UmS3k3W9_j-RSRSDaDEOwjPU0XKjL_pPw_t_ggtC9lLbev0d8uC4z0kXxyR7Ek9PF4mJrh-ulZgLx-PsxniTF3afJ-eLhEv9OPB_wvHNvQ

08-12 16:31:47  DEBUG ss = sha256(spardecohttps://localhost047e7a907ba5a241d3af595572cc6e41e0571c62641fa72aeec3674339c7b93c).e0571c62641fa72aeec3674339c7b93c

==============================================================================
08-12 16:55:50  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 4084333
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=4084333&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 16:55:50  DEBUG prompt = 

08-12 16:55:50  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 16:55:52  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 4084333
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 4084333
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=4084333&nonce=spardeco"} []
----------------------------------------------------------

08-12 16:55:52  DEBUG Auth_time = 1439391352

08-12 16:55:52  DEBUG session id = 6g8k7msgc6v2339m93c8g20tp2

08-12 16:55:52  DEBUG prompt = 

08-12 16:55:52  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 4084333
    [nonce] => spardeco
)
 scopes = openid

08-12 16:55:52  DEBUG userinfo claims = Array
(
)


08-12 16:55:52  DEBUG id_token claims = Array
(
)


08-12 16:55:52  DEBUG unique keys = Array
(
)


08-12 16:55:52  DEBUG requested_claims = Array
(
)


08-12 16:55:52  INFO requested claims = Array
(
)


==============================================================================
08-12 16:55:54  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 4084333
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 4084333
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439391352
    [ops] => f726646fc55fecb7c5db92babbbae3b2
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 16:55:54  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 4084333
    [nonce] => spardeco
    [session_id] => 6g8k7msgc6v2339m93c8g20tp2
    [auth_time] => 1439391352
)
 scopes = openid

08-12 16:55:54  DEBUG userinfo claims = Array
(
)


08-12 16:55:54  DEBUG id_token claims = Array
(
)


08-12 16:55:54  DEBUG unique keys = Array
(
)


08-12 16:55:54  DEBUG requested_claims = Array
(
)


08-12 16:55:54  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 16:55:54  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439391654
    [iat] => 1439391354
    [nonce] => spardeco
)


08-12 16:55:54  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 16:55:54  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzkxNjU0LCJpYXQiOjE0MzkzOTEzNTQsIm5vbmNlIjoic3BhcmRlY28ifQ.Rro4vPTDp_3zkmGw6adGE0diR7jP3qGsocJHQuMrvSUU2hIiTRnsMJuX0ElmY6E8l9Z80_N649EtZevenDCtBJEf1casJJ8xx_lTtHoSutAC-68kJIvih9ZHCDSQ-usfAPFsdE9DbLrm54FwbBjh9UXLqQds9Y9-Lk-42_Gc6iP7MkIIcCnVdthMpmaT1c7sdgtNFI7DjoKN8H_FdN_YEUNtU8TFZ1ToADJF35dWbZs6RgJf3IVdqslr5YtfsUXuAhi7qAvRyQaOt5Xrhg-v5eSSSf3eozjEyNDbmFQrOIHHbW5cMhhi3h6_3rVHKFChfjy01f9ZIDdHogDiROpwXg

08-12 16:55:54  DEBUG ss = sha256(spardecohttps://localhostf726646fc55fecb7c5db92babbbae3b26c9fc42d2e0591a0e32cf54a4cf2fd89).6c9fc42d2e0591a0e32cf54a4cf2fd89

==============================================================================
08-12 16:57:09  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 16:57:09  DEBUG prompt = 

08-12 16:57:09  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 16:57:11  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco"} []
----------------------------------------------------------

08-12 16:57:11  DEBUG Auth_time = 1439391431

08-12 16:57:11  DEBUG session id = 6g8k7msgc6v2339m93c8g20tp2

08-12 16:57:11  DEBUG prompt = 

08-12 16:57:11  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)
 scopes = openid

08-12 16:57:11  DEBUG userinfo claims = Array
(
)


08-12 16:57:11  DEBUG id_token claims = Array
(
)


08-12 16:57:11  DEBUG unique keys = Array
(
)


08-12 16:57:11  DEBUG requested_claims = Array
(
)


08-12 16:57:11  INFO requested claims = Array
(
)


==============================================================================
08-12 16:57:12  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439391431
    [ops] => 75ddbc47d5562996f3f7e4444a76aa03
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 16:57:12  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
    [session_id] => 6g8k7msgc6v2339m93c8g20tp2
    [auth_time] => 1439391431
)
 scopes = openid

08-12 16:57:12  DEBUG userinfo claims = Array
(
)


08-12 16:57:12  DEBUG id_token claims = Array
(
)


08-12 16:57:12  DEBUG unique keys = Array
(
)


08-12 16:57:12  DEBUG requested_claims = Array
(
)


08-12 16:57:12  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 16:57:12  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439391732
    [iat] => 1439391432
    [nonce] => spardeco
)


08-12 16:57:12  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 16:57:12  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzkxNzMyLCJpYXQiOjE0MzkzOTE0MzIsIm5vbmNlIjoic3BhcmRlY28ifQ.gP91y4yagFSC1tb4Ei__mGKw7MwqCVbxZthXobrEmcIQCZ_fwF2m83KUtkDR7Hd17-zb4X7TW2bpyBuMwqw2Y8sh0EFW8nbEKuqiUA6Z0Awork56M3TgC4Ac5tGWvUgDV_BISpqD0umTpUGfaOadk9y98lhTBd10FjYzWYz05_TyShBUv4J4nfybTfcmZP3NYR_zOeC6TCt8gfNZ66t1CvnQT4IGn7wKUZ2gTS3WntQ_qy69MEP2ZJj5wuIryaawikvOs9-c33oekROtuvGdRmXjuXn0bkVXCf72IwBNQ4rDhxjyaVj8V1L7YdjV1j8UmGVeXdktvI1xLuTcwbjr_w

08-12 16:57:12  DEBUG ss = sha256(spardecohttps://localhost75ddbc47d5562996f3f7e4444a76aa0378739be7cd011b3d3195c97f4b6de391).78739be7cd011b3d3195c97f4b6de391

==============================================================================
08-12 16:58:01  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 16:58:01  DEBUG prompt = 

08-12 16:58:01  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 16:58:02  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco"} []
----------------------------------------------------------

08-12 16:58:02  DEBUG Auth_time = 1439391482

08-12 16:58:02  DEBUG session id = 6g8k7msgc6v2339m93c8g20tp2

08-12 16:58:02  DEBUG prompt = 

08-12 16:58:02  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)
 scopes = openid

08-12 16:58:02  DEBUG userinfo claims = Array
(
)


08-12 16:58:02  DEBUG id_token claims = Array
(
)


08-12 16:58:02  DEBUG unique keys = Array
(
)


08-12 16:58:02  DEBUG requested_claims = Array
(
)


08-12 16:58:02  INFO requested claims = Array
(
)


==============================================================================
08-12 16:58:04  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439391482
    [ops] => da310280b4586a96ff1a7010b60c26b8
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 16:58:04  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
    [session_id] => 6g8k7msgc6v2339m93c8g20tp2
    [auth_time] => 1439391482
)
 scopes = openid

08-12 16:58:04  DEBUG userinfo claims = Array
(
)


08-12 16:58:04  DEBUG id_token claims = Array
(
)


08-12 16:58:04  DEBUG unique keys = Array
(
)


08-12 16:58:04  DEBUG requested_claims = Array
(
)


08-12 16:58:04  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 16:58:04  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439391784
    [iat] => 1439391484
    [nonce] => spardeco
)


08-12 16:58:04  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 16:58:04  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzkxNzg0LCJpYXQiOjE0MzkzOTE0ODQsIm5vbmNlIjoic3BhcmRlY28ifQ.LbiMFehY_ZtHOJbX4wkt1UUu8vEAad2hHaZu2k1IcOyYYHLIcyUlm0E0qMxSPqED5jLD_Xa9Skd_HJaDZGp5OWgbCh1iQdrxXUG7rjojAtMA9VsSOEo7x1pCOj5uXmvPFWhJ9DJ3Ik54j889U6QIdbpQKaejLbOba55JOBRHBjEJ9ehhLQP00KC86SU4vv1lyX7rUnqplbwfEu-jpkxBjLQXCN0Euoct__XZEckb109ggkkEDlv8kQRAgxEDxeME3bK52gZdcRKieMQHhCTWf_z4BoRYnc-hWHM_do2x6Ro9IHt_35CKZOhs-R5YYbWeJDg_oM5mSE51xKW---3FHw

08-12 16:58:04  DEBUG ss = sha256(spardecohttps://localhostda310280b4586a96ff1a7010b60c26b8688a03816ec7fcf053d999c514d74593).688a03816ec7fcf053d999c514d74593

==============================================================================
08-12 16:59:34  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 16:59:34  DEBUG prompt = 

08-12 16:59:34  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 17:00:00  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco"} []
----------------------------------------------------------

08-12 17:00:00  DEBUG Auth_time = 1439391600

08-12 17:00:00  DEBUG session id = 6g8k7msgc6v2339m93c8g20tp2

08-12 17:00:00  DEBUG prompt = 

08-12 17:00:00  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)
 scopes = openid

08-12 17:00:00  DEBUG userinfo claims = Array
(
)


08-12 17:00:00  DEBUG id_token claims = Array
(
)


08-12 17:00:00  DEBUG unique keys = Array
(
)


08-12 17:00:00  DEBUG requested_claims = Array
(
)


08-12 17:00:00  INFO requested claims = Array
(
)


==============================================================================
08-12 17:00:02  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439391600
    [ops] => aa47e50325412d6379e372c4536f91c6
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 17:00:02  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
    [session_id] => 6g8k7msgc6v2339m93c8g20tp2
    [auth_time] => 1439391600
)
 scopes = openid

08-12 17:00:02  DEBUG userinfo claims = Array
(
)


08-12 17:00:02  DEBUG id_token claims = Array
(
)


08-12 17:00:02  DEBUG unique keys = Array
(
)


08-12 17:00:02  DEBUG requested_claims = Array
(
)


08-12 17:00:02  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 17:00:02  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439391902
    [iat] => 1439391602
    [nonce] => spardeco
)


08-12 17:00:02  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 17:00:02  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzkxOTAyLCJpYXQiOjE0MzkzOTE2MDIsIm5vbmNlIjoic3BhcmRlY28ifQ.g-1D9ftasUVLal3QqMmwHTv_6CMAxjRneF0MeFbRsq5OsYkOEUF2dMDmnhU3oy60K6voxet-msheJyApOdyOVVNVD26r3S3fDFzhGnHTgzYT2sWuLQZphXqheb7fp_Lpg5SLtcp39KdSbiOX2B8wWm-HzpVhsufMOltwDUfi76DzfzTLA63vrhqQT9JrE_M-8dnK7B7BbOlHqEzVhTNORhvSH_Pmf30Q8PmPMEYenCRkWFoU_cQTfAoRzUFRb32nzV-Se842S2KpQsFt7YQLmTPyXcoJ42jsSEP5jxcF7CxLqgGO-42x9xnT2nrzXah_Q0il4RISzaivqELLlUMnCg

08-12 17:00:02  DEBUG ss = sha256(spardecohttps://localhostaa47e50325412d6379e372c4536f91c6898054353638d71af0c60f28e1e01973).898054353638d71af0c60f28e1e01973

==============================================================================
08-12 17:01:26  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 17:01:26  DEBUG prompt = 

08-12 17:01:26  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 17:01:27  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco"} []
----------------------------------------------------------

08-12 17:01:27  DEBUG Auth_time = 1439391687

08-12 17:01:27  DEBUG session id = 6g8k7msgc6v2339m93c8g20tp2

08-12 17:01:27  DEBUG prompt = 

08-12 17:01:27  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)
 scopes = openid

08-12 17:01:27  DEBUG userinfo claims = Array
(
)


08-12 17:01:27  DEBUG id_token claims = Array
(
)


08-12 17:01:27  DEBUG unique keys = Array
(
)


08-12 17:01:27  DEBUG requested_claims = Array
(
)


08-12 17:01:27  INFO requested claims = Array
(
)


==============================================================================
08-12 17:01:29  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439391687
    [ops] => 0b6e2208bbca42805d6a8ea09dab9a7d
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 17:01:29  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
    [session_id] => 6g8k7msgc6v2339m93c8g20tp2
    [auth_time] => 1439391687
)
 scopes = openid

08-12 17:01:29  DEBUG userinfo claims = Array
(
)


08-12 17:01:29  DEBUG id_token claims = Array
(
)


08-12 17:01:29  DEBUG unique keys = Array
(
)


08-12 17:01:29  DEBUG requested_claims = Array
(
)


08-12 17:01:29  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 17:01:29  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439391989
    [iat] => 1439391689
    [nonce] => spardeco
)


08-12 17:01:29  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 17:01:29  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzkxOTg5LCJpYXQiOjE0MzkzOTE2ODksIm5vbmNlIjoic3BhcmRlY28ifQ.ty9nh3TfHzlN02tYM6rib5zQuZpzzwVG_qGb_Rm_dqVn_2A3tg8yLHw-lLbd0cwvwVTxeIoP-q17cWCTm32yXsRS_sVJ8oYTGl25mHo5WP2KGsAgi88niSPIuIUR7YaZZf9ZGB7cA7rW629FC8jlliajnnttIN_jlCPjsHDSkv4MiFE4fnZgBTj-75wg5vpFV8mAGuaKg9mfXHm5-KFj-4bYn8gFjoNa1TdEO8UGq81KbPztj31jjlE1KiLXojxclEfSEhNALVphl2RnNK6cTeH7FQ1T-6d9vtSA4xBQhiibQEa1QhO7fEFCCOWlaoYCZBtlbyz8213qc1es8GQmDw

08-12 17:01:29  DEBUG ss = sha256(spardecohttps://localhost0b6e2208bbca42805d6a8ea09dab9a7db39db7f23576f70e9ea8816c742eb313).b39db7f23576f70e9ea8816c742eb313

==============================================================================
08-12 17:04:52  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 17:04:52  DEBUG prompt = 

08-12 17:04:52  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 17:04:54  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco"} []
----------------------------------------------------------

08-12 17:04:54  DEBUG Auth_time = 1439391894

08-12 17:04:54  DEBUG session id = 6g8k7msgc6v2339m93c8g20tp2

08-12 17:04:54  DEBUG prompt = 

08-12 17:04:54  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)
 scopes = openid

08-12 17:04:54  DEBUG userinfo claims = Array
(
)


08-12 17:04:54  DEBUG id_token claims = Array
(
)


08-12 17:04:54  DEBUG unique keys = Array
(
)


08-12 17:04:54  DEBUG requested_claims = Array
(
)


08-12 17:04:54  INFO requested claims = Array
(
)


==============================================================================
08-12 17:04:55  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439391894
    [ops] => 67ca4abb9458af21e0a3b75b77841a63
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 17:04:55  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
    [session_id] => 6g8k7msgc6v2339m93c8g20tp2
    [auth_time] => 1439391894
)
 scopes = openid

08-12 17:04:55  DEBUG userinfo claims = Array
(
)


08-12 17:04:55  DEBUG id_token claims = Array
(
)


08-12 17:04:55  DEBUG unique keys = Array
(
)


08-12 17:04:55  DEBUG requested_claims = Array
(
)


08-12 17:04:55  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 17:04:55  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439392195
    [iat] => 1439391895
    [nonce] => spardeco
)


08-12 17:04:55  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 17:04:55  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzkyMTk1LCJpYXQiOjE0MzkzOTE4OTUsIm5vbmNlIjoic3BhcmRlY28ifQ.WpGpDua4RLRrXAK6qsWxjM4OtBButSdC3-kxkozOfBf9DHtRf8x2gE9IRWIlPr2og0poOfSJw3_tjTSRWBLc_Sh02Nd-Wis-ZiaJ_gLk_I0a4buvMY6EyFUJjaWX2U0OuDTRvKoo-20hwi3Y3HHe2rTBsXtooO670GtEQ5uAuhncMEtFfo55ZZT2-tlf1Knu8vDHbLcnYBb8-JCAos9eno0OhAfDHQ0ykM-YJSf31D57y88Q4q6Q1NzREdCUFHtQMlBcUrh-rckRH121ErKyddVlqQAE0nU7SdedVyvEU7fYM_VqQMw_qXzGdGt8EcnGlTdYwaMZweiRnsD13VDsWA

08-12 17:04:55  DEBUG ss = sha256(spardecohttps://localhost67ca4abb9458af21e0a3b75b77841a63cd4db360096257276ecdb79994ec2041).cd4db360096257276ecdb79994ec2041

==============================================================================
08-12 17:05:14  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 17:05:14  DEBUG prompt = 

08-12 17:05:14  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 17:05:42  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco"} []
----------------------------------------------------------

08-12 17:05:42  DEBUG Auth_time = 1439391942

08-12 17:05:42  DEBUG session id = 6g8k7msgc6v2339m93c8g20tp2

08-12 17:05:42  DEBUG prompt = 

08-12 17:05:42  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)
 scopes = openid

08-12 17:05:42  DEBUG userinfo claims = Array
(
)


08-12 17:05:42  DEBUG id_token claims = Array
(
)


08-12 17:05:42  DEBUG unique keys = Array
(
)


08-12 17:05:42  DEBUG requested_claims = Array
(
)


08-12 17:05:42  INFO requested claims = Array
(
)


==============================================================================
08-12 17:05:44  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439391942
    [ops] => 6f32687a75407a10b98a2b12234f62af
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 17:05:44  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
    [session_id] => 6g8k7msgc6v2339m93c8g20tp2
    [auth_time] => 1439391942
)
 scopes = openid

08-12 17:05:44  DEBUG userinfo claims = Array
(
)


08-12 17:05:44  DEBUG id_token claims = Array
(
)


08-12 17:05:44  DEBUG unique keys = Array
(
)


08-12 17:05:44  DEBUG requested_claims = Array
(
)


08-12 17:05:44  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 17:05:44  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439392244
    [iat] => 1439391944
    [nonce] => spardeco
)


08-12 17:05:44  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 17:05:44  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzkyMjQ0LCJpYXQiOjE0MzkzOTE5NDQsIm5vbmNlIjoic3BhcmRlY28ifQ.Oy3ppao4JpkXahSPo5acJaNpBZyu1ucxBtXB-VrtYQzMpOie2RT_JFle1PaDAsBr1TtB9FsG__Y6A0AeoVbrDedruRiwRxeBJSccj2UrTVMFCVD1tcoo4Rvox53WQ5yhQcHFzTBaVeo5Ar78u9rSe7ApRb7-COSkyNXC0gYx6VKlPBO4bxjEvyCLmzyrNEX9DYDkMTPQX0K5ok_Zzp46WNhu9cNycJWbxk6SlRKPfGa3fKWs3YnGi0dbRur8tc7lwexPkwhxHqZzAfjR_OijprKh0brofU6SjKkVEfNJkX6GzLI9ph9JWn3_WjI3Rt1HEQcioxMcFhRtH_OgJqYxdw

08-12 17:05:44  DEBUG ss = sha256(spardecohttps://localhost6f32687a75407a10b98a2b12234f62af6b79a661c86021b3c6a6db5bdf2d58e6).6b79a661c86021b3c6a6db5bdf2d58e6

==============================================================================
08-12 17:05:49  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-12 17:05:49  DEBUG prompt = 

08-12 17:05:49  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-12 17:07:12  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=1738171&nonce=spardeco"} []
----------------------------------------------------------

08-12 17:07:12  DEBUG Auth_time = 1439392032

08-12 17:07:12  DEBUG session id = 6g8k7msgc6v2339m93c8g20tp2

08-12 17:07:12  DEBUG prompt = 

08-12 17:07:12  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
)
 scopes = openid

08-12 17:07:12  DEBUG userinfo claims = Array
(
)


08-12 17:07:12  DEBUG id_token claims = Array
(
)


08-12 17:07:12  DEBUG unique keys = Array
(
)


08-12 17:07:12  DEBUG requested_claims = Array
(
)


08-12 17:07:12  INFO requested claims = Array
(
)


==============================================================================
08-12 17:07:13  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 1738171
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439392032
    [ops] => 3c225964a9de0e7fa5c27ec125c88d50
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-12 17:07:13  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 1738171
    [nonce] => spardeco
    [session_id] => 6g8k7msgc6v2339m93c8g20tp2
    [auth_time] => 1439392032
)
 scopes = openid

08-12 17:07:13  DEBUG userinfo claims = Array
(
)


08-12 17:07:13  DEBUG id_token claims = Array
(
)


08-12 17:07:13  DEBUG unique keys = Array
(
)


08-12 17:07:13  DEBUG requested_claims = Array
(
)


08-12 17:07:13  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-12 17:07:13  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439392333
    [iat] => 1439392033
    [nonce] => spardeco
)


08-12 17:07:13  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-12 17:07:13  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5MzkyMzMzLCJpYXQiOjE0MzkzOTIwMzMsIm5vbmNlIjoic3BhcmRlY28ifQ.M7ql_BcFtOVbL6itTrqPCf5jWd-qBVUR9VCn7yl44FxvtsKqV0KND_h_YIUIZZe2LoAiJZMzbb59TxiJp6gKPMdA3LFBouhrhTcJcbXqgmvDFHn9UvxD9eSCqQmoQZshqvsBHIlJjyp3-6Wv-fpWEXVwgt-Db8SRtU8gPvwuxp89uDE6msh8PA7eCSiPPv5FR9_hEakZDOSwrA_QU1Bx8kMc7SrnV7OwkB0__mtK-WVFw5Nmi2bs3_zpeaEBAJgGwbyGkUnspnLvaUDZr7Y5qw_80yW44sNT0a-EzmjVuqGmBU-EHlcZci-1CCzWyjkhosrrtZIfLRVPeXd4LH0xMg

08-12 17:07:13  DEBUG ss = sha256(spardecohttps://localhost3c225964a9de0e7fa5c27ec125c88d50908bf00650c3c1536a0701f0c3d35831).908bf00650c3c1536a0701f0c3d35831

==============================================================================
08-13 10:12:24  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8982756
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8982756&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 10:12:25  DEBUG prompt = 

08-13 10:12:25  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 10:12:28  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8982756
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8982756
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=8982756&nonce=spardeco"} []
----------------------------------------------------------

08-13 10:12:28  DEBUG Auth_time = 1439453548

08-13 10:12:28  DEBUG session id = a7ojrupp52uj1solsbd9kr6vd1

08-13 10:12:28  DEBUG prompt = 

08-13 10:12:28  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8982756
    [nonce] => spardeco
)
 scopes = openid

08-13 10:12:28  DEBUG userinfo claims = Array
(
)


08-13 10:12:28  DEBUG id_token claims = Array
(
)


08-13 10:12:28  DEBUG unique keys = Array
(
)


08-13 10:12:28  DEBUG requested_claims = Array
(
)


08-13 10:12:28  INFO requested claims = Array
(
)


==============================================================================
08-13 10:12:42  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8982756
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 8982756
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439453548
    [ops] => 1a964bb366ffaaea443bc63ed143cf6a
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-13 10:12:42  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 8982756
    [nonce] => spardeco
    [session_id] => a7ojrupp52uj1solsbd9kr6vd1
    [auth_time] => 1439453548
)
 scopes = openid

08-13 10:12:42  DEBUG userinfo claims = Array
(
)


08-13 10:12:42  DEBUG id_token claims = Array
(
)


08-13 10:12:42  DEBUG unique keys = Array
(
)


08-13 10:12:42  DEBUG requested_claims = Array
(
)


08-13 10:12:42  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-13 10:12:42  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439453862
    [iat] => 1439453562
    [nonce] => spardeco
)


08-13 10:12:42  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-13 10:12:42  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDUzODYyLCJpYXQiOjE0Mzk0NTM1NjIsIm5vbmNlIjoic3BhcmRlY28ifQ.nuncaxBK1-n1qaSYoh0eg1rJkcQgFq7q8_dObZyKk_6uV9Om-H17FDACao0-9tzd1Ahz7vFUEqP8CpXluCoFmpHLIALuZTqtZspz5WijViFp18Fd8ue5bWkKj-N8EC1IoEXaT1sN1u20hDWG0jQS65qpinxxcztXiaU6hllPLRpzTvxeZ8r4KFqCR_cGkqQHZHDzsFB7R8gqAxx1mVNiMwwl160RbFE3rWyTZvHFIIduAYVkvd6z2jF_wL4TcfNKt5ZeWL93AObBYhVdni5w4fMvbPWxmTKR-Gk6ialrihYNIzoQHspJ7dk59_c7hrIZJeC07Sbb6ETRhXJ0LRclcQ

08-13 10:12:42  DEBUG ss = sha256(spardecohttps://localhost1a964bb366ffaaea443bc63ed143cf6a0f73703fbc4d69fbe89e2b795dddebdb).0f73703fbc4d69fbe89e2b795dddebdb

==============================================================================
08-13 10:21:27  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8895435
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8895435","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 10:21:27  DEBUG prompt = 

08-13 10:21:27  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 10:21:38  DEBUG Request: Array
(
    [username] => simon
    [password] => toto
)

Input: username=simon&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8895435
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8895435
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8895435"} []
----------------------------------------------------------

08-13 10:21:38  DEBUG Auth_time = 1439454098

08-13 10:21:38  DEBUG session id = a7ojrupp52uj1solsbd9kr6vd1

08-13 10:21:38  DEBUG prompt = 

08-13 10:21:38  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8895435
)
 scopes = profile openid email

08-13 10:21:38  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 10:21:38  DEBUG id_token claims = Array
(
)


08-13 10:21:38  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 10:21:38  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 10:21:38  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-13 10:21:43  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8895435
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8895435
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439454098
    [ops] => 8978a1e9e6996e3febb898ab07a22174
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-13 10:21:43  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8895435
    [session_id] => a7ojrupp52uj1solsbd9kr6vd1
    [auth_time] => 1439454098
)
 scopes = profile openid email

08-13 10:21:43  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 10:21:43  DEBUG id_token claims = Array
(
)


08-13 10:21:43  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 10:21:43  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 10:21:43  DEBUG ss = sha256(spardecohttps://localhost8978a1e9e6996e3febb898ab07a22174d6c59e10f6527fb18be65a44e31d4881).d6c59e10f6527fb18be65a44e31d4881

==============================================================================
08-13 10:21:43  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => yIzJafpwoXAglXiDLJbD55rbY-XWrXxuulcVVftbYN0
    [state] => 8895435
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=yIzJafpwoXAglXiDLJbD55rbY-XWrXxuulcVVftbYN0&state=8895435&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 10:21:43  DEBUG spardeco
client_secret_post

08-13 10:21:43  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-13 10:21:43  DEBUG no ops in sessionid a7ojrupp52uj1solsbd9kr6vd1

08-13 10:21:43  DEBUG requested idtoken claims = Array
(
)


08-13 10:21:43  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-13 10:21:43  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439454403
    [iat] => 1439454103
    [at_hash] => u9AOb1ugW3qSn8QZvRP_HQ
)


08-13 10:21:43  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-13 10:21:43  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDU0NDAzLCJpYXQiOjE0Mzk0NTQxMDMsImF0X2hhc2giOiJ1OUFPYjF1Z1czcVNuOFFadlJQX0hRIn0.DKsEn9NtR9gbrzuPRLmxSOB9s1O_z3RzfMW00Y06PCS8wDW7CFWp_2gWHQD606Krf9CiE-3mvRF2i12TSh1p5sQzt8lSl8_ClBMdUaNLwvXqPKo_7Ok0Z9f_M2zTpac_9VBcNg0IqyQUeZ_8vAnIJHNNFcxqf3aXbBob39Fx5A9fJVUTMlZuaTlqor3vartIUJdjuw5m20SrXeyu9MZsxjgSfjyxzPoA89EPG5WksdAtGdX0Ij-uWgRlWr3_Qo04J7iSfnBuMx3ZAws6odZlmqkHvBpi8-TnqOWFVUFLbn25nDEszkravRYZQQ7YbwcJ_AZ0Jk9Kauhzzn7QUW3yoA

08-13 10:21:43  DEBUG token response = Array
(
    [access_token] => k3kpeadCkXt0fkAjBX4qLqZmJ08klpvJJop1VhaWcGg
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDU0NDAzLCJpYXQiOjE0Mzk0NTQxMDMsImF0X2hhc2giOiJ1OUFPYjF1Z1czcVNuOFFadlJQX0hRIn0.DKsEn9NtR9gbrzuPRLmxSOB9s1O_z3RzfMW00Y06PCS8wDW7CFWp_2gWHQD606Krf9CiE-3mvRF2i12TSh1p5sQzt8lSl8_ClBMdUaNLwvXqPKo_7Ok0Z9f_M2zTpac_9VBcNg0IqyQUeZ_8vAnIJHNNFcxqf3aXbBob39Fx5A9fJVUTMlZuaTlqor3vartIUJdjuw5m20SrXeyu9MZsxjgSfjyxzPoA89EPG5WksdAtGdX0Ij-uWgRlWr3_Qo04J7iSfnBuMx3ZAws6odZlmqkHvBpi8-TnqOWFVUFLbn25nDEszkravRYZQQ7YbwcJ_AZ0Jk9Kauhzzn7QUW3yoA
)


==============================================================================
08-13 10:21:43  DEBUG Request: Array
(
    [access_token] => k3kpeadCkXt0fkAjBX4qLqZmJ08klpvJJop1VhaWcGg
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=k3kpeadCkXt0fkAjBX4qLqZmJ08klpvJJop1VhaWcGg","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 10:21:44  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-13 10:21:44  DEBUG wrapped |wFF#9yFk6Ca unwrapped = 1:simon

08-13 10:21:44  DEBUG userid = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8  unwrapped = simon

08-13 10:21:44  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8895435
    [session_id] => a7ojrupp52uj1solsbd9kr6vd1
    [auth_time] => 1439454098
)
 scopes = profile openid email

08-13 10:21:44  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 10:21:44  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 10:21:44  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 10:21:44  DEBUG returning = Array
(
    [birthdate] => 1898
    [email] => simon.becot@orange.com
    [email_verified] => 1
    [family_name] => Becot
    [gender] => male
    [given_name] => Simon
    [locale] => fr
    [middle_name] => 
    [name] => Simon Becot
    [nickname] => 
    [picture] => https://localhost/phpOp/profiles/pic.jpg
    [preferred_username] => 
    [profile] => http://profile/simon
    [updated_at] => 
    [website] => http://website
    [zoneinfo] => 
)


08-13 10:21:44  DEBUG userinfo response = {"sub":"c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8","birthdate":"1898","email":"simon.becot@orange.com","email_verified":true,"family_name":"Becot","gender":"male","given_name":"Simon","locale":"fr","middle_name":null,"name":"Simon Becot","nickname":null,"picture":"https:\/\/localhost\/phpOp\/profiles\/pic.jpg","preferred_username":null,"profile":"http:\/\/profile\/simon","updated_at":null,"website":"http:\/\/website","zoneinfo":null}

==============================================================================
08-13 10:22:10  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5740475
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5740475","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 10:22:10  DEBUG prompt = 

08-13 10:22:10  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 10:22:12  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5740475
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5740475
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5740475"} []
----------------------------------------------------------

08-13 10:22:12  DEBUG Auth_time = 1439454132

08-13 10:22:12  DEBUG session id = a7ojrupp52uj1solsbd9kr6vd1

08-13 10:22:12  DEBUG prompt = 

08-13 10:22:12  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5740475
)
 scopes = profile openid email

08-13 10:22:12  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 10:22:12  DEBUG id_token claims = Array
(
)


08-13 10:22:12  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 10:22:12  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 10:22:12  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-13 10:27:46  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5740475
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5740475
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5740475
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439454132
    [ops] => a0d208e1be1d73c7ba57edaa2916b5b2
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5740475","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 10:27:46  DEBUG prompt = 

08-13 10:27:46  DEBUG num prompt = 0 Array
(
)


08-13 10:27:46  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5740475
)
 scopes = profile openid email

08-13 10:27:46  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 10:27:46  DEBUG id_token claims = Array
(
)


08-13 10:27:46  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 10:27:46  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 10:27:46  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-13 10:27:50  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8421821
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5740475
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5740475
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439454132
    [ops] => a0d208e1be1d73c7ba57edaa2916b5b2
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8421821","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 10:27:50  DEBUG prompt = 

08-13 10:27:50  DEBUG num prompt = 0 Array
(
)


08-13 10:27:50  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8421821
)
 scopes = profile openid email

08-13 10:27:50  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 10:27:50  DEBUG id_token claims = Array
(
)


08-13 10:27:50  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 10:27:50  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 10:27:50  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-13 10:28:30  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 3585324
    [nonce] => spardeco
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8421821
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8421821
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439454132
    [ops] => a0d208e1be1d73c7ba57edaa2916b5b2
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=3585324&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 10:28:30  DEBUG prompt = 

08-13 10:28:30  DEBUG num prompt = 0 Array
(
)


08-13 10:28:30  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 3585324
    [nonce] => spardeco
)
 scopes = openid

08-13 10:28:30  DEBUG userinfo claims = Array
(
)


08-13 10:28:30  DEBUG id_token claims = Array
(
)


08-13 10:28:30  DEBUG unique keys = Array
(
)


08-13 10:28:30  DEBUG requested_claims = Array
(
)


08-13 10:28:30  INFO requested claims = Array
(
)


==============================================================================
08-13 10:29:31  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => always
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=always&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 3585324
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 3585324
            [nonce] => spardeco
        )

    [login] => 1
    [username] => alice
    [persist] => 
    [auth_time] => 1439454132
    [ops] => a0d208e1be1d73c7ba57edaa2916b5b2
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=3585324&nonce=spardeco"} []
----------------------------------------------------------

08-13 10:29:31  DEBUG Trust = Always for spardeco

08-13 10:29:31  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 3585324
    [nonce] => spardeco
    [session_id] => a7ojrupp52uj1solsbd9kr6vd1
    [auth_time] => 1439454132
)
 scopes = openid

08-13 10:29:31  DEBUG userinfo claims = Array
(
)


08-13 10:29:31  DEBUG id_token claims = Array
(
)


08-13 10:29:31  DEBUG unique keys = Array
(
)


08-13 10:29:31  DEBUG requested_claims = Array
(
)


08-13 10:29:31  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-13 10:29:31  DEBUG sen_response id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439454871
    [iat] => 1439454571
    [nonce] => spardeco
)


08-13 10:29:31  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-13 10:29:31  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDU0ODcxLCJpYXQiOjE0Mzk0NTQ1NzEsIm5vbmNlIjoic3BhcmRlY28ifQ.WXp3VAL3qQr_RMh2sRfTRQtfJz9yMO2p96WH4dAOcZReLgQbOiLC00CnlTONZnCIHvg6D-FOTNdyDQA58VV1CJmB7pV5PO76VBdvpH-h22wt6wkKOEENt4wZGr2om096E6wxIqkanwAqeiC5DayjqUJEY8xepYIfp31xrrjO-n15aAoahN350RqB8F3iNcm_3szg3ZZgW_0Wg7BDfaB-Tf2uEFCBKsInlklO0xPQ-b7gN8lkZSNTqWrQUu7ObYL5p8k0aiEdQpfQxkvmiupVtMNe9Ctqrf40ob04yKWZIBWQNJx9R6MhnGiK0V4OxcWFZxOa6JsWG34WjLKUXY1kiQ

08-13 10:29:31  DEBUG ss = sha256(spardecohttps://localhosta0d208e1be1d73c7ba57edaa2916b5b246b8fe270e2a058f646b1eba82255257).46b8fe270e2a058f646b1eba82255257

==============================================================================
08-13 10:29:33  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => id_token
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => openid
    [state] => 3585324
    [nonce] => spardeco
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=id_token&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=openid&state=3585324&nonce=spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 10:29:33  DEBUG prompt = 

08-13 10:29:33  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 10:29:37  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5933841
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 3585324
            [nonce] => spardeco
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => id_token
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => openid
            [state] => 3585324
            [nonce] => spardeco
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5933841","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 10:29:37  DEBUG prompt = 

08-13 10:29:37  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 10:29:40  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5933841"} []
----------------------------------------------------------

08-13 10:29:40  DEBUG Auth_time = 1439454580

08-13 10:29:40  DEBUG session id = a7ojrupp52uj1solsbd9kr6vd1

08-13 10:29:40  DEBUG prompt = 

08-13 10:29:40  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5933841
    [session_id] => a7ojrupp52uj1solsbd9kr6vd1
    [auth_time] => 1439454580
)
 scopes = profile openid email

08-13 10:29:40  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 10:29:40  DEBUG id_token claims = Array
(
)


08-13 10:29:40  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 10:29:40  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 10:29:40  DEBUG ss = sha256(spardecohttps://localhost4ad73298fbf1bf62336ebd1dbcebcf764dc87ba995e5855e2bc80e6e2b8ef2d4).4dc87ba995e5855e2bc80e6e2b8ef2d4

==============================================================================
08-13 10:29:41  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => e6QOQzfa7NwoQhGsrs8MN19lGr6kDQR0TkbX0kurpNg
    [state] => 5933841
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=e6QOQzfa7NwoQhGsrs8MN19lGr6kDQR0TkbX0kurpNg&state=5933841&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 10:29:41  DEBUG spardeco
client_secret_post

08-13 10:29:41  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-13 10:29:41  DEBUG no ops in sessionid a7ojrupp52uj1solsbd9kr6vd1

08-13 10:29:41  DEBUG requested idtoken claims = Array
(
)


08-13 10:29:41  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-13 10:29:41  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439454881
    [iat] => 1439454581
    [at_hash] => lAA65t3_PyeR41-Lw-sSWg
)


08-13 10:29:41  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-13 10:29:41  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDU0ODgxLCJpYXQiOjE0Mzk0NTQ1ODEsImF0X2hhc2giOiJsQUE2NXQzX1B5ZVI0MS1Mdy1zU1dnIn0.H29flLpSuNH1EZRR6zeaGqihTqxZvH6uzxawfoa4QEMJtB2tdab8tA2X_nOkNj6gZyX0NwQEOwf-CxfLxvE31GJV2aYn3lrOipUJbYPzwiocCCF1YoXixJxGIvlq-wdVwGTuNrW4kSFHNOD0UGa-zVJo01G3G7Y3wUWKc3kvO2VWrntkRxQeTVYB2cEfDEqYMtytebrkLREXDiS9bAHpMn6ZqLe-75dv1QJuBRGc4XDKV94Qj6IQwMhP3i_JDgotmAUI7Jn0p645mhXV82laWqhnrL2MUYMXmPGPiBuTUhpZEhQMf2HR8fxyK1kxPUNcnxncFJuSxwkglmfDjjCnaw

08-13 10:29:41  DEBUG token response = Array
(
    [access_token] => b_niF0CGIDOzYq3X5DFTtBt9_sh1cVockId41RCNysE
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDU0ODgxLCJpYXQiOjE0Mzk0NTQ1ODEsImF0X2hhc2giOiJsQUE2NXQzX1B5ZVI0MS1Mdy1zU1dnIn0.H29flLpSuNH1EZRR6zeaGqihTqxZvH6uzxawfoa4QEMJtB2tdab8tA2X_nOkNj6gZyX0NwQEOwf-CxfLxvE31GJV2aYn3lrOipUJbYPzwiocCCF1YoXixJxGIvlq-wdVwGTuNrW4kSFHNOD0UGa-zVJo01G3G7Y3wUWKc3kvO2VWrntkRxQeTVYB2cEfDEqYMtytebrkLREXDiS9bAHpMn6ZqLe-75dv1QJuBRGc4XDKV94Qj6IQwMhP3i_JDgotmAUI7Jn0p645mhXV82laWqhnrL2MUYMXmPGPiBuTUhpZEhQMf2HR8fxyK1kxPUNcnxncFJuSxwkglmfDjjCnaw
)


==============================================================================
08-13 10:29:41  DEBUG Request: Array
(
    [access_token] => b_niF0CGIDOzYq3X5DFTtBt9_sh1cVockId41RCNysE
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=b_niF0CGIDOzYq3X5DFTtBt9_sh1cVockId41RCNysE","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 10:29:41  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-13 10:29:41  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-13 10:29:41  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-13 10:29:41  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5933841
    [session_id] => a7ojrupp52uj1solsbd9kr6vd1
    [auth_time] => 1439454580
)
 scopes = profile openid email

08-13 10:29:41  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 10:29:41  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 10:29:41  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 10:29:41  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-13 10:29:41  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-13 10:29:44  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5933841
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5933841","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 10:29:44  DEBUG prompt = 

08-13 10:29:44  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:05:01  DEBUG Request: req[ ]
Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

)
 
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 11:05:01  DEBUG Request: [ ]
Input:  
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 11:05:08  DEBUG Request: req[ ]
Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/client","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:05:08  DEBUG Host: localhost

08-13 11:05:08  DEBUG User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0

08-13 11:05:08  DEBUG Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

08-13 11:05:08  DEBUG Accept-Language: en,fr;q=0.8,fr-fr;q=0.5,en-us;q=0.3

08-13 11:05:08  DEBUG Accept-Encoding: gzip, deflate

08-13 11:05:08  DEBUG DNT: 1

08-13 11:05:08  DEBUG Cookie: sec_session_id=rirbb90se15ndp0ajqoaf2v7o7; oidc_state=5933841; PHPSESSID=a7ojrupp52uj1solsbd9kr6vd1; ops=4ad73298fbf1bf62336ebd1dbcebcf76

08-13 11:05:08  DEBUG Connection: keep-alive

08-13 11:05:08  DEBUG headers = Array
(
    [host] => localhost
    [user-agent] => Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0
    [accept] => text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
    [accept-language] => en,fr;q=0.8,fr-fr;q=0.5,en-us;q=0.3
    [accept-encoding] => gzip, deflate
    [dnt] => 1
    [cookie] => sec_session_id=rirbb90se15ndp0ajqoaf2v7o7; oidc_state=5933841; PHPSESSID=a7ojrupp52uj1solsbd9kr6vd1; ops=4ad73298fbf1bf62336ebd1dbcebcf76
    [connection] => keep-alive
)


08-13 11:05:08  DEBUG authorization header = 

08-13 11:05:08  ERROR url: error:invalid_request desc:No Access Code uri: state:1 code:400

08-13 11:05:08  ERROR HTTP/1.0 400 Bad Request
{"error":"invalid_request","error_description":"No Access Code","state":true}

==============================================================================
08-13 11:05:15  DEBUG Request: req[ ]
Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

)
 
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 11:05:15  DEBUG Request: [ ]
Input:  
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 11:05:18  DEBUG Request: req[ ]
Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

)
 
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 11:05:18  DEBUG Request: [ ]
Input:  
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 11:05:19  DEBUG Request: req[ ]
Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/client","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:05:19  DEBUG Host: localhost

08-13 11:05:19  DEBUG User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0

08-13 11:05:19  DEBUG Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

08-13 11:05:19  DEBUG Accept-Language: en,fr;q=0.8,fr-fr;q=0.5,en-us;q=0.3

08-13 11:05:19  DEBUG Accept-Encoding: gzip, deflate

08-13 11:05:19  DEBUG DNT: 1

08-13 11:05:19  DEBUG Cookie: sec_session_id=rirbb90se15ndp0ajqoaf2v7o7; oidc_state=5933841; PHPSESSID=a7ojrupp52uj1solsbd9kr6vd1; ops=4ad73298fbf1bf62336ebd1dbcebcf76

08-13 11:05:19  DEBUG Connection: keep-alive

08-13 11:05:19  DEBUG headers = Array
(
    [host] => localhost
    [user-agent] => Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0
    [accept] => text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
    [accept-language] => en,fr;q=0.8,fr-fr;q=0.5,en-us;q=0.3
    [accept-encoding] => gzip, deflate
    [dnt] => 1
    [cookie] => sec_session_id=rirbb90se15ndp0ajqoaf2v7o7; oidc_state=5933841; PHPSESSID=a7ojrupp52uj1solsbd9kr6vd1; ops=4ad73298fbf1bf62336ebd1dbcebcf76
    [connection] => keep-alive
)


08-13 11:05:19  DEBUG authorization header = 

08-13 11:05:19  ERROR url: error:invalid_request desc:No Access Code uri: state:1 code:400

08-13 11:05:19  ERROR HTTP/1.0 400 Bad Request
{"error":"invalid_request","error_description":"No Access Code","state":true}

==============================================================================
08-13 11:05:21  DEBUG Request: req[ ]
Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

)
 
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 11:05:21  DEBUG Request: [ ]
Input:  
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 11:06:56  DEBUG Request: req[ ]
Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/client","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:06:56  DEBUG Host: localhost

08-13 11:06:56  DEBUG User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0

08-13 11:06:56  DEBUG Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

08-13 11:06:56  DEBUG Accept-Language: en,fr;q=0.8,fr-fr;q=0.5,en-us;q=0.3

08-13 11:06:56  DEBUG Accept-Encoding: gzip, deflate

08-13 11:06:56  DEBUG DNT: 1

08-13 11:06:56  DEBUG Cookie: sec_session_id=rirbb90se15ndp0ajqoaf2v7o7; oidc_state=5933841; PHPSESSID=a7ojrupp52uj1solsbd9kr6vd1; ops=4ad73298fbf1bf62336ebd1dbcebcf76

08-13 11:06:56  DEBUG Connection: keep-alive

08-13 11:06:56  DEBUG headers = Array
(
    [host] => localhost
    [user-agent] => Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0
    [accept] => text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
    [accept-language] => en,fr;q=0.8,fr-fr;q=0.5,en-us;q=0.3
    [accept-encoding] => gzip, deflate
    [dnt] => 1
    [cookie] => sec_session_id=rirbb90se15ndp0ajqoaf2v7o7; oidc_state=5933841; PHPSESSID=a7ojrupp52uj1solsbd9kr6vd1; ops=4ad73298fbf1bf62336ebd1dbcebcf76
    [connection] => keep-alive
)


08-13 11:06:56  DEBUG authorization header = 

08-13 11:06:56  ERROR url: error:invalid_request desc:No Access Code uri: state:1 code:400

08-13 11:06:56  ERROR HTTP/1.0 400 Bad Request
{"error":"invalid_request","error_description":"No Access Code","state":true}

==============================================================================
08-13 11:07:00  DEBUG Request: req[ ]
Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

)
 
{"url":"/oidc1/phpOp/index.php/oplogin","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 11:07:10  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
    [persist] => on
)

Input: username=alice&password=wonderland&persist=on
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

)
 
{"url":"/oidc1/phpOp/index.php/oplogin","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/oplogin"} []
----------------------------------------------------------

==============================================================================
08-13 11:07:19  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7964647
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5933841
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7964647","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:07:19  DEBUG prompt = 

08-13 11:07:19  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:07:25  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7964647
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7964647
        )

)
 
{"url":"/oidc1/phpOp/index.php/oplogin","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/oplogin"} []
----------------------------------------------------------

==============================================================================
08-13 11:12:43  DEBUG Request: req[ ]
Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7964647
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7964647
        )

)
 
{"url":"/oidc1/phpOp/index.php/oplogin","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 11:12:44  DEBUG Request: req[ ]
Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/client","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:12:44  DEBUG Host: localhost

08-13 11:12:44  DEBUG User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0

08-13 11:12:44  DEBUG Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

08-13 11:12:44  DEBUG Accept-Language: en,fr;q=0.8,fr-fr;q=0.5,en-us;q=0.3

08-13 11:12:44  DEBUG Accept-Encoding: gzip, deflate

08-13 11:12:44  DEBUG DNT: 1

08-13 11:12:44  DEBUG Cookie: sec_session_id=i1qpg8lnldq07fhmioi9drs8t2; oidc_state=7964647; PHPSESSID=a7ojrupp52uj1solsbd9kr6vd1; ops=4ad73298fbf1bf62336ebd1dbcebcf76

08-13 11:12:44  DEBUG Connection: keep-alive

08-13 11:12:44  DEBUG headers = Array
(
    [host] => localhost
    [user-agent] => Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0
    [accept] => text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
    [accept-language] => en,fr;q=0.8,fr-fr;q=0.5,en-us;q=0.3
    [accept-encoding] => gzip, deflate
    [dnt] => 1
    [cookie] => sec_session_id=i1qpg8lnldq07fhmioi9drs8t2; oidc_state=7964647; PHPSESSID=a7ojrupp52uj1solsbd9kr6vd1; ops=4ad73298fbf1bf62336ebd1dbcebcf76
    [connection] => keep-alive
)


08-13 11:12:44  DEBUG authorization header = 

08-13 11:12:44  ERROR url: error:invalid_request desc:No Access Code uri: state:1 code:400

08-13 11:12:44  ERROR HTTP/1.0 400 Bad Request
{"error":"invalid_request","error_description":"No Access Code","state":true}

==============================================================================
08-13 11:12:45  DEBUG Request: req[ ]
Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7964647
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7964647
        )

)
 
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 11:12:45  DEBUG Request: [ ]
Input:  
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 11:12:47  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2115411
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7964647
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7964647
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2115411","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:12:47  DEBUG prompt = 

08-13 11:12:47  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:12:59  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9101103
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2115411
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2115411
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9101103","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:12:59  DEBUG prompt = 

08-13 11:12:59  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:13:31  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 8712527
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9101103
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9101103
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=8712527","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:13:31  DEBUG prompt = 

08-13 11:13:31  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:14:00  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3121793
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8712527
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 8712527
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3121793","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:14:00  DEBUG prompt = 

08-13 11:14:00  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:14:13  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6442715
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3121793
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3121793
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6442715","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:14:13  DEBUG prompt = 

08-13 11:14:13  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:14:33  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6293981
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6442715
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6442715
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6293981","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:14:33  DEBUG prompt = 

08-13 11:14:33  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:14:37  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 9456755
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6293981
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6293981
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=9456755","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:14:37  DEBUG prompt = 

08-13 11:14:37  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:15:46  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2447351
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9456755
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 9456755
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2447351","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:15:46  DEBUG prompt = 

08-13 11:15:46  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:17:39  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2447351
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2447351","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:17:40  DEBUG prompt = 

08-13 11:17:40  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:17:40  DEBUG Request: req[ ]
Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

)
 
{"url":"/oidc1/phpOp/index.php/Spardeco","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2447351"} []
----------------------------------------------------------

==============================================================================
08-13 11:18:07  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2447351
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2447351","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:18:07  DEBUG prompt = 

08-13 11:18:07  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:18:15  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2447351
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2447351","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:18:15  DEBUG prompt = 

08-13 11:18:15  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:19:47  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2447351
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2447351","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:19:47  DEBUG prompt = 

08-13 11:19:47  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:20:17  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2447351
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2447351","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:20:17  DEBUG prompt = 

08-13 11:20:17  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:26:15  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2447351
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2447351","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:26:15  DEBUG prompt = 

08-13 11:26:15  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:26:19  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6572478
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2447351
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6572478","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:26:19  DEBUG prompt = 

08-13 11:26:19  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:26:45  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6572478
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6572478
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6572478
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6572478","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:26:45  DEBUG prompt = 

08-13 11:26:45  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:27:22  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 6572478
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6572478
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6572478
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=6572478","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:27:22  DEBUG prompt = 

08-13 11:27:22  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:28:09  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3811997
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3811997","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:28:09  DEBUG prompt = 

08-13 11:28:09  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:28:34  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3811997
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3811997
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3811997
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3811997","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:28:34  DEBUG prompt = 

08-13 11:28:34  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:28:36  DEBUG Request: Array
(
    [username] => 
    [password] => 
)

Input: username=&password=
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3811997
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3811997
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3811997"} []
----------------------------------------------------------

==============================================================================
08-13 11:28:43  DEBUG Request: Array
(
    [username] => alice
    [password] => wonderland
)

Input: username=alice&password=wonderland
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3811997
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3811997
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-13 11:28:43  DEBUG Auth_time = 1439458123

08-13 11:28:43  DEBUG session id = uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:28:43  DEBUG prompt = 

08-13 11:28:43  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3811997
    [session_id] => uqd1sltnfdvrpvs70rbrkl5h86
    [auth_time] => 1439458123
)
 scopes = profile openid email

08-13 11:28:43  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:28:43  DEBUG id_token claims = Array
(
)


08-13 11:28:43  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 11:28:43  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:28:43  DEBUG ss = sha256(spardecohttps://localhost3eed1c9d7da92be1882e8ddcb79d369c10acd90c45e6a6a4d731bd066772b0fa).10acd90c45e6a6a4d731bd066772b0fa

==============================================================================
08-13 11:28:44  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => s3epPEvOwVikmmXKBb7B7aFo55GiRY8N9CprRekYTc8
    [state] => 3811997
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=s3epPEvOwVikmmXKBb7B7aFo55GiRY8N9CprRekYTc8&state=3811997&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:28:44  DEBUG spardeco
client_secret_post

08-13 11:28:44  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-13 11:28:44  DEBUG no ops in sessionid uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:28:44  DEBUG requested idtoken claims = Array
(
)


08-13 11:28:44  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-13 11:28:44  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439458424
    [iat] => 1439458124
    [at_hash] => kEMI4bPWNhv44PI2Muk54w
)


08-13 11:28:44  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-13 11:28:44  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDU4NDI0LCJpYXQiOjE0Mzk0NTgxMjQsImF0X2hhc2giOiJrRU1JNGJQV05odjQ0UEkyTXVrNTR3In0.nwD-VHVXVk99BERU7RIPNaZOlEwfrEjpZwrwwxLYN5Aju9GqsOfEAUmkUj4CDZdQPk_LMrW9kODyf7oA1M1Zv03aN_OrQeWsea_Gg7do5SfE58L_k5hy2w9fmj9QwmV9S2MgHJEc2j6xPput-QKiFB5z38Nb0-uDTkHa5PSEEzHY-u-3iGFDl2VH21np-h5fvF7nx3hRsmjrFjYzUO1xNZhz8KBNSteuYzc2onKHFtLDruN75ATksXnZqlWmqrf5UifAdkFgKxw1DOriU3jC1aiJ3t9ho6YujVtn9zWYRrpq2XyhYZq_KtjCD5bd0IW_b-0y27bE9keGbuxCPfr_iQ

08-13 11:28:44  DEBUG token response = Array
(
    [access_token] => HWmsOMIwJPnk32ly7Jr0WAKzOJk09IjL_nH6J3sfpX0
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImUzNzgyYmM1YWVhZWI1NmEyNTZkNDdkYzM2NDM1NmJkNzQ2NDgzZGIwZDNiZGNiYjYxY2VkYjAwNDcxYjhlYjYiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDU4NDI0LCJpYXQiOjE0Mzk0NTgxMjQsImF0X2hhc2giOiJrRU1JNGJQV05odjQ0UEkyTXVrNTR3In0.nwD-VHVXVk99BERU7RIPNaZOlEwfrEjpZwrwwxLYN5Aju9GqsOfEAUmkUj4CDZdQPk_LMrW9kODyf7oA1M1Zv03aN_OrQeWsea_Gg7do5SfE58L_k5hy2w9fmj9QwmV9S2MgHJEc2j6xPput-QKiFB5z38Nb0-uDTkHa5PSEEzHY-u-3iGFDl2VH21np-h5fvF7nx3hRsmjrFjYzUO1xNZhz8KBNSteuYzc2onKHFtLDruN75ATksXnZqlWmqrf5UifAdkFgKxw1DOriU3jC1aiJ3t9ho6YujVtn9zWYRrpq2XyhYZq_KtjCD5bd0IW_b-0y27bE9keGbuxCPfr_iQ
)


==============================================================================
08-13 11:28:44  DEBUG Request: Array
(
    [access_token] => HWmsOMIwJPnk32ly7Jr0WAKzOJk09IjL_nH6J3sfpX0
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=HWmsOMIwJPnk32ly7Jr0WAKzOJk09IjL_nH6J3sfpX0","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:28:44  DEBUG user id alice wrapped = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6

08-13 11:28:44  DEBUG wrapped x+j%mG6CVtd;a G unwrapped = 1:alice

08-13 11:28:44  DEBUG userid = e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6  unwrapped = alice

08-13 11:28:44  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3811997
    [session_id] => uqd1sltnfdvrpvs70rbrkl5h86
    [auth_time] => 1439458123
)
 scopes = profile openid email

08-13 11:28:44  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:28:44  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:28:44  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:28:44  DEBUG returning = Array
(
    [birthdate] => 2000-08-08
    [email] => alice@wonderland.com
    [email_verified] => 1
    [family_name] => Yamada
    [gender] => female
    [given_name] => Alice
    [locale] => en
    [middle_name] => 
    [name] => Alice Yamada
    [nickname] => Standard Alice Nickname
    [picture] => https://localhost/phpOp/profiles/smiling_woman.jpg
    [preferred_username] => AlicePreferred
    [profile] => http://www.wonderland.com/alice
    [updated_at] => 23453453
    [website] => http://www.wonderland.com
    [zoneinfo] => America/Los Angeles
)


08-13 11:28:44  DEBUG userinfo response = {"sub":"e3782bc5aeaeb56a256d47dc364356bd746483db0d3bdcbb61cedb00471b8eb6","birthdate":"2000-08-08","email":"alice@wonderland.com","email_verified":true,"family_name":"Yamada","gender":"female","given_name":"Alice","locale":"en","middle_name":null,"name":"Alice Yamada","nickname":"Standard Alice Nickname","picture":"https:\/\/localhost\/phpOp\/profiles\/smiling_woman.jpg","preferred_username":"AlicePreferred","profile":"http:\/\/www.wonderland.com\/alice","updated_at":"23453453","website":"http:\/\/www.wonderland.com","zoneinfo":"America\/Los Angeles"}

==============================================================================
08-13 11:28:49  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 3811997
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=3811997","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:28:49  DEBUG prompt = 

08-13 11:28:49  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:29:28  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7869928
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3811997
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 3811997
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7869928","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:29:28  DEBUG prompt = 

08-13 11:29:28  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:29:29  DEBUG Request: Array
(
    [username] => 
    [password] => 
)

Input: username=&password=
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7869928
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7869928
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7869928"} []
----------------------------------------------------------

==============================================================================
08-13 11:29:36  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7869928
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7869928
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7869928
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7869928","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:29:36  DEBUG prompt = 

08-13 11:29:36  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:29:39  DEBUG Request: Array
(
    [username] => 
    [password] => 
)

Input: username=&password=
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7869928
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7869928
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7869928"} []
----------------------------------------------------------

==============================================================================
08-13 11:33:06  DEBUG Request: Array
(
    [username] => 
    [password] => 
)

Input: username=&password=
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7869928
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7869928
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

==============================================================================
08-13 11:34:37  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7869928
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7869928
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7869928
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7869928","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:34:37  DEBUG prompt = 

08-13 11:34:37  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:34:39  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5728272
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7869928
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7869928
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5728272","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:34:39  DEBUG prompt = 

08-13 11:34:39  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:34:41  DEBUG Request: Array
(
    [username] => 
    [password] => 
)

Input: username=&password=
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5728272
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5728272
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5728272"} []
----------------------------------------------------------

==============================================================================
08-13 11:35:11  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5728272
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5728272
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5728272
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5728272","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:35:11  DEBUG prompt = 

08-13 11:35:11  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:35:12  DEBUG Request: Array
(
    [username] => 
    [password] => 
)

Input: username=&password=
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5728272
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5728272
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5728272"} []
----------------------------------------------------------

==============================================================================
08-13 11:37:26  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7531375
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5728272
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5728272
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7531375","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:37:26  DEBUG prompt = 

08-13 11:37:26  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:37:28  DEBUG Request: Array
(
    [username] => 
    [client_id] => spardeco
    [password] => 
)

Input: username=&client_id=spardeco&password=
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7531375"} []
----------------------------------------------------------

==============================================================================
08-13 11:37:30  DEBUG Request: Array
(
    [username] => 
    [client_id] => spardeco
    [password] => 
)

Input: username=&client_id=spardeco&password=
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

==============================================================================
08-13 11:37:53  DEBUG Request: Array
(
    [username] => simon
    [client_id] => spardeco
    [password] => toto
)

Input: username=simon&client_id=spardeco&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-13 11:37:53  DEBUG Auth_time = 1439458673

08-13 11:37:53  DEBUG session id = uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:37:53  DEBUG prompt = 

08-13 11:37:53  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7531375
)
 scopes = profile openid email

08-13 11:37:53  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:37:53  DEBUG id_token claims = Array
(
)


08-13 11:37:53  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 11:37:53  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:37:53  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-13 11:42:33  DEBUG Request: Array
(
    [username] => simon
    [client_id] => spardeco
    [password] => toto
)

Input: username=simon&client_id=spardeco&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439458673
    [ops] => 3edb64b1ef787fd016bb12dc0145aa18
)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-13 11:42:33  DEBUG Auth_time = 1439458953

08-13 11:42:33  DEBUG session id = uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:42:33  DEBUG prompt = 

08-13 11:42:33  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7531375
)
 scopes = profile openid email

08-13 11:42:33  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:42:33  DEBUG id_token claims = Array
(
)


08-13 11:42:33  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 11:42:33  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:42:33  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-13 11:44:01  DEBUG Request: Array
(
    [username] => simon
    [client_id] => spardeco
    [password] => toto
)

Input: username=simon&client_id=spardeco&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439458953
    [ops] => 6451bbef4926f676a7d0f31a74f54833
)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-13 11:44:01  DEBUG Auth_time = 1439459041

08-13 11:44:01  DEBUG session id = uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:44:01  DEBUG prompt = 

08-13 11:44:01  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7531375
)
 scopes = profile openid email

08-13 11:44:01  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:44:01  DEBUG id_token claims = Array
(
)


08-13 11:44:01  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 11:44:01  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:44:01  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-13 11:44:41  DEBUG Request: Array
(
    [username] => simon
    [client_id] => spardeco
    [password] => toto
)

Input: username=simon&client_id=spardeco&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439459041
    [ops] => 818abd52d7d2a72ebc8f8fd71b15579c
)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-13 11:44:41  DEBUG Auth_time = 1439459081

08-13 11:44:41  DEBUG session id = uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:44:41  DEBUG prompt = 

08-13 11:44:41  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7531375
)
 scopes = profile openid email

08-13 11:44:41  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:44:41  DEBUG id_token claims = Array
(
)


08-13 11:44:41  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 11:44:41  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:44:41  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-13 11:45:52  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => once
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=once&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439459081
    [ops] => 8bb0dd8df8e6795b1496627ceb571687
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-13 11:45:52  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7531375
    [session_id] => uqd1sltnfdvrpvs70rbrkl5h86
    [auth_time] => 1439459081
)
 scopes = profile openid email

08-13 11:45:52  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:45:52  DEBUG id_token claims = Array
(
)


08-13 11:45:52  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 11:45:52  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:45:52  DEBUG ss = sha256(spardecohttps://localhost8bb0dd8df8e6795b1496627ceb571687975941453df5deae4b671849c8a33408).975941453df5deae4b671849c8a33408

==============================================================================
08-13 11:45:52  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => vsWHdhOzUeG8nBmIUOJIfXO1nuZ_kDxDmHcVXRVWo3g
    [state] => 7531375
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=vsWHdhOzUeG8nBmIUOJIfXO1nuZ_kDxDmHcVXRVWo3g&state=7531375&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:45:52  DEBUG spardeco
client_secret_post

08-13 11:45:52  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-13 11:45:52  DEBUG no ops in sessionid uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:45:52  DEBUG requested idtoken claims = Array
(
)


08-13 11:45:52  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-13 11:45:52  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439459452
    [iat] => 1439459152
    [at_hash] => bymmK0p-Ak1vlvIAEQrpZg
)


08-13 11:45:52  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-13 11:45:52  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDU5NDUyLCJpYXQiOjE0Mzk0NTkxNTIsImF0X2hhc2giOiJieW1tSzBwLUFrMXZsdklBRVFycFpnIn0.VTAz-oyb2zhIxvIjDiDouqJhhhu17mBiTzWy13fFika0zvBIkfk9yDk6LYRK29jpTbE8EgQK-8FUwiDXsu7M7h7vAuXbzQUPSZEIYElULBP_8ZbWCeAMxHn-Ymqkbogcz0h30kEB_-rwO7_UXsCVucrxf4XD7mzZ9VBq797EQ0i0GQuFdYzwBTg7ae8LJKh3_zsgHU7wwh5MqV0Q8ujQ3LEnhTurp1GiW4iFiU-Yx0Qa6JwQorbS94BEKMeO7wXbl3YYkn-fyHLavuEf3jaqs4Pqj64yTzpWeTePd8WogSyCbVjQ7BHhtgOcR3MavLt2cOA4sDDxa8o-PyD_j4PnJw

08-13 11:45:52  DEBUG token response = Array
(
    [access_token] => yos4KPi-HRoXJ1F_vtcuMocb40eMaEl8lss8jh_7Cnk
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDU5NDUyLCJpYXQiOjE0Mzk0NTkxNTIsImF0X2hhc2giOiJieW1tSzBwLUFrMXZsdklBRVFycFpnIn0.VTAz-oyb2zhIxvIjDiDouqJhhhu17mBiTzWy13fFika0zvBIkfk9yDk6LYRK29jpTbE8EgQK-8FUwiDXsu7M7h7vAuXbzQUPSZEIYElULBP_8ZbWCeAMxHn-Ymqkbogcz0h30kEB_-rwO7_UXsCVucrxf4XD7mzZ9VBq797EQ0i0GQuFdYzwBTg7ae8LJKh3_zsgHU7wwh5MqV0Q8ujQ3LEnhTurp1GiW4iFiU-Yx0Qa6JwQorbS94BEKMeO7wXbl3YYkn-fyHLavuEf3jaqs4Pqj64yTzpWeTePd8WogSyCbVjQ7BHhtgOcR3MavLt2cOA4sDDxa8o-PyD_j4PnJw
)


==============================================================================
08-13 11:45:52  DEBUG Request: Array
(
    [access_token] => yos4KPi-HRoXJ1F_vtcuMocb40eMaEl8lss8jh_7Cnk
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=yos4KPi-HRoXJ1F_vtcuMocb40eMaEl8lss8jh_7Cnk","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:45:53  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-13 11:45:53  DEBUG wrapped |wFF#9yFk6Ca unwrapped = 1:simon

08-13 11:45:53  DEBUG userid = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8  unwrapped = simon

08-13 11:45:53  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7531375
    [session_id] => uqd1sltnfdvrpvs70rbrkl5h86
    [auth_time] => 1439459081
)
 scopes = profile openid email

08-13 11:45:53  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:45:53  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:45:53  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:45:53  DEBUG returning = Array
(
    [birthdate] => 1898
    [email] => simon.becot@orange.com
    [email_verified] => 1
    [family_name] => Becot
    [gender] => male
    [given_name] => Simon
    [locale] => fr
    [middle_name] => 
    [name] => Simon Becot
    [nickname] => 
    [picture] => https://localhost/phpOp/profiles/pic.jpg
    [preferred_username] => 
    [profile] => http://profile/simon
    [updated_at] => 
    [website] => http://website
    [zoneinfo] => 
)


08-13 11:45:53  DEBUG userinfo response = {"sub":"c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8","birthdate":"1898","email":"simon.becot@orange.com","email_verified":true,"family_name":"Becot","gender":"male","given_name":"Simon","locale":"fr","middle_name":null,"name":"Simon Becot","nickname":null,"picture":"https:\/\/localhost\/phpOp\/profiles\/pic.jpg","preferred_username":null,"profile":"http:\/\/profile\/simon","updated_at":null,"website":"http:\/\/website","zoneinfo":null}

==============================================================================
08-13 11:47:04  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => vsWHdhOzUeG8nBmIUOJIfXO1nuZ_kDxDmHcVXRVWo3g
    [state] => 7531375
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=vsWHdhOzUeG8nBmIUOJIfXO1nuZ_kDxDmHcVXRVWo3g&state=7531375&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:47:04  ERROR url: error:invalid_grant desc:no such code uri: state: code:400

08-13 11:47:04  ERROR HTTP/1.0 400 Bad Request
{"error":"invalid_grant","error_description":"no such code"}

==============================================================================
08-13 11:47:10  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 7531375
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=7531375","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:47:10  DEBUG prompt = 

08-13 11:47:10  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:55:41  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 5112340
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6572478
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 6572478
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=5112340","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:55:41  DEBUG prompt = 

08-13 11:55:41  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:56:34  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2107445
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 7531375
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2107445","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:56:34  DEBUG prompt = 

08-13 11:56:34  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:56:48  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4686768
)

Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2107445
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2107445
        )

)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4686768","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:56:49  DEBUG prompt = 

08-13 11:56:49  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:57:03  DEBUG Request: Array
(
    [username] => simon
    [client_id] => spardeco
    [password] => toto
)

Input: username=simon&client_id=spardeco&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4686768
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4686768
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4686768"} []
----------------------------------------------------------

08-13 11:57:03  DEBUG Auth_time = 1439459823

08-13 11:57:03  DEBUG session id = uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:57:03  DEBUG prompt = 

08-13 11:57:03  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4686768
)
 scopes = profile openid email

08-13 11:57:03  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:57:03  DEBUG id_token claims = Array
(
)


08-13 11:57:03  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 11:57:03  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:57:03  INFO requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


==============================================================================
08-13 11:57:10  DEBUG Request: Array
(
    [mode] => ax_confirm
    [agreed] => 1
    [trust] => always
    [confirm] => confirmed
)

Input: mode=ax_confirm&agreed=1&trust=always&confirm=confirmed
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4686768
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4686768
        )

    [login] => 1
    [username] => simon
    [persist] => 
    [auth_time] => 1439459823
    [ops] => 9203e2829e5c40ff72ff21dfaada7f05
)
 
{"url":"/oidc1/phpOp/index.php/confirm_userinfo","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/login"} []
----------------------------------------------------------

08-13 11:57:10  DEBUG Trust = Always for spardeco

08-13 11:57:10  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4686768
    [session_id] => uqd1sltnfdvrpvs70rbrkl5h86
    [auth_time] => 1439459823
)
 scopes = profile openid email

08-13 11:57:10  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:57:10  DEBUG id_token claims = Array
(
)


08-13 11:57:10  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 11:57:10  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:57:10  DEBUG ss = sha256(spardecohttps://localhost9203e2829e5c40ff72ff21dfaada7f050ca7335881245e2cee9cbc245ac07aef).0ca7335881245e2cee9cbc245ac07aef

==============================================================================
08-13 11:57:11  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => f_UdDDSCEsYRaEJ3XKpKEXtdZMMVR9_Qj4O5AR1kQ4I
    [state] => 4686768
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=f_UdDDSCEsYRaEJ3XKpKEXtdZMMVR9_Qj4O5AR1kQ4I&state=4686768&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:57:11  DEBUG spardeco
client_secret_post

08-13 11:57:11  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-13 11:57:11  DEBUG no ops in sessionid uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:57:11  DEBUG requested idtoken claims = Array
(
)


08-13 11:57:11  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-13 11:57:11  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439460131
    [iat] => 1439459831
    [at_hash] => 6fMInv2PId5356Ye6tR5aw
)


08-13 11:57:11  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-13 11:57:11  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDYwMTMxLCJpYXQiOjE0Mzk0NTk4MzEsImF0X2hhc2giOiI2Zk1JbnYyUElkNTM1NlllNnRSNWF3In0.ww2awkP9NwErvzHKWy4kgLPSU6yhdDcj1181sRd-6jmlcc77LmZlyJW7gcMWuIggi6McXj9dt_CdAtgCCBwlVYs-NHqc07ydqnt2iEbdVyKLu95606siuPxOk_zKKpGkNNbI5SMpoc0SDYn1qu2iCEd15kiAcyje2KkMPRN6xg_YcbOFyts1fNSf9ngkzp8LuSigoFBuMrVNrqUvlSGPwU0nJt_tT8cw5oIx8UBKHauT7ejy5QZDTTAKdrmUWZemW-w1dxpduca9nrIAa3KAMT8QRcf039n5I8yBLM1xA2BZH-uql8Z3Jt7ZloGhRsnjv9bfkduarq0gThCfTTIHFw

08-13 11:57:11  DEBUG token response = Array
(
    [access_token] => c_KK86W6olgtFMkOzhblykO2syo9dDH8kbyzIKfdaSM
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDYwMTMxLCJpYXQiOjE0Mzk0NTk4MzEsImF0X2hhc2giOiI2Zk1JbnYyUElkNTM1NlllNnRSNWF3In0.ww2awkP9NwErvzHKWy4kgLPSU6yhdDcj1181sRd-6jmlcc77LmZlyJW7gcMWuIggi6McXj9dt_CdAtgCCBwlVYs-NHqc07ydqnt2iEbdVyKLu95606siuPxOk_zKKpGkNNbI5SMpoc0SDYn1qu2iCEd15kiAcyje2KkMPRN6xg_YcbOFyts1fNSf9ngkzp8LuSigoFBuMrVNrqUvlSGPwU0nJt_tT8cw5oIx8UBKHauT7ejy5QZDTTAKdrmUWZemW-w1dxpduca9nrIAa3KAMT8QRcf039n5I8yBLM1xA2BZH-uql8Z3Jt7ZloGhRsnjv9bfkduarq0gThCfTTIHFw
)


==============================================================================
08-13 11:57:11  DEBUG Request: Array
(
    [access_token] => c_KK86W6olgtFMkOzhblykO2syo9dDH8kbyzIKfdaSM
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=c_KK86W6olgtFMkOzhblykO2syo9dDH8kbyzIKfdaSM","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:57:11  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-13 11:57:11  DEBUG wrapped |wFF#9yFk6Ca unwrapped = 1:simon

08-13 11:57:11  DEBUG userid = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8  unwrapped = simon

08-13 11:57:11  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4686768
    [session_id] => uqd1sltnfdvrpvs70rbrkl5h86
    [auth_time] => 1439459823
)
 scopes = profile openid email

08-13 11:57:11  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:57:11  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:57:11  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:57:11  DEBUG returning = Array
(
    [birthdate] => 1898
    [email] => simon.becot@orange.com
    [email_verified] => 1
    [family_name] => Becot
    [gender] => male
    [given_name] => Simon
    [locale] => fr
    [middle_name] => 
    [name] => Simon Becot
    [nickname] => 
    [picture] => https://localhost/phpOp/profiles/pic.jpg
    [preferred_username] => 
    [profile] => http://profile/simon
    [updated_at] => 
    [website] => http://website
    [zoneinfo] => 
)


08-13 11:57:11  DEBUG userinfo response = {"sub":"c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8","birthdate":"1898","email":"simon.becot@orange.com","email_verified":true,"family_name":"Becot","gender":"male","given_name":"Simon","locale":"fr","middle_name":null,"name":"Simon Becot","nickname":null,"picture":"https:\/\/localhost\/phpOp\/profiles\/pic.jpg","preferred_username":null,"profile":"http:\/\/profile\/simon","updated_at":null,"website":"http:\/\/website","zoneinfo":null}

==============================================================================
08-13 11:57:22  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2829277
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2829277","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:57:22  DEBUG prompt = 

08-13 11:57:22  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:57:40  DEBUG Request: Array
(
    [username] => simon
    [client_id] => spardeco
    [password] => toto
)

Input: username=simon&client_id=spardeco&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2829277
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 2829277
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=2829277"} []
----------------------------------------------------------

08-13 11:57:40  DEBUG Auth_time = 1439459860

08-13 11:57:40  DEBUG session id = uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:57:40  DEBUG prompt = 

08-13 11:57:40  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2829277
    [session_id] => uqd1sltnfdvrpvs70rbrkl5h86
    [auth_time] => 1439459860
)
 scopes = profile openid email

08-13 11:57:40  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:57:40  DEBUG id_token claims = Array
(
)


08-13 11:57:40  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 11:57:40  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:57:40  DEBUG ss = sha256(spardecohttps://localhost9f6471fad1c94bfb29f16a1b36062d74ecc95471711c96e6436a2afb43e21822).ecc95471711c96e6436a2afb43e21822

==============================================================================
08-13 11:57:40  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => 8IGQBxd-XD8p6M9bqGOvq0FnLeAYNzH3u_vv6byLVRQ
    [state] => 2829277
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=8IGQBxd-XD8p6M9bqGOvq0FnLeAYNzH3u_vv6byLVRQ&state=2829277&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:57:40  DEBUG spardeco
client_secret_post

08-13 11:57:40  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-13 11:57:40  DEBUG no ops in sessionid uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:57:40  DEBUG requested idtoken claims = Array
(
)


08-13 11:57:40  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-13 11:57:40  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439460160
    [iat] => 1439459860
    [at_hash] => IBrBChSBieuqPo6-RLZNaw
)


08-13 11:57:40  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-13 11:57:40  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDYwMTYwLCJpYXQiOjE0Mzk0NTk4NjAsImF0X2hhc2giOiJJQnJCQ2hTQmlldXFQbzYtUkxaTmF3In0.Ce91Oe3W6WV32lKlA9OwZ06BcR9vsXjOlZcqzsi1F5VHlJ2sJXdSyvuwRmXEGvLyUPKgCTbYKPrTlJVjm7UXkdvautOARGvxfjQrkQSmFFYIbMWH2TcQJliuTLONjQqJAc5pNn9KqdlhRjSxfGzuXckTOanT6-HkBkzGXLS_JeUrW4ovN6DfzwzQXQ01rUXSHA91G5p86Y-1Uhgp7hj8JGCBmqnGjMMkRnM5jeKUi9YX5aSQaLwX6ilsPc4eVwOxw1_uoF4zmW6NuRyM-1m8oAfT_WxYqLb3f_TBTpsBHy_Hl-99X3-HpY1LhHB2n5HRYlIFtCmQhZgOrsmrdHpFbA

08-13 11:57:40  DEBUG token response = Array
(
    [access_token] => 7tV1XByHCpT4rbsy90JrLjw5i-x_uZgkWZ8JgadW9Gg
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDYwMTYwLCJpYXQiOjE0Mzk0NTk4NjAsImF0X2hhc2giOiJJQnJCQ2hTQmlldXFQbzYtUkxaTmF3In0.Ce91Oe3W6WV32lKlA9OwZ06BcR9vsXjOlZcqzsi1F5VHlJ2sJXdSyvuwRmXEGvLyUPKgCTbYKPrTlJVjm7UXkdvautOARGvxfjQrkQSmFFYIbMWH2TcQJliuTLONjQqJAc5pNn9KqdlhRjSxfGzuXckTOanT6-HkBkzGXLS_JeUrW4ovN6DfzwzQXQ01rUXSHA91G5p86Y-1Uhgp7hj8JGCBmqnGjMMkRnM5jeKUi9YX5aSQaLwX6ilsPc4eVwOxw1_uoF4zmW6NuRyM-1m8oAfT_WxYqLb3f_TBTpsBHy_Hl-99X3-HpY1LhHB2n5HRYlIFtCmQhZgOrsmrdHpFbA
)


==============================================================================
08-13 11:57:41  DEBUG Request: Array
(
    [access_token] => 7tV1XByHCpT4rbsy90JrLjw5i-x_uZgkWZ8JgadW9Gg
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=7tV1XByHCpT4rbsy90JrLjw5i-x_uZgkWZ8JgadW9Gg","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:57:41  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-13 11:57:41  DEBUG wrapped |wFF#9yFk6Ca unwrapped = 1:simon

08-13 11:57:41  DEBUG userid = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8  unwrapped = simon

08-13 11:57:41  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 2829277
    [session_id] => uqd1sltnfdvrpvs70rbrkl5h86
    [auth_time] => 1439459860
)
 scopes = profile openid email

08-13 11:57:41  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:57:41  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:57:41  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:57:41  DEBUG returning = Array
(
    [birthdate] => 1898
    [email] => simon.becot@orange.com
    [email_verified] => 1
    [family_name] => Becot
    [gender] => male
    [given_name] => Simon
    [locale] => fr
    [middle_name] => 
    [name] => Simon Becot
    [nickname] => 
    [picture] => https://localhost/phpOp/profiles/pic.jpg
    [preferred_username] => 
    [profile] => http://profile/simon
    [updated_at] => 
    [website] => http://website
    [zoneinfo] => 
)


08-13 11:57:41  DEBUG userinfo response = {"sub":"c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8","birthdate":"1898","email":"simon.becot@orange.com","email_verified":true,"family_name":"Becot","gender":"male","given_name":"Simon","locale":"fr","middle_name":null,"name":"Simon Becot","nickname":null,"picture":"https:\/\/localhost\/phpOp\/profiles\/pic.jpg","preferred_username":null,"profile":"http:\/\/profile\/simon","updated_at":null,"website":"http:\/\/website","zoneinfo":null}

==============================================================================
08-13 11:59:24  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4641776
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4641776","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 11:59:24  DEBUG prompt = 

08-13 11:59:24  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 11:59:32  DEBUG Request: Array
(
    [username] => simon
    [client_id] => spardeco
    [password] => toto
)

Input: username=simon&client_id=spardeco&password=toto
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4641776
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 4641776
        )

)
 
{"url":"/oidc1/phpOp/index.php/login","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"https://localhost/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4641776"} []
----------------------------------------------------------

08-13 11:59:32  DEBUG Auth_time = 1439459972

08-13 11:59:32  DEBUG session id = uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:59:32  DEBUG prompt = 

08-13 11:59:32  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4641776
    [session_id] => uqd1sltnfdvrpvs70rbrkl5h86
    [auth_time] => 1439459972
)
 scopes = profile openid email

08-13 11:59:32  DEBUG userinfo claims = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:59:32  DEBUG id_token claims = Array
(
)


08-13 11:59:32  DEBUG unique keys = Array
(
    [0] => birthdate
    [1] => email
    [2] => email_verified
    [3] => family_name
    [4] => gender
    [5] => given_name
    [6] => locale
    [7] => middle_name
    [8] => name
    [9] => nickname
    [10] => picture
    [11] => preferred_username
    [12] => profile
    [13] => updated_at
    [14] => website
    [15] => zoneinfo
)


08-13 11:59:32  DEBUG requested_claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:59:32  DEBUG ss = sha256(spardecohttps://localhostcd2b7080a1dd5019153e1eb5975e2cf287a7314503e521f00875c61edb99419b).87a7314503e521f00875c61edb99419b

==============================================================================
08-13 11:59:32  DEBUG Request: Array
(
    [grant_type] => authorization_code
    [code] => Vk-dIni7g1kn5b36CsYsKF9vLnIplit_CMq77FPCidE
    [state] => 4641776
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [client_id] => spardeco
    [client_secret] => spsecret
)

Input: grant_type=authorization_code&code=Vk-dIni7g1kn5b36CsYsKF9vLnIplit_CMq77FPCidE&state=4641776&redirect_uri=https%3A%2F%2Flocalhost%2Foidc1%2Fspardeco%2Fardecoback.php&client_id=spardeco&client_secret=spsecret
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/token","ip":"127.0.0.1","http_method":"POST","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:59:32  DEBUG spardeco
client_secret_post

08-13 11:59:32  INFO authenticating client_id spardeco with client_secret spsecret
Result : 1

08-13 11:59:32  DEBUG no ops in sessionid uqd1sltnfdvrpvs70rbrkl5h86

08-13 11:59:32  DEBUG requested idtoken claims = Array
(
)


08-13 11:59:32  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-13 11:59:32  DEBUG handle_token id_token_obj = Array
(
    [iss] => https://localhost/phpOp
    [sub] => c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8
    [aud] => Array
        (
            [0] => spardeco
        )

    [exp] => 1439460272
    [iat] => 1439459972
    [at_hash] => sEUWG3Cfyt0pVepvS-i7sQ
)


08-13 11:59:32  DEBUG sign_encrypt sig = RS256 alg =  enc = 

08-13 11:59:32  DEBUG jws = eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDYwMjcyLCJpYXQiOjE0Mzk0NTk5NzIsImF0X2hhc2giOiJzRVVXRzNDZnl0MHBWZXB2Uy1pN3NRIn0.uqegZYdB3TzpoQeWDysKxC-SkMVVYNUhd4nW0xrpAUE1DxTmsyjZXRSCoWFElnWk4VSshkHD5dXotEv85dpjEGlDiDrf2CQedK4JkHf7KN6iSv-bIuLvRvGqeZMVx_ineXrYmpfAb9nY23BeCCddM1BPhMoyNH8Ju8b1inuNxqi9c2qysut3X4kEqXpR3Gkt3VpPzgkmqzAAttxs6py_dB1CzE7pdI5-GvbYWD_3CyGTljpmQvGv_p5V16P3IT1j_voWzZ7FtDVJyUceK2UJxVXDgt6LCoUetr6A8GUQAZsimgcUsvnWNpqSDlvMysnVn5cNZlr3ewpav4yFbLll_Q

08-13 11:59:32  DEBUG token response = Array
(
    [access_token] => stFg0Vx_uVVSvS7MYim2aejSm39BpwIzkses7mZDHfE
    [token_type] => Bearer
    [expires_in] => 3600
    [id_token] => eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHBzOlwvXC9sb2NhbGhvc3RcL3BocE9wXC9vcC5qd2siLCJraWQiOiJQSFBPUC0wMFMifQ.eyJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0XC9waHBPcCIsInN1YiI6ImMwZGY3Yzc3YjZiYmYzOTU0NjQ2MWIyMzhlMzk3OTk0YTRjODQ2Y2U5N2IyMWVhZTZiMzY0MzkwZTJiZDYxYzgiLCJhdWQiOlsic3BhcmRlY28iXSwiZXhwIjoxNDM5NDYwMjcyLCJpYXQiOjE0Mzk0NTk5NzIsImF0X2hhc2giOiJzRVVXRzNDZnl0MHBWZXB2Uy1pN3NRIn0.uqegZYdB3TzpoQeWDysKxC-SkMVVYNUhd4nW0xrpAUE1DxTmsyjZXRSCoWFElnWk4VSshkHD5dXotEv85dpjEGlDiDrf2CQedK4JkHf7KN6iSv-bIuLvRvGqeZMVx_ineXrYmpfAb9nY23BeCCddM1BPhMoyNH8Ju8b1inuNxqi9c2qysut3X4kEqXpR3Gkt3VpPzgkmqzAAttxs6py_dB1CzE7pdI5-GvbYWD_3CyGTljpmQvGv_p5V16P3IT1j_voWzZ7FtDVJyUceK2UJxVXDgt6LCoUetr6A8GUQAZsimgcUsvnWNpqSDlvMysnVn5cNZlr3ewpav4yFbLll_Q
)


==============================================================================
08-13 11:59:32  DEBUG Request: Array
(
    [access_token] => stFg0Vx_uVVSvS7MYim2aejSm39BpwIzkses7mZDHfE
)

Input: 
Session:sess[ ] 
{"url":"/oidc1/phpOp/index.php/userinfo?access_token=stFg0Vx_uVVSvS7MYim2aejSm39BpwIzkses7mZDHfE","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

08-13 11:59:32  DEBUG user id simon wrapped = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8

08-13 11:59:32  DEBUG wrapped |wFF#9yFk6Ca unwrapped = 1:simon

08-13 11:59:32  DEBUG userid = c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8  unwrapped = simon

08-13 11:59:32  DEBUG get_userinfo_claims Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4641776
    [session_id] => uqd1sltnfdvrpvs70rbrkl5h86
    [auth_time] => 1439459972
)
 scopes = profile openid email

08-13 11:59:32  DEBUG ALLOWED CLAIMS = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:59:32  DEBUG REQUESTED_USER_INFO = Array
(
    [email] => 0
    [email_verified] => 0
    [name] => 0
    [given_name] => 0
    [family_name] => 0
    [middle_name] => 0
    [nickname] => 0
    [preferred_username] => 0
    [profile] => 0
    [picture] => 0
    [website] => 0
    [gender] => 0
    [birthdate] => 0
    [zoneinfo] => 0
    [locale] => 0
    [updated_at] => 0
)


08-13 11:59:32  DEBUG account requested claims = Array
(
    [birthdate] => 0
    [email] => 0
    [email_verified] => 0
    [family_name] => 0
    [gender] => 0
    [given_name] => 0
    [locale] => 0
    [middle_name] => 0
    [name] => 0
    [nickname] => 0
    [picture] => 0
    [preferred_username] => 0
    [profile] => 0
    [updated_at] => 0
    [website] => 0
    [zoneinfo] => 0
)


08-13 11:59:32  DEBUG returning = Array
(
    [birthdate] => 1898
    [email] => simon.becot@orange.com
    [email_verified] => 1
    [family_name] => Becot
    [gender] => male
    [given_name] => Simon
    [locale] => fr
    [middle_name] => 
    [name] => Simon Becot
    [nickname] => 
    [picture] => https://localhost/phpOp/profiles/pic.jpg
    [preferred_username] => 
    [profile] => http://profile/simon
    [updated_at] => 
    [website] => http://website
    [zoneinfo] => 
)


08-13 11:59:32  DEBUG userinfo response = {"sub":"c0df7c77b6bbf39546461b238e397994a4c846ce97b21eae6b364390e2bd61c8","birthdate":"1898","email":"simon.becot@orange.com","email_verified":true,"family_name":"Becot","gender":"male","given_name":"Simon","locale":"fr","middle_name":null,"name":"Simon Becot","nickname":null,"picture":"https:\/\/localhost\/phpOp\/profiles\/pic.jpg","preferred_username":null,"profile":"http:\/\/profile\/simon","updated_at":null,"website":"http:\/\/website","zoneinfo":null}

==============================================================================
08-13 12:02:05  DEBUG Request: Array
(
    [client_id] => spardeco
    [response_type] => code
    [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
    [scope] => profile openid email
    [state] => 4641776
)

Input: 
Session:Array
(
)
 
{"url":"/oidc1/phpOp/index.php/auth?client_id=spardeco&response_type=code&redirect_uri=https://localhost/oidc1/spardeco/ardecoback.php&scope=profile%20openid%20email&state=4641776","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"https://localhost/oidc1/spardeco/index.php"} []
----------------------------------------------------------

08-13 12:02:05  DEBUG prompt = 

08-13 12:02:05  DEBUG num prompt = 0 Array
(
)


==============================================================================
08-13 14:18:12  DEBUG Request: req[ ]
Input: 
Session:Array
(
    [get] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5112340
        )

    [rpfA] => Array
        (
            [client_id] => spardeco
            [response_type] => code
            [redirect_uri] => https://localhost/oidc1/spardeco/ardecoback.php
            [scope] => profile openid email
            [state] => 5112340
        )

)
 
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

==============================================================================
08-13 14:18:12  DEBUG Request: [ ]
Input:  
{"url":"/oidc1/phpOp/index.php/.well-known/openid-configuration","ip":"127.0.0.1","http_method":"GET","server":"localhost","referrer":"NULL"} []
----------------------------------------------------------

